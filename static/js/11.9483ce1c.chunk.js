(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[11],{392:function(e,a,t){"use strict";var i=t(2),r=t(5),s=t(6),n=t.n(s),c=t(0),l=t(8),o=t(1),d=["bsPrefix","className","children","aspectRatio","style"];var m=c.forwardRef((function(e,a){var t=e.bsPrefix,s=e.className,m=e.children,p=e.aspectRatio,f=e.style,b=Object(r.a)(e,d);t=Object(l.a)(t,"ratio");var u,j="number"===typeof p;return Object(o.jsx)("div",Object(i.a)(Object(i.a)({ref:a},b),{},{style:Object(i.a)(Object(i.a)({},f),j&&{"--bs-aspect-ratio":(u=p,u<=0||u>100?"100%":"".concat(u<1?100*u:u,"%"))}),className:n()(t,s,!j&&"".concat(t,"-").concat(p)),children:c.Children.only(m)}))}));m.defaultProps={aspectRatio:"1x1"},a.a=m},472:function(e,a,t){},484:function(e,a,t){"use strict";t.r(a);var i=t(21),r=t.n(i),s=t(35),n=t(9),c=(t(472),t(0)),l=t(18),o=t(361),d=t(144),m=t(392),p=t(365),f=t(207),b=t(358),u=t(362),j=t(363),O=t(142),h=t(15),v=t(2),x=function(e){return{file:null,name:e?g:N,preview:null}},y={type:"",message:""},g="Choose a film ",N="Choose a thumbnail ",A={title:"",description:"",film:x(!0),thumbnail:x(!1),isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},w=function(e,a){switch(a.type){case"field":return Object(v.a)(Object(v.a)({},e),{},Object(h.a)({isError:!1,error:null},a.fieldName,a.payload));case"file-add":return!0===a.isFilm?Object(v.a)(Object(v.a)({},e),{},{isError:!1,error:null,alert:y,film:{file:a.file,name:a.fileName,preview:a.preview}}):Object(v.a)(Object(v.a)({},e),{},{isError:!1,error:null,alert:y,thumbnail:{file:a.file,name:a.fileName,preview:a.preview}});case"file-clear":return!0===a.isFilm?Object(v.a)(Object(v.a)({},e),{},{isError:!1,error:null,film:x(!0)}):Object(v.a)(Object(v.a)({},e),{},{isError:!1,error:null,thumbnail:x(!1)});case"submit":return Object(v.a)(Object(v.a)({},e),{},{isError:!1,error:null,alert:y,isSubmitted:!0});case"send":return Object(v.a)(Object(v.a)({},e),{},{isSending:!0});case"success":return Object(v.a)(Object(v.a)({},e),{},{isSending:!1,isSuccess:!0});case"error":return Object(v.a)(Object(v.a)({},e),{},{isSending:!1,isSuccess:!1,isError:!0,error:a.payload});case"error-422":return Object(v.a)(Object(v.a)({},e),{},{isError:!0,error:a.payload,film:x(!0),thumbnail:x(!1)});default:return e}},E=t(116),C=t(44),R=t(1);a.default=function(){var e=Object(c.useContext)(C.a),a=e.user,t=e.clearUser,i=Object(l.g)(),h=Object(c.useRef)(null),v=Object(c.useRef)(null),x=Object(c.useReducer)(w,A),y=Object(n.a)(x,2),F=y[0],S=y[1],k=F.title,L=F.description,D=F.film,P=F.thumbnail,U=F.isSubmitted,G=F.isSending,I=F.isError,B=F.error;Object(c.useEffect)((function(){!a.auth&&a.isInitialLoaded&&(i.replace("".concat("/filmapp-react-frontend/")),i.push("".concat("/filmapp-react-frontend/","login")),t())}),[a,i,t]),Object(c.useEffect)((function(){function e(){return(e=Object(s.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).set("title",k),a.set("description",L),a.set("film",D.file),a.set("thumbnail",P.file),e.next=7,E.b(a).then((function(e){S({type:"success"}),i.push("".concat("/filmapp-react-frontend/","film/").concat(e.data.id))})).catch((function(e){var a=null;e.response&&e.response.data&&e.response.data.error?a=e.response.data.error:e.response&&e.response.data&&e.response.data.errors&&(e.response.data.errors.description?a=e.response.data.errors.description.message:e.response.data.errors.title&&(a=e.response.data.errors.title.message)),422===e.response.status?S({type:"error-422",payload:a}):S({type:"error",payload:a})}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}G&&function(){e.apply(this,arguments)}()}),[L,D.file,i,G,P.file,k]);var T=function(e,a){switch(e.preventDefault(),a){case"film":S({type:"file-add",isFilm:!0,file:h.current.files[0],fileName:h.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])});break;case"thumbnail":S({type:"file-add",isFilm:!1,file:v.current.files[0],fileName:v.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])})}};return Object(R.jsxs)(o.a,{className:"mt-4 mx-2",sm:12,children:[Object(R.jsxs)(d.a,{className:"mb-4",sm:6,lg:5,children:[Object(R.jsx)(d.a,{className:"mb-4",xs:12,sm:12,lg:10,children:Object(R.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half",children:Object(R.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(R.jsx)(m.a,{aspectRatio:"16x9",children:Object(R.jsx)("video",{muted:!0,autoPlay:!0,className:"embed-responsive-item",loop:!0,src:D.preview?D.preview:""})}),Object(R.jsx)("input",{id:"film",accept:"video/mp4, video/ogg",onChange:function(e){return T(e,"film")},type:"file",ref:h,className:"inputfile"}),Object(R.jsx)("label",{htmlFor:"film",className:"position-absolute",children:D.name===g&&Object(R.jsx)("span",{children:D.name})}),D.preview&&Object(R.jsx)(d.a,{className:"card-img-overlay film-add-item-opacity"}),D.preview&&Object(R.jsx)(O.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){S({type:"file-clear",isFilm:!0})}})]})})}),Object(R.jsx)(d.a,{xs:12,sm:12,lg:10,children:Object(R.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half",children:Object(R.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(R.jsx)(m.a,{aspectRatio:"16x9",children:Object(R.jsx)("img",{alt:"",src:P.preview?P.preview:"data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})}),Object(R.jsx)("input",{id:"thumbnail",accept:"image/jpg, image/png, image/jpeg",onChange:function(e){return T(e,"thumbnail")},type:"file",ref:v,className:" inputfile position-absolute"}),Object(R.jsx)("label",{htmlFor:"thumbnail",className:"position-absolute",children:P.name===N&&Object(R.jsx)("span",{children:P.name})}),P.preview&&Object(R.jsx)(d.a,{className:"card-img-overlay film-add-item-opacity"}),P.preview&&Object(R.jsx)(O.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){S({type:"file-clear",isFilm:!1})}})]})})})]}),Object(R.jsxs)(d.a,{className:"mb-2",sm:6,lg:5,children:[Object(R.jsxs)(p.a.Group,{className:"mb-3",sm:12,children:[Object(R.jsx)(f.a,{placeholder:"Title","aria-label":"Title","aria-describedby":"basic-addon1",isInvalid:U&&!k,name:"title",value:k,onChange:function(e){return S({type:"field",fieldName:"title",payload:e.target.value})}}),Object(R.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Title is required"})]}),Object(R.jsxs)(p.a.Group,{className:"mb-3",sm:12,children:[Object(R.jsx)(f.a,{placeholder:"Description",as:"textarea","aria-label":"With textarea",isInvalid:U&&!L,name:"description",value:L,onChange:function(e){return S({type:"field",fieldName:"description",payload:e.target.value})}}),Object(R.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Description is required"})]}),Object(R.jsx)(d.a,{className:"mb-3 p-0 ",sm:12,children:Object(R.jsxs)(p.a.Group,{className:"d-flex align-items-center",children:[Object(R.jsx)(b.a,{variant:"primary",disabled:G||!k||!L,onClick:G?null:function(e){e.preventDefault(),S({type:"submit"}),a.auth?k&&L&&S({type:"send"}):i.push("".concat("/filmapp-react-frontend/","add/login"))},children:G?"Loading\u2026":"Add"}),G&&Object(R.jsx)(u.a,{className:"ms-2",animation:"grow"})]})}),I&&Object(R.jsx)(j.a,{variant:"danger",children:B||"Error while creating film."})]})]})}}}]);
//# sourceMappingURL=11.9483ce1c.chunk.js.map