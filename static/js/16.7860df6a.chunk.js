(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[16],{283:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return l})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return d})),i.d(t,"e",(function(){return u}));var a=i(30),r=i(84),n=function(e){return a.a.get("films/",{params:e})},s=function(e){return a.a.get("films/".concat(e))},c=function(e){return a.a.get("films/search",{params:e})},l=function(e){return a.a.patch("films/".concat(e,"/view"))},o=function(e){return a.a.post("films",e,{headers:Object(r.a)()})},d=function(e,t){return a.a.patch("films/".concat(e,"/action"),t,{headers:Object(r.a)()})},u=function(e){return a.a.delete("films/".concat(e),{headers:Object(r.a)()})}},284:function(e,t,i){"use strict";var a=i(0),r=i(1);t.a=function(e){var t=e.isInvalid,i=e.onChange,n=e.type,s=e.name,c=e.value,l=e.placeholder,o=void 0===l?"":l,d="textarea"===n?"textarea":"input",u=Object(a.useRef)(null);return Object(a.useEffect)((function(){u.current&&(t?u.current.classList.add("is-invalid"):u.current.classList.remove("is-invalid"))}),[t]),Object(r.jsx)(d,{ref:u,className:"form-control",placeholder:o,type:n,name:s,value:c,onChange:i})}},431:function(e,t,i){},449:function(e,t,i){"use strict";i.r(t);var a=i(272),r=i.n(a),n=i(273),s=i(29),c=(i(431),i(0)),l=i(7),o=i(278),d=i(284),u=i(44),f=i(2),m=function(e){return{file:null,name:e?b:j,preview:null}},p={type:"",message:""},b="Choose a film ",j="Choose a thumbnail ",v={title:"",description:"",film:m(!0),thumbnail:m(!1),isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},h=function(e,t){switch(t.type){case"field":return Object(f.a)(Object(f.a)({},e),{},Object(u.a)({isError:!1,error:null},t.fieldName,t.payload));case"file-add":return!0===t.isFilm?Object(f.a)(Object(f.a)({},e),{},{isError:!1,error:null,alert:p,film:{file:t.file,name:t.fileName,preview:t.preview}}):Object(f.a)(Object(f.a)({},e),{},{isError:!1,error:null,alert:p,thumbnail:{file:t.file,name:t.fileName,preview:t.preview}});case"file-clear":return!0===t.isFilm?Object(f.a)(Object(f.a)({},e),{},{isError:!1,error:null,film:m(!0)}):Object(f.a)(Object(f.a)({},e),{},{isError:!1,error:null,thumbnail:m(!1)});case"submit":return Object(f.a)(Object(f.a)({},e),{},{isError:!1,error:null,alert:p,isSubmitted:!0});case"send":return Object(f.a)(Object(f.a)({},e),{},{isSending:!0});case"success":return Object(f.a)(Object(f.a)({},e),{},{isSending:!1,isSuccess:!0});case"error":return Object(f.a)(Object(f.a)({},e),{},{isSending:!1,isSuccess:!1,isError:!0,error:t.payload});case"error-422":return Object(f.a)(Object(f.a)({},e),{},{isSending:!1,isSuccess:!1,isError:!0,error:t.payload,film:m(!0),thumbnail:m(!1)});default:return e}},O=i(283),x=i(51),g=i(1);t.default=function(){var e=Object(c.useContext)(x.a),t=e.user,i=e.clearUser,a=Object(l.g)(),u=Object(c.useRef)(null),f=Object(c.useRef)(null),m=Object(c.useReducer)(h,v),p=Object(s.a)(m,2),y=p[0],N=p[1],A=y.title,w=y.description,E=y.film,C=y.thumbnail,S=y.isSubmitted,R=y.isSending,k=y.isError,F=y.error;Object(c.useEffect)((function(){!t.auth&&t.isInitialLoaded&&(a.replace("".concat("/filmapp-react-frontend/")),a.push("".concat("/filmapp-react-frontend/","login")),i())}),[t,a,i]),Object(c.useEffect)((function(){function e(){return(e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).set("title",A),t.set("description",w),t.set("film",E.file),t.set("thumbnail",C.file),e.next=7,O.b(t).then((function(e){N({type:"success"}),a.push("".concat("/filmapp-react-frontend/","film/").concat(e.data.id))})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.error?t=e.response.data.error:e.response&&e.response.data&&e.response.data.errors&&(e.response.data.errors.description?t=e.response.data.errors.description.message:e.response.data.errors.title&&(t=e.response.data.errors.title.message)),422===e.response.status?N({type:"error-422",payload:t}):N({type:"error",payload:t})}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&function(){e.apply(this,arguments)}()}),[w,E.file,a,R,C.file,A]);var L=function(e,t){switch(e.preventDefault(),t){case"film":N({type:"file-add",isFilm:!0,file:u.current.files[0],fileName:u.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])});break;case"thumbnail":N({type:"file-add",isFilm:!1,file:f.current.files[0],fileName:f.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])})}};return Object(g.jsxs)("div",{className:"row mt-4 pb-5 mx-2",children:[Object(g.jsxs)("div",{className:"col-12 col-sm-6 mb-4",children:[Object(g.jsx)("div",{className:"col-12 mb-4",children:Object(g.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half",children:Object(g.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(g.jsx)("div",{className:"ratio ratio-16x9",children:Object(g.jsx)("video",{muted:!0,autoPlay:!0,className:"embed-responsive-item",loop:!0,src:E.preview?E.preview:""})}),Object(g.jsx)("input",{id:"film",accept:"video/mp4, video/ogg",onChange:function(e){return L(e,"film")},type:"file",ref:u,className:"inputfile"}),Object(g.jsx)("label",{htmlFor:"film",className:"position-absolute",children:E.name===b&&Object(g.jsx)("span",{children:E.name})}),E.preview&&Object(g.jsx)("div",{className:"col card-img-overlay film-add-item-opacity"}),E.preview&&Object(g.jsx)(o.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){N({type:"file-clear",isFilm:!0})}})]})})}),Object(g.jsx)("div",{className:"col-12",children:Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(g.jsx)("div",{className:"ratio ratio-16x9",children:Object(g.jsx)("img",{alt:"",src:C.preview?C.preview:"data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})}),Object(g.jsx)("input",{id:"thumbnail",accept:"image/jpg, image/png, image/jpeg",onChange:function(e){return L(e,"thumbnail")},type:"file",ref:f,className:" inputfile position-absolute"}),Object(g.jsx)("label",{htmlFor:"thumbnail",className:"position-absolute",children:C.name===j&&Object(g.jsx)("span",{children:C.name})}),C.preview&&Object(g.jsx)("div",{className:"col card-img-overlay film-add-item-opacity"}),C.preview&&Object(g.jsx)(o.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){N({type:"file-clear",isFilm:!1})}})]})})})]}),Object(g.jsxs)("div",{className:"col-12 col-sm-6 mb-2",children:[Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)(d.a,{placeholder:"Title",type:"text",isInvalid:S&&!A,name:"title",value:A,onChange:function(e){return N({type:"field",fieldName:"title",payload:e.target.value})}}),Object(g.jsx)("div",{className:"invalid-feedback",children:"Title is required"})]}),Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)(d.a,{placeholder:"Description",type:"textarea",isInvalid:S&&!w,name:"description",value:w,onChange:function(e){return N({type:"field",fieldName:"description",payload:e.target.value})}}),Object(g.jsx)("div",{className:"invalid-feedback",children:"Description is required"})]}),Object(g.jsx)("div",{className:"col-12 mb-3 p-0",children:Object(g.jsxs)("div",{className:"d-flex align-items-center",children:[Object(g.jsx)("button",{className:"btn btn-primary",disabled:R||!A||!w,onClick:R?null:function(e){e.preventDefault(),console.log("lflalfa"),N({type:"submit"}),t.auth?A&&w&&N({type:"send"}):a.push("".concat("/filmapp-react-frontend/","add/login"))},children:R?"Loading\u2026":"Add"}),R&&Object(g.jsx)("div",{className:"spinner-grow ms-2"})]})}),k&&Object(g.jsx)("div",{className:"alert alert-danger",children:F||"Error while creating film."})]})]})}}}]);
//# sourceMappingURL=16.7860df6a.chunk.js.map