(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[0],{286:function(e,t,a){},441:function(e,t,a){},442:function(e,t,a){},483:function(e,t,a){},511:function(e,t,a){},550:function(e,t,a){},551:function(e,t,a){},552:function(e,t,a){"use strict";a.r(t);a(344),a(345),a(346),a(255);var n=a(0),c=a.n(n),s=a(27),i=a.n(s),r=(a(441),a(442),a(202),a(9)),l=a.n(r),o=a(2),d=a(16),u=a(11),m=a(37),p=a(32),j=a(594),b=a(593),f=a(324),h=a(590),O=a(581),x=a(582),y=a(326),g=a(591),v=a(330),w=a.n(v),N=a(181),k=a.n(N),A=a(317),C=a.n(A).a.create({baseURL:"https://marm007-filmapp-backend-node.herokuapp.com/api/"}),L=function(){var e=JSON.parse(localStorage.getItem("accessToken"));return e?{Authorization:"Bearer "+e}:{}},E=function(e){return C.get("films/",{params:e})},F=function(e){return C.get("films/".concat(e))},S=function(e){return C.get("films/search",{params:e})},P=function(e){return C.patch("films/".concat(e,"/view"))},R=function(e){return C.post("films",e,{headers:L()})},I=function(e,t){return C.patch("films/".concat(e,"/action"),t,{headers:L()})},D=function(e){return C.delete("films/".concat(e),{headers:L()})},T=a(182),B=a(320),H=Object(n.createContext)({name:"",id:null,auth:!1,isInitialLoaded:!1}),U=(a(482),a(483),a(23)),M=a(14),G={options:[],isLoading:!1,isAllFetched:!1,isSearching:!1,isOpen:!1,selected:null,title:""};function _(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({selected:null},t.fieldName,t.payload));case"pick-option":return Object(o.a)(Object(o.a)({},e),{},{title:t.title,selected:t.selected});case"success-load":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isSearching:!1,isAllFetched:t.payload.length<10,options:[].concat(Object(U.a)(e.options),Object(U.a)(t.payload))});case"success-search":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isSearching:!1,isAllFetched:t.payload.length<10,options:t.payload});case"clear":return G;case"load":return e.isLoading||e.isAllFetched?e:Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1,isSearching:!1});case"search":return Object(o.a)(Object(o.a)({},e),{},{options:[],isSearching:!0,isLoading:!1,isAllFetched:!1});default:return e}}var Y=a(321),z=function(e,t,a){return e?Object(Y.debounce)(t,e,a):t};var J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(n.useMemo)((function(){var e,a,n,c,s;return{offset:null!==(e=null===t||void 0===t?void 0:t.offset)&&void 0!==e?e:20,debounce:null!==(a=null===t||void 0===t?void 0:t.debounce)&&void 0!==a?a:200,debounceOptions:null!==(n=null===t||void 0===t?void 0:t.debounceOptions)&&void 0!==n?n:{leading:!0},triggerOnNoScroll:null!==(c=null===t||void 0===t?void 0:t.triggerOnNoScroll)&&void 0!==c&&c,id:null!==(s=null===t||void 0===t?void 0:t.id)&&void 0!==s?s:null}}),[null===t||void 0===t?void 0:t.offset,null===t||void 0===t?void 0:t.debounce,null===t||void 0===t?void 0:t.debounceOptions,null===t||void 0===t?void 0:t.triggerOnNoScroll,null===t||void 0===t?void 0:t.id]),c=a.offset,s=a.triggerOnNoScroll,i=a.debounce,r=a.debounceOptions,l=a.id,o=Object(n.useMemo)((function(){return z(i,e,r)}),[e,i,r]),d=Object(n.useRef)(null),u=Object(n.useCallback)((function(){if(null!=d.current){var e=d.current,t=Math.round(e.scrollTop+e.clientHeight);Math.round(e.scrollHeight-c)<=t&&o()}else if(null!==l){var a=document.getElementById(l);if(a){var n=Math.round(a.scrollTop+a.clientHeight);Math.round(a.scrollHeight-c)<=n&&o()}}else{var s=document.scrollingElement||document.documentElement,i=Math.round(s.scrollTop+window.innerHeight);Math.round(s.scrollHeight-c)<=i&&o()}}),[o,c,l]);return Object(n.useEffect)((function(){var e=d.current,t=document.getElementById(l);return null!=e?e.addEventListener("scroll",u):null!==t?t.addEventListener("scroll",u):window.addEventListener("scroll",u),s&&u(),function(){null!=e?e.removeEventListener("scroll",u):null!==t?t.addEventListener("scroll",u):window.removeEventListener("scroll",u)}}),[u,s,l]),d},X=a(1);var W=function(e){var t=Object(m.g)(),a=Object(m.h)(),c=Object(n.useContext)(H),s=c.user,i=c.logout,r=Object(n.useReducer)(_,G),v=Object(u.a)(r,2),N=v[0],A=v[1],C=Object(n.useState)(!1),L=Object(u.a)(C,2),E=L[0],F=L[1],P=N.options,R=N.title,I=N.isLoading,D=N.isAllFetched,U=N.isSearching,M=N.isOpen,Y=N.selected,z=Object(n.useCallback)((function(){I||D||U||!M||A({type:"load"})}),[I,D,U,M]);J(z,{id:"typeahead-navbar"});var W=Object(n.useRef)(null),K=Object(n.useState)(null),V=Object(u.a)(K,2),Z=V[0],Q=V[1];Object(n.useEffect)((function(){return document.addEventListener("keydown",q),function(){document.removeEventListener("keydown",q)}})),Object(n.useEffect)((function(){F(!1)}),[a]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S({search:R,skip:P.length}).then((function(e){var t=e.data.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})}));A({type:"success-load",payload:t})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I&&function(){e.apply(this,arguments)}()}),[I,R,P.length]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S({search:R}).then((function(e){var t=e.data.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})}));A({type:"success-search",payload:t})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}U&&function(){e.apply(this,arguments)}()}),[U,R]);var q=function(e){if(e&&e.target&&e.target.className&&"rbt-input-main form-control rbt-input  focus"===e.target.className)switch(e.keyCode||e.charCode){case 13:$(e);break;case 9:B.isMobile&&$(e)}},$=function(e){e.preventDefault(),document.getElementById("search-form").reset(),W&&W.current.clear(),Y?t.push({pathname:"".concat("/filmapp-react-frontend/","film/").concat(Y.id),search:"",state:{}}):""===R?t.push({pathname:"".concat("/filmapp-react-frontend/","search"),search:"?title=".concat(R),state:{}}):1===P.length?t.push({pathname:"".concat("/filmapp-react-frontend/","film/").concat(P[0].id),search:"",state:{}}):t.push({pathname:"".concat("/filmapp-react-frontend/","search"),search:"?title=".concat(R),state:{films:P}}),A({type:"clear"})},ee=Object(n.useCallback)((function(e){A({type:"search",payload:e})}),[]);return Object(X.jsxs)(b.a,{expanded:E,className:"py-2 px-4",expand:"md",bg:"light",variant:"light",onToggle:function(e){F(e)},onSelect:function(e){return function(e){switch(e){case"add_film":t.push("".concat("/filmapp-react-frontend/","add"));break;case"playlists":t.push("".concat("/filmapp-react-frontend/","playlists"))}}(e)},children:[Object(X.jsx)(f.a,{className:"pb-2",xs:{span:5,order:"first"},sm:{span:2,order:"first"},md:{span:4,order:"first"},children:Object(X.jsxs)(b.a.Brand,{style:{cursor:"pointer"},className:"d-flex align-items-center",onClick:function(){return t.push("/filmapp-react-frontend/")},children:[Object(X.jsx)(b.a.Brand,{children:Object(X.jsx)("img",{alt:"",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAADsQAAA7EB9YPtSQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAmeSURBVHic7Z17jF1VFYe/mZYytAIVGHnVhjeUSkNtFFtfAYSIxlA0UAiiNUCFEh9oaI2KNNEoPogoAhYUrCIoECCUV9IiikIChKeBohZloDK11j6oLdNOZ45/7I7c3tnr3PPY65y5s9eXrH/m3rPXfqzZ97efpwOjXZkAvAd4P/Be4GjgbcA64CngDuCXwNa6MmiEpRuYDVwBPAb0A0kL6wE+UEdmjfIcBJwDXAe8AAzSusF91g+cVm3Wjbx0AscA84GbgVcp1tiSvQFMqaw0RmbGAbfhfrdDNrjPHqioTIaH3YG9hM8WoN/4Ce4n5ODgJTO87At8DLgc+BOwDXgEGOP57pgdn1URBF8MXVDDcQBwOrAYeB5ZsH1ZeP4QYJPwTEhbGqzEETMGmArMw42zXyZ7A/TteNbH53KkU9ReB3YpXwVxMRaYAXwBuBX4D+Ua4Un8jdCBE2raQTCrfJWMbsYAHwW+g/v97iN8I3xN8D0JWK/gr9G+UaJuomEJuo3Qj+tVfJyn7PsPZSpmNDAFV8lLgM8K35mAE3OaDfE80CX4v1fR71bgLRnqaVTQKNhuBdawc2VsA2YKz04FNqPXEAnwLcH3AZTXGmn24fRqa1/GA+8DFuKGPFl+T3uAvYX0PpPh+TLWDxwn+D5b0e/35SpsL/YAPgQsApZRXLAtxalwH78omGZWWwHsJvi+Tcnn04K/Ec/bgU8CPyV9wqWIfUnwuRvwTEA/PrtC8L0PsFrB3yBuebnt+DR6jbANt7HCxxG4SRQt3wPABwXfpyr5PEPwVxvjcJMUC4AbkRXy7eg1xCu4/zofZyn6TYC/4xaNfNyk4G+x4KsyJvCmYFsGbGHnDEpCpRv4F+ErZMjuRdYDNyj6TYBrBL8TccEZ0tdLgi81mlfItrbIYFq3OLvFs2XtEsFvF7p6YBA4RfB9EmE1T4Ly8nDWFbI0S+sWby6QXlbrx/VOPrT1wCrgrYLv6wP7Ok/wk5vmFbKegJm8WvA5kfBbpxrtVWQ9cKai3wSngXxMAFYG9HOL4CcXC4GNgSug0QZxY30fJxO+W2y0+3D79XyE/m9sto8Lfo8PWObMOmAi8E7hM+1py4T0bvFnyr4XCn67cPvvtfyuwe3z9/HjQD5WCOkzEZgD/AR4FifI+oF3Cd8/R7EihuwGwfce5NuUkdf6cYcvfByObu93h+B3PPDXAOmf25zwJN48TeJ74AXqGZ8PmdQtnoDuT8Eq5JmzOcplniP4nQVsL5BeD05An+xL8N8ZEviBkKFudKYtG62KblGy5fg3dYIb6Wj5XQvsJ/j9botn+3EjsMXAp0gZ9k1j+ESMZAPIXaLWtGWjpXWLf1H2/VXBt7YeuFvwuyvwXMP3NuIm1RbhhPN44bmd6AT+nDNDK3FDEh+/VqyIIZO6xZkU6xaz2gBwouD7MHT1wFzB7zTcsvVRwuctOb1ghtKmLTXH5wnp3eLlyr5Xp/jW1AOrcII3OLcUzNAg8s4S7fF5grzHvblb1LDfIeuBawP5eG1HGRfiZiXHCf5KU2Zm6RVgTyFd7fF5guv6fBxL67WGsnap4HtX3NbvPGllFmsarM2Z2Wa7UUhXe3ye4H5zJwv+L1P2PYA8Q3kosKFFvnOLNS1CKOe6xucJ8CD+5duxwOPKvlcD+wtlb9RWL+HmV+bh1kyk5eZauJPyFdGLvLHyqgDpt7KLBN9TyD68LWoPIeuBmchT2COGiwlTEXWOzzfjpmV9XKLsuwf5p6AtmE64yqhrfJ4Aj+L/T+zEnYYJ4aNWsaZFJ+WF4JCVmbYMYdJOnoMpdvx6RIk1TULogCGrc3zeh7trx8dFGZ4f0WJNk88TtiHmCn6m47ZfawbBU8jHr+9v+N5/cXsTf4RT7NLunyiYRthG2IA8Pl8U2JfPLhN8T8ZdxDADN0w0dtBBtqXgPLYcfxe6C/lnyvLaZtw9e0YONDZ0zBd8TcHdXRfKT7NYk87aGSlkEUlF/hOl8flXSqQbrVjTZCo63bF0PVon8HCG502sVUQHelu68lyPVtkyqDGc36ITAH3AOwSfc4ErcadVDwxfJCMPF6ATAAn+69H2I/y8wIv4NcGFCmWSrnhZpuDLdy6jm2KXYmzBXT4x7PraIxUynuCWZY9ieMN8XcHXxZ6KgvBDz0Hcun8zh+D2CoT09YRQprILXUt8if4zcOYT3MGRZjqBfwT204d///67Fcp0v6/y0NmTeL7HTwflD4f0+goQ+tTtevyLKKcoVNRNvgKhsz3N9xKGcYQX0pvwn5A+IUDar/sq6/zABbjS54SwC1BD5ns9yu6EP87di3+94QyFMl0r1N9vAqTtDYDDAxfAp/73J7z4W0H94m+5gi+f+NuHMFfYegMAwp3v/6OQ/qUKFSWJv9AndgbwrzNoiL/HhTKF2uUkBkCWGbosFpP409jw4rvBo4NwW+xUA0ASfx9RqKhfCeWoUvyFvrhKU/xVEgAm/sqZpvirJAB8b8Yw8ZfdNMWfegCY+Ctn2uJPPQBM/JUzbfGnGgAm/so3irb4Uw0ASfzdpVAA300l7S7+pHsXQoo/1QCoW/zNV6iobwr11K7iTy0AqhR/0lswqxJ/hxJe/D0mlEnrfGPwAJDE38uBM96Hf2/gcQqVdJ9QRxrib9i9feiIP5UAGAni7+cKvmZ7/LS7+FMJgB8KaVUp/kK/f1cSfxqXQVUp/lQCwMRfOZvu8aMl/v4fANKBiuPJt//+DeAez98nI78WrSgr8b/1ahbhdxX/HndkrpFO3JU4IQ+jbMV/GeSB6L7rd7ti2oZhGIZhjGBCiUCjPdkuBcDDyFfCG6OHTdILkYxIsACIHAuAyLEAiBwLgMixAIgcC4DIsQCIHAuAyLEAiBwLgMixAIgcC4DIsQCIHAuAyLEAiBwLgMixAIgcC4DIsQCIHAuAyLEAiBwLgMixAIgcC4DIsQCIHAuAyLEAiBwLgMixAIgcC4DIsQCIHAuAyLEAiBwLgMixAIgcC4DIsQCIHCkAkkpzYdRFIgXA2kqzYdTFGikAeivNhlEXr0kB8LdKs2HUxUrpqtiDcG/5NEY3p6W99eJZYFpVOTEqZwvQnTYM/F5VOTFq4SpgS1oP0AE8AcyoJj9GhawHDgPWpfUACTAP11UYo4cEuBBYl/WBTwCD6L26zKxak16Fl8pcdN9fZ6Zvg8C3KTH9PwvoGQEFMctvG4CzhjdpfrqABbjfj7oLZdba+nCv9N3b15hQ/O2XXcCJwKm4uYJJwL7A2ILpGeVJcC+07gVeBJbi3ny+Me2h/wGmG+ECiz27wAAAAABJRU5ErkJggg==",width:"30",height:"30"})}),Object(X.jsx)("p",{className:"d-none d-md-inline m-0",children:"FilmApp"})]})}),Object(X.jsx)(f.a,{className:"text-right d-md-none m-button pb-2 ",xs:{span:6,order:2},sm:{span:2,order:"last"},children:Object(X.jsx)(b.a.Toggle,{className:"m-button","aria-controls":"responsive-navbar-nav"})}),Object(X.jsx)(f.a,{xs:{span:12,order:3},sm:{span:8,order:2},md:{span:5,order:2},children:Object(X.jsx)(h.a,{id:"search-form",inline:"true",children:Object(X.jsxs)(O.a,{className:"m-0",style:{width:"100%"},children:[Object(X.jsx)(f.a,{xs:12,sm:10,className:"p-0",children:Object(X.jsx)(T.a,{ref:W,className:"search-bar",useCache:!1,filterBy:function(){return!0},id:"typeahead-navbar",isLoading:!0,open:M,placeholder:"Search",labelKey:"title",minLength:1,options:P,onSearch:ee,onBlur:function(e){return A({type:"field",fieldName:"isOpen",payload:!1})},onFocus:function(e){""!==R&&A({type:"field",fieldName:"isOpen",payload:!0})},onKeyDown:function(e){return A({type:"field",fieldName:"isOpen",payload:!0})},onMenuToggle:function(e){return A({type:"field",fieldName:"isOpen",payload:e})},onInputChange:function(e,t){A({type:"field",fieldName:"title",payload:e}),""===e&&A({type:"field",fieldName:"options",payload:[]})},onChange:function(e){var t=e.length>0?e[0].title:"";A({type:"pick-option",title:t,selected:e.length>0?e[0]:null})},renderMenu:function(e,a){return Object(X.jsxs)(T.b,Object(o.a)(Object(o.a)({},a),{},{className:"pt-4 pb-4",children:[e.map((function(e,a){return Object(X.jsx)(T.c,{option:e,position:a,children:Object(X.jsxs)(O.a,{className:"p-0 m-0 entry__inner",onClick:function(a){a.stopPropagation(),a.preventDefault(),A({type:"clear"}),document.getElementById("search-form").reset(),W&&W.current.clear(),t.push({pathname:"".concat("/filmapp-react-frontend/","film/").concat(e.id),search:"",state:{}})},children:[Object(X.jsx)("img",{className:"p-0",alt:"",src:e.img,style:{height:"24px",marginRight:"10px",width:"24px"}}),Object(X.jsx)("span",{className:"entry__text",children:e.title})]})},e.id)})),!I&&!U&&0===e.length&&Object(X.jsx)("a",{role:"option",className:"dropdown-item disabled",href:"#",children:"No matches found."}),U&&Object(X.jsx)("a",{role:"option",className:"dropdown-item disabled",href:"#",children:"Searching..."}),Object(X.jsx)("div",{style:{height:"8px"},className:"d-flex justify-content-center",children:I&&!D&&Object(X.jsx)(x.a,{animation:"border"})})]}))}})}),Object(X.jsx)(f.a,{sm:2,children:Object(X.jsx)(y.a,{onClick:$,className:"d-none d-sm-inline",variant:"light",children:Object(X.jsx)(p.a,{icon:"search"})})})]})})}),Object(X.jsx)(f.a,{xs:{span:12,order:"last"},sm:{span:12,order:"last"},md:{span:3,order:"last"},children:Object(X.jsx)(b.a.Collapse,{className:"justify-content-end",id:"responsive-navbar-nav",children:Object(X.jsxs)(g.a,{activeKey:"",className:"d-block d-sm-block d-md-flex  align-items-center",children:[Object(X.jsx)(g.a.Link,{className:"px-2",eventKey:"playlists",children:"Playlists"}),s.auth&&Object(X.jsx)(g.a.Link,{className:"px-2",eventKey:"add_film",children:"Add"}),s.auth?Object(X.jsx)(j.a,{onClick:function(e){Q(e.currentTarget)},className:"pe-2 ps-2 custom-avatar m-button",children:s.name.toUpperCase().charAt(0)}):Object(X.jsx)(g.a.Link,{className:"pe-2 ps-2",eventKey:"login ",onClick:function(){return function(){var e=a.pathname;"/filmapp-react-frontend/"===e&&(e=e.slice(0,-1)),t.push({pathname:"".concat(e,"/login"),search:a.search,state:a.state})}()},children:"Login"})]})})}),Object(X.jsxs)(w.a,{id:"film-navbar-menu",anchorEl:Z,keepMounted:!0,open:Boolean(Z),onClose:function(){Q(null)},children:[Object(X.jsx)(k.a,{onClick:function(){Q(null),t.push("".concat("/filmapp-react-frontend/","profile"))},children:"Profile"}),Object(X.jsx)(k.a,{onClick:function(){Q(null);var e=a.pathname;"/filmapp-react-frontend/"===e&&(e=e.slice(0,-1)),t.push({pathname:"".concat(e,"/settings"),search:a.search,state:a.state})},children:"Settings"}),Object(X.jsx)(k.a,{onClick:function(){Q(null),i()},children:"Logout"})]})]})},K=a(588),V=Object(n.createContext)({show:!1,isRemoving:!1,id:null,type:null,title:""}),Z=function(e){var t=Object(n.useContext)(V),a=t.removeModalData,c=t.remove,s=t.clear,i=function(){return s()};return Object(X.jsx)(X.Fragment,{children:Object(X.jsxs)(K.a,{show:a.show,onHide:i,centered:!0,children:[Object(X.jsx)(K.a.Header,{children:Object(X.jsxs)(K.a.Title,{children:["Delete ",a.type]})}),Object(X.jsxs)(K.a.Body,{children:["Do you really want to delete ",a.type," ",Object(X.jsx)("b",{children:a.title}),"?",Object(X.jsx)("br",{}),"Action cannot be undone!"]}),Object(X.jsxs)(K.a.Footer,{children:[Object(X.jsx)(y.a,{variant:"secondary",onClick:i,children:"Cancel"}),Object(X.jsx)(y.a,{variant:"primary",onClick:function(){return c()},children:"Delete"})]})]})})},Q=10,q=40,$=20,ee={films:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null},te=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"load":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1,error:""});case"initial-load":return Object(o.a)(Object(o.a)({},e),{},{films:Object(U.a)(new Set(Object(U.a)(t.payload))),isLoading:!1,isInitialLoaded:!0,isAllFetched:t.payload.length<q});case"success":return Object(o.a)(Object(o.a)({},e),{},{films:Object(U.a)(new Set([].concat(Object(U.a)(e.films),Object(U.a)(t.payload)))),isLoading:!1,isAllFetched:t.payload.length<$,error:null});case"error":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isAllFetched:!1,error:t.payload});default:return e}},ae=a(71),ne=a.n(ae),ce=a(584);var se=function(e){var t=Object(n.useState)("data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="),a=Object(u.a)(t,2),c=a[0],s=a[1];return Object(n.useEffect)((function(){s(e.image)}),[e.image]),Object(X.jsx)(ce.a,{aspectRatio:"16x9",children:Object(X.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:c})})},ie=a(335),re=a(118),le=a(325),oe=function(e){return C.get("users/me",{params:e,headers:L()})},de=function(e){return C.patch("users",e,{headers:L()})};var ue=function(e){return C.post("playlists",e,{headers:L()})},me=function(e){return C.get("playlists/".concat(e),{headers:L()})},pe=function(e){return C.get("playlists",{params:e,headers:L()})},je=function(e,t){return C.patch("playlists/".concat(e),t,{headers:L()})},be=function(e){return C.delete("playlists/".concat(e),{headers:L()})},fe=Object(n.createContext)(""),he={playlists:[],isLoading:!0,isAllFetched:!1,isCreating:!1,isAdding:!1,playlistToUpgrade:null,title:"",isPublic:!1,error:""};function Oe(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({error:""},t.fieldName,t.payload));case"load":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"load-success":return Object(o.a)(Object(o.a)({},e),{},{playlists:[].concat(Object(U.a)(e.playlists),Object(U.a)(t.payload)),isLoading:!1,isAllFetched:t.payload<10,error:""});case"create":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isCreating:!0});case"create-success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isCreating:!1});case"add":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isAdding:!0,playlistToUpgrade:t.payload});case"add-update-playlist":return Object(o.a)(Object(o.a)({},e),{},{playlists:e.playlists.map((function(t){return t.id===e.playlistToUpgrade.id?Object(o.a)(Object(o.a)({},t),{},{contains:!t.contains}):t})),playlistToUpgrade:null});case"add-success":return Object(o.a)(Object(o.a)({},e),{},{isAdding:!1});case"change-playlist-privacy-success":return Object(o.a)(Object(o.a)({},e),{},{playlists:e.playlists.map((function(e){return e.id===t.payload.id?Object(o.a)(Object(o.a)({},e),{},{is_public:t.payload.is_public}):e}))});case"error":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isAllFetched:!1,isCreating:!1,error:t.payload,title:""});default:return e}}var xe=a(559),ye=function(e){var t=e.isPublic,a=e.id,c=e.isProfile,s=e.dispatchPrivacyUpdate,i=e.filmDispatch,r=Object(n.useState)(!1),o=Object(u.a)(r,2),m=o[0],j=o[1];Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(a,{is_public:!t}).then((function(e){j(!1),s({type:"change-playlist-privacy-success",payload:e.data}),void 0!==i&&i({type:"field",fieldName:"reloadPlaylist",payload:!0})})).catch((function(e){console.error(e),j(!1)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}m&&function(){e.apply(this,arguments)}()}),[s,m,t,a,i]);var b=Object(X.jsx)(xe.a,{style:{marginLeft:"auto",borderRadius:"20px",width:"24px",height:"24px"},className:"m-button",onClick:function(e){e.stopPropagation(),m||j(!0)},children:Object(X.jsx)(p.a,{icon:t?"globe-europe":"lock"})});return c?Object(X.jsx)(f.a,{className:"text-center justify-content-center d-flex align-items-center p-0 flex-grow-0",children:Object(X.jsx)(f.a,{className:"remove-holder p-0 m-0 flex-grow-0",style:{height:"24px",width:"24"},children:b})}):b},ge=a(170),ve=a.n(ge);var we=function(e){var t=e.filmID,a=e.handlePlaylistClose,c=e.isPreview,s=e.filmDispatch,i=ve()({background:"black"}),r=Object(u.a)(i,2),m=r[0],j=r[1],b=Object(n.useContext)(fe).createToast,g=Object(n.useReducer)(Oe,he),v=Object(u.a)(g,2),w=v[0],N=v[1],k=w.playlists,A=w.title,C=w.isPublic,L=w.isLoading,E=w.isAllFetched,F=w.isCreating,S=w.isAdding,P=w.playlistToUpgrade,R=w.error,I=Object(n.useCallback)((function(){L||E||F||S||N({type:"load"})}),[L,E,F,S]),D=J(I);return Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe({playlists:!0,skip:k.length,limit:10}).then((function(e){var a=e.data.playlists;a.forEach((function(e){e.contains=e.films.indexOf(t)>-1})),N({type:"load-success",payload:a})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}L&&function(){e.apply(this,arguments)}()}),[t,k,L]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={title:A,is_public:C,films_id:[t]},e.next=3,ue(n).then((function(e){N({type:"create-success"}),b("Created playlist ".concat(A)),a()})).catch((function(e){console.error(e);var t=null;e.response&&e.response.data&&e.response.data.error?t=e.response.data.error:e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors[0]),N({type:"error",payload:"Path `title` is required."===t?"Playlist title is required":t})}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}F&&function(){e.apply(this,arguments)}()}),[F,A,C,b,a,t]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={films_id:[t]},a=P.contains?Object(o.a)(Object(o.a)({},a),{},{is_remove_films:!0}):Object(o.a)(Object(o.a)({},a),{},{is_remove_films:!1}),n=P.contains?"Deleted from playlist ".concat(P.title):"Added to playlist ".concat(P.title),N({type:"add-update-playlist",playlist:P}),e.next=6,je(P.id,a).then((function(e){N({type:"add-success"}),c&&s({type:"field",fieldName:"reloadPlaylist",payload:!0}),b(n)})).catch((function(e){return console.error(e)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}S&&P&&function(){e.apply(this,arguments)}()}),[S,P,b,s,t,c]),Object(X.jsxs)(ie.a.Menu,{onClick:function(e){return e.stopPropagation()},style:{width:"240px"},children:[Object(X.jsxs)(O.a,{className:"m-0 m-button playlist-add-button-ripple",children:[Object(X.jsx)(f.a,{className:"playlist-add-exit-text-width",children:"Save to..."}),Object(X.jsxs)(f.a,{xs:2,sm:2,onClick:function(e){m(e),setTimeout(a,150)},style:{borderRadius:"20px",width:"24px",height:"24px"},className:"playlist-add-icon-holder p-0 playlist-add-button-ripple d-flex align-items-center text-center justify-content-center",children:[Object(X.jsx)(p.a,{icon:"times"}),j]})]}),Object(X.jsx)(ie.a.Divider,{}),Object(X.jsxs)("div",{ref:D,style:{maxHeight:"100px",overflowY:"scroll",minHeight:"3rem"},children:[k.map((function(e,t){return Object(X.jsxs)(O.a,{className:"m-0 playlist-form-group",children:[Object(X.jsx)(f.a,{xs:10,sm:10,className:"p-0",children:Object(X.jsxs)(h.a.Check,{id:e.id,className:"form-check",children:[Object(X.jsx)(re.a.Input,{type:"checkbox",onChange:function(){return function(e){N({type:"add",payload:e})}(e)},checked:e.contains}),Object(X.jsx)(re.a.Label,{children:Object(X.jsx)("p",{className:"playlist-check-label",children:e.title})})]})}),Object(X.jsx)(ye,{id:e.id,isPublic:e.is_public,isProfile:!1,filmDispatch:s,dispatchPrivacyUpdate:N})]},e.id)})),!E&&Object(X.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:L&&Object(X.jsx)(x.a,{animation:"border"})})]}),Object(X.jsx)(ie.a.Divider,{}),Object(X.jsx)(ie.a.ItemText,{children:"Create a new playlist"}),Object(X.jsx)(O.a,{className:"m-0 p-0",children:Object(X.jsxs)(h.a,{children:[Object(X.jsx)(le.a,{isInvalid:""!==R,onChange:function(e){return N({type:"field",fieldName:"title",payload:e.target.value})},className:"mb-2 mt-2",placeholder:"Enter playlist title..."}),Object(X.jsx)(le.a.Feedback,{type:"invalid",className:"mb-2 mt-2",children:R}),Object(X.jsxs)(h.a.Select,{"aria-label":"Privacy",className:"mb-2 mt-2",onChange:function(e){return N({type:"field",fieldName:"isPublic",payload:"public"===e.target.value})},children:[Object(X.jsx)("option",{value:"private",children:"Private"}),Object(X.jsx)("option",{value:"public",children:"Public"})]}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{disabled:F,onClick:F?null:function(e){e.stopPropagation(),N({type:"create"})},children:"Create"}),F&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]})})]})};a(511);var Ne=function(e){var t=Object(n.useContext)(H).user,a=ve()({background:"black"}),c=Object(u.a)(a,2),s=c[0],i=c[1],r=Object(n.useState)(!1),l=Object(u.a)(r,2),o=l[0],d=l[1];return t.auth?Object(X.jsxs)(ie.a,{show:o,onToggle:function(e,t,a){d(e)},className:e.isPreview?"col-sm-2 col-2 p-0":"",children:[Object(X.jsx)(ie.a.Toggle,{variant:"link",bsPrefix:"p-0",className:"m-button playlist-add-button-ripple",style:{color:"black"},children:Object(X.jsx)("div",{style:{display:"inline-block",width:"100%",height:"100%"},children:Object(X.jsxs)(f.a,{onClick:s,style:{verticalAlign:"top",borderRadius:"20px",width:"24px",height:"24px"},className:"playlist-add-icon-holder p-0 playlist-add-button-ripple",children:[Object(X.jsx)(p.a,{style:{opacity:o?1:""},className:"playlist-add-icon",icon:"ellipsis-v"}),i]})})}),o&&Object(X.jsx)(we,{isPreview:e.isPreview,filmDispatch:e.filmDispatch,isOpen:o,filmID:e.filmID,handlePlaylistClose:function(){d(!1)}})]}):null},ke=function(e){return!!("path"===e.tagName&&e.parentNode.className.animVal&&e.parentNode.className.animVal.includes("playlist-add-icon")||"svg"===e.tagName&&e.className.animVal&&e.className.animVal.includes("playlist-add-icon")||e.className&&"string"===typeof e.className&&e.className.includes("playlist-add-icon-holder"))},Ae=function(e){var t=new Date(Date.parse(e.createdAt));return("0"+t.getDate()).slice(-2)+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getFullYear()).slice(-2)+" o "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)},Ce=function(e){var t=e.handleRemove;return Object(X.jsx)(f.a,{className:"text-center justify-content-center d-flex align-items-center p-0 flex-grow-0",children:Object(X.jsx)(f.a,{className:"remove-holder p-0 m-0 flex-grow-0",style:{height:"24px",width:"24px"},children:Object(X.jsx)(xe.a,{style:{marginLeft:"auto",borderRadius:"20px",width:"24px",height:"24px"},className:"m-button ",onClick:t,children:Object(X.jsx)(p.a,{icon:"trash-alt"})})})})},Le=(a(286),function(e){var t=e.film,a=e.index,n=e.handleRedirect,c=e.handleRemove,s=e.isProfile,i=e.isRecommendations;return Object(X.jsx)("div",{className:i?"row mx-0 mb-4":"col mb-5 col-12 col-sm-6 col-md-3 col-lg-2",children:Object(X.jsxs)("div",{className:(i?"row p-0 m-0":"col").concat(" play-outer-container remove-container"),onClick:function(e){ke(e.target)||n(t.id)},children:[Object(X.jsx)(f.a,{xs:i?6:12,sm:i?6:12,className:"m-0 p-0",children:Object(X.jsxs)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:[Object(X.jsx)(se,{image:t.img}),Object(X.jsx)(p.a,{className:"play-middle",icon:"play"})]})}),Object(X.jsxs)(f.a,{xs:i?6:12,sm:i?6:12,className:i?"m-0":"m-0 p-0",children:[Object(X.jsxs)(O.a,{className:"m-0 mt-1",children:[Object(X.jsx)(f.a,{className:"film-preview-playlist-title-width p-0",children:Object(X.jsx)(ne.a,{line:1,text:t.title,className:"mb-1 mt-1 title "})}),Object(X.jsx)(f.a,{className:"p-0 d-flex justify-content-end",children:s?Object(X.jsx)(Ce,{handleRemove:c}):Object(X.jsx)(Ne,{index:a,filmID:t.id})})]}),Object(X.jsx)("p",{className:"mb-0 author-nick-color",children:Object(X.jsx)("small",{children:t.author_name})}),Object(X.jsx)("p",{className:"mb-0 film-views",children:Object(X.jsxs)("small",{children:[t.views," views"]})})]})]})})});var Ee=function(e){var t=Object(m.g)(),a=Object(n.useReducer)(te,ee),c=Object(u.a)(a,2),s=c[0],i=c[1],r=s.films,o=s.isLoading,p=s.isAllFetched,j=s.isInitialLoaded,b=Object(n.useCallback)((function(){o||p||!j||i({type:"load"})}),[o,p,j]);J(b,{triggerOnNoScroll:!0}),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({limit:q}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})),i({type:"initial-load",payload:t})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({skip:r.length,limit:$}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})),i({type:"success",payload:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o&&j&&r&&function(){e.apply(this,arguments)}()}),[o,j,r]);var f=function(e){t.push({pathname:"".concat("/filmapp-react-frontend/","film/")+e})};return Object(X.jsxs)(O.a,{className:"mt-5 mx-2",children:[r&&r.map((function(e,t){return Object(X.jsx)(Le,{film:e,index:t,handleRedirect:f},e.id)})),!p&&Object(X.jsx)("div",{style:{height:"32px",width:"100%"},className:"d-flex justify-content-center",children:(o||!j)&&Object(X.jsx)(x.a,{animation:"border"})})]})},Fe=a(113),Se=a.n(Fe),Pe=a(331),Re=Object(n.createContext)(),Ie=(a(542),{film:{img:"",video:"",film:"",title:"",views:"",likes:"",dislikes:"",description:"\r\n\n\n"},isLiked:!1,isDisliked:!1,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});function De(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"like":return Object(o.a)(Object(o.a)({},e),{},{isLikeButtonClicked:!0,likeAction:t.payload});case"success":return Object(o.a)(Object(o.a)({},e),{},{film:t.film,isLiked:t.isLiked,isDisliked:t.isDisliked,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});case"error":return Object(o.a)(Object(o.a)({},e),{},{isLikeButtonClicked:!1,likeAction:null});default:return e}}var Te=function(e){var t=Object(m.g)(),a=Object(m.h)(),s=Object(n.useContext)(H).user,i=Object(n.useContext)(Re),r=Object(u.a)(i,2),j=(r[0],r[1]),b=Object(n.useCallback)((function(e){null!==e&&(j({type:"field",fieldName:"playerHeight",payload:e.getBoundingClientRect().height}),D(e))}),[j]),h=Object(n.useReducer)(De,Ie),x=Object(u.a)(h,2),g=x[0],v=x[1],w=g.film,N=g.isLiked,k=g.isDisliked,A=g.isLikeButtonClicked,C=g.likeAction,L=g.isDescExpanded,E=Object(n.useState)(null),S=Object(u.a)(E,2),R=S[0],D=S[1];Object(n.useEffect)((function(){if(R){var e=function(){j({type:"field",fieldName:"playerHeight",payload:R.getBoundingClientRect().height})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[R,j]),Object(n.useEffect)((function(){function t(){return(t=Object(d.a)(l.a.mark((function t(){var a,n,c,i,r,d,m,p,b,f,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[F(e.match.params.id),P(e.match.params.id)],s.auth&&a.push(oe({details:!0})),t.next=4,Promise.allSettled(a);case 4:if(n=t.sent,c=Object(u.a)(n,3),i=c[0],r=c[1],d=c[2],"rejected"!==i.status&&"rejected"!==r.status){t.next=12;break}return j({type:"field",fieldName:"error",payload:!0}),t.abrupt("return");case 12:m=i.value.data,j({type:"success",comments:m.comments,commentsCount:m.comments_count}),p=Object(o.a)(Object(o.a)({},m),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/thumbnail?width=poster"),video:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/video"),views:r.value.data.views}),b=!1,f=!1,d&&"fulfilled"===d.status&&(h=d.value.data.details,b=h.liked.indexOf(e.match.params.id)>-1,f=h.disliked.indexOf(e.match.params.id)>-1),v({type:"success",film:p,isLiked:b,isDisliked:f});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.match.params.id,j,s.auth]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var n,c,s,i,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==C){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,I(w.id,{action:C});case 5:return n=e.sent,(c=n.data).img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(c.id,"/thumbnail?width=poster"),c.video="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(c.id,"/video"),e.next=11,oe({details:!0});case 11:s=e.sent,i=s.data.details,r=i.liked.indexOf(c.id)>-1,o=i.disliked.indexOf(c.id)>-1,v({type:"success",film:c,isLiked:r,isDisliked:o}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(2),console.error(e.t0),v({type:"error"}),e.t0.response&&401===e.t0.response.status&&t.push("".concat(a.pathname,"/login"));case 23:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}A&&function(){e.apply(this,arguments)}()}),[w.id,A,C,t,a]);var T=function(e){e.preventDefault(),v({type:"field",fieldName:"isDescExpanded",payload:!L})},B=function(e){A||v({type:"like",payload:e})},U=function(e){return Object(X.jsx)("span",{children:Object(X.jsx)(y.a,{variant:"link",className:"p-0 m-0 mb-1 title fw-bold",onClick:T,children:e})})};return Object(X.jsxs)(f.a,{children:[Object(X.jsx)(f.a,{sm:12,children:Object(X.jsx)("div",{ref:b,children:Object(X.jsx)(Pe.Player,{playsInline:!0,poster:w.img,src:w.video})})}),w&&Object(X.jsxs)(c.a.Fragment,{children:[Object(X.jsx)(f.a,{className:"mt-4",sm:12,children:Object(X.jsxs)(O.a,{className:"p-0 m-0",children:[Object(X.jsxs)(f.a,{sm:12,className:"p-0",children:[!w.title&&Object(X.jsx)("p",{className:"fw-bold",children:Object(X.jsx)("br",{})}),Object(X.jsx)("p",{className:"fw-bold",children:w.title})]}),Object(X.jsx)(f.a,{xs:4,sm:4,className:"p-0",children:Object(X.jsxs)("p",{children:[Object(X.jsx)(p.a,{icon:"eye"})," \u2002",w.views]})}),Object(X.jsx)(f.a,{xs:4,sm:4,className:"text-right d-flex justify-content-end",children:Object(X.jsxs)("p",{style:{cursor:"pointer"},className:N?"film-picked-thumb-color":"",onClick:function(){return B("like")},children:[Object(X.jsx)(p.a,{icon:"thumbs-up"}),"\u2002",w.likes]})}),Object(X.jsx)(f.a,{xs:4,sm:4,children:Object(X.jsxs)("p",{style:{cursor:"pointer"},className:k?"film-picked-thumb-color":"",onClick:function(){return B("dislike")},children:[Object(X.jsx)(p.a,{icon:"thumbs-down"}),"\u2002",w.dislikes]})}),Object(X.jsx)(f.a,{sm:12,className:"mt-4 mb-4 divider"}),Object(X.jsxs)(f.a,{sm:12,className:"p-0",style:{whiteSpace:"pre-line",textAlign:"justify"},children:[Object(X.jsx)(ne.a,{line:!L&&2,truncateText:"\u2026",text:w.description,textTruncateChild:U("Show more")}),L&&U("Show less")]})]})}),Object(X.jsx)(f.a,{sm:12,className:"mt-4 mb-2 divider"})]})]})},Be={films:null,id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null};function He(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"clear":return Be;case"initial-success":return Object(o.a)(Object(o.a)({},Be),{},{films:t.films,id:t.id,isInitialLoaded:!0});case"load":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(o.a)(Object(o.a)({},e),{},{films:[].concat(Object(U.a)(e.films),Object(U.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<12});case"error":return Object(o.a)(Object(o.a)({},Be),{},{error:t.payload});default:return e}}var Ue=function(e){var t=Object(n.useContext)(Re),a=Object(u.a)(t,2),c=a[0],s=(a[1],Object(n.useReducer)(He,Be)),i=Object(u.a)(s,2),r=i[0],o=i[1],m=r.films,p=r.isLoading,j=r.isAllFetched,b=r.isInitialLoaded,h=r.id,O=r.error,y=Object(n.useCallback)((function(){p||j||!b||O||!h||o({type:"load"})}),[p,j,b,O,h]);return J(y),Object(n.useEffect)((function(){function t(){return(t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E({exclude:e.match.params.id,limit:12}).then((function(t){var a=t.data;a.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})),o({type:"initial-success",films:a,id:e.match.params.id})})).catch((function(e){return console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}o({type:"clear"}),c.isPreviewLoaded&&function(){t.apply(this,arguments)}()}),[e.match.params.id,c.isPreviewLoaded]),Object(n.useEffect)((function(){c.error&&o({type:"error",payload:c.error})}),[c.error]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({exclude:h,skip:m.length,limit:12}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})),o({type:"success",payload:t})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}p&&m&&h&&function(){e.apply(this,arguments)}()}),[p,h,m]),Object(X.jsxs)(f.a,{children:[m&&m.map((function(t,a){return Object(X.jsx)(Le,{film:t,index:a,isRecommendations:!0,handleRedirect:function(){return e.handleRedirect(t.id)}},t.id)})),!j&&Object(X.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:(p||!b)&&!O&&Object(X.jsx)(x.a,{animation:"border"})})]})},Me=a(585),Ge=a(589),_e=a(332),Ye=a.n(_e),ze=function(e,t){return C.get("films/".concat(e,"/comments"),{params:t})},Je=function(e){return C.delete("comments/".concat(e),{headers:L()})},Xe=function(e,t){return C.get("films/".concat(e,"/comments/sort"),{params:t,headers:L()})},We={comments:null,commentsCount:null,text:"",id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,isAdding:!1,isRemoving:!1,toRemove:null,isSorting:!1,sort:null,sorts:[{id:"created_at",title:"By date",dir:1},{id:"author_name",title:"By author name",dir:1}],error:null};function Ke(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"clear":return Object(o.a)(Object(o.a)({},We),{},{id:t.id});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.isAdding||e.error||!e.id||e.isSorting?e:Object(o.a)(Object(o.a)({},e),{},{isLoading:!0});case"initial-success":return Object(o.a)(Object(o.a)({},e),{},{comments:t.comments,commentsCount:t.commentsCount,isAllFetched:t.comments.length<Q,isInitialLoaded:!0,error:null});case"load-success":return Object(o.a)(Object(o.a)({},e),{},{comments:[].concat(Object(U.a)(e.comments),Object(U.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<Q});case"add":return Object(o.a)(Object(o.a)({},e),{},{isAdding:!0,error:null});case"add-success":return Object(o.a)(Object(o.a)({},e),{},{text:"",commentsCount:e.commentsCount+1,comments:[t.payload].concat(Object(U.a)(e.comments)),isAdding:!1});case"remove":return Object(o.a)(Object(o.a)({},e),{},{isRemoving:!0,toRemove:t.payload});case"remove-success":return Object(o.a)(Object(o.a)({},e),{},{isRemoving:!1,toRemove:null,commentsCount:e.commentsCount-1,comments:e.toRemove?e.comments.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"sort":return Object(o.a)(Object(o.a)({},e),{},{comments:null,isAllFetched:!1,sorts:e.sorts.map((function(e){return e.id===t.sortToChange.id?t.sortToChange:e})),sort:t.sort,isSorting:!0});case"sort-success":return Object(o.a)(Object(o.a)({},e),{},{isSorting:!1,comments:t.payload});case"error":return Object(o.a)(Object(o.a)({},e),{},{isAdding:!1,isLoading:!1,isSorting:!1,error:t.payload});default:return e}}var Ve=function(e){var t=Object(n.useContext)(V),a=t.showModal,c=t.clear,s=t.removeModalData,i=Object(n.useContext)(H).user,r=Object(n.useContext)(Re),o=Object(u.a)(r,2),m=o[0],j=o[1],b=Object(n.useReducer)(Ke,We),h=Object(u.a)(b,2),g=h[0],v=h[1],w=g.comments,N=g.commentsCount,k=g.text,A=g.isInitialLoaded,E=g.isLoading,F=g.isAllFetched,S=g.isAdding,P=g.id,R=g.isRemoving,I=g.toRemove,D=g.isSorting,T=g.sort,B=g.sorts,U=g.error,G=Object(n.useCallback)((function(){E||F||!A||S||U||!P||D||v({type:"load"})}),[E,F,A,S,U,P,D]);return J(G),Object(n.useEffect)((function(){v({type:"clear",id:e.match.params.id})}),[e.match.params.id]),Object(n.useEffect)((function(){m.error&&v({type:"error",payload:m.error})}),[m.error]),Object(n.useEffect)((function(){m.comments&&null!==m.commentsCount&&v({type:"initial-success",comments:m.comments,commentsCount:m.commentsCount})}),[m.comments,m.commentsCount,j]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ze(P,{skip:w.length,limit:Q}).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe(P,(t={},Object(M.a)(t,T.id,T.dir),Object(M.a)(t,"skip",w.length),Object(M.a)(t,"limit",Q),t)).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}E&&A&&!S&&w&&P&&!D&&(T?function(){t.apply(this,arguments)}():function(){e.apply(this,arguments)}())}),[E,S,P,w,A,D,T]),Object(n.useEffect)((function(){S&&!E&&P&&function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={text:k},e.next=3,(a=P,n=t,C.post("films/".concat(a,"/comments"),n,{headers:L()})).then((function(e){v({type:"add-success",payload:e.data})})).catch((function(e){v({type:"error",payload:e.response.status})}));case 3:case"end":return e.stop()}var a,n}),e)})));return function(){return e.apply(this,arguments)}}()()}),[S,E,P,k]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(I.id).then((function(e){v({type:"remove-success"}),c()})).catch((function(e){c(),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&I&&s.isRemoving&&s.id===I.id&&"comment"===s.type&&s.title===I.text.substring(0,10).concat("...")&&function(){e.apply(this,arguments)}()}),[R,I,c,s]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=T?(t={},Object(M.a)(t,T.id,T.dir),Object(M.a)(t,"limit",Q),t):{},e.next=3,Xe(P,a).then((function(e){v({type:"sort-success",payload:e.data})})).catch((function(e){v({type:"error",payload:"Sort error."}),console.error(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}D&&function(){e.apply(this,arguments)}()}),[D,T,P]),Object(X.jsxs)(f.a,{children:[Object(X.jsxs)(O.a,{className:"p-0 mt-4 mb-4",children:[Object(X.jsx)(f.a,{xs:7,sm:5,md:4,className:"d-flex align-items-center ",children:null!==N&&Object(X.jsxs)("span",{children:[N,1===N?" comment":" comments"," "]})}),Object(X.jsx)(f.a,{xs:2,sm:2,children:Object(X.jsx)(Me.a,{variant:"secondary",title:"Sort",id:"dropdown-button-drop-down",onSelect:function(e){return function(e){var t=null;switch(e){case"created_at":t=B[0];break;case"author_name":t=B[1];break;default:return}var a=null;T&&T.id===t.id?(t.dir*=-1,a=t,1===t.dir&&(a=null)):a=t,v({type:"sort",sortToChange:t,sort:a})}(e)},children:B.map((function(e){return Object(X.jsxs)(ie.a.Item,{eventKey:e.id,active:T&&e.id===T.id,children:[e.title,T&&T.id===e.id&&1===e.dir?Object(X.jsx)(p.a,{className:"ms-2",icon:"sort-up"}):T&&T.id===e.id&&-1===e.dir?Object(X.jsx)(p.a,{className:"ms-2",icon:"sort-down"}):""]},e.id)}))})})]}),Object(X.jsx)(Ge.a,{value:k,onChange:function(e){return v({type:"field",fieldName:"text",payload:e.target.value})},type:"text",id:"standard-multiline-flexible",label:"Comment",multiline:!0,fullWidth:!0,maxrow:"4"}),Object(X.jsx)(f.a,{className:"d-flex justify-content-end",children:Object(X.jsx)(y.a,{disabled:S||!k,className:"mt-3",variant:"primary",onClick:k&&!S?function(){v({type:"add"})}:null,children:"Submit"})}),S&&Object(X.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:Object(X.jsx)(x.a,{animation:"border"})}),w&&w.map((function(e){return Object(X.jsxs)(f.a,{className:"p-0 mt-4 remove-container",sm:12,children:[Object(X.jsxs)("div",{className:"d-flex",children:[Object(X.jsx)("p",{className:"m-0 fw-bold",children:Object(X.jsxs)("small",{className:"m-0 fw-bold",children:[e.author_name,"\xa0"]})}),Object(X.jsx)("p",{children:Object(X.jsx)("small",{className:"m-0",children:Ae(e)})}),i.id===e.author_id&&Object(X.jsx)(f.a,{xs:2,sm:2,className:"d-flex justify-content-center align-items-center remove-holder p-0 m-0 ms-auto",style:{height:"24px",width:"24px"},children:Object(X.jsx)(Ye.a,{style:{borderRadius:"20px",width:"24px",height:"24px"},className:"m-button cursor-pointer",onClick:function(){return function(e){s.isRemoving||(v({type:"remove",payload:e}),a(e.id,"comment",e.text.substring(0,10).concat("...")))}(e)},children:Object(X.jsx)(p.a,{icon:"trash-alt"})})})]}),Object(X.jsx)("p",{className:"d-block d-sm-block",children:Object(X.jsx)("small",{children:e.text})})]},e.id)})),!F&&Object(X.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:(E||!A||D)&&!U&&Object(X.jsx)(x.a,{animation:"border"})})]})},Ze=a.p+"static/media/image_not_found.c4ba1e76.png",Qe=(a(547),a(333)),qe=a.n(Qe),$e={playlist:null,currentFilm:null,currentFilmIndex:0,isLoading:!1,isRemovingPlaylist:!1,isRemovingFilm:!1,removingFilmId:null,headerHeight:null,playerHeight:null},et=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,playlist:t.playlist,currentFilm:t.currentFilm,currentFilmIndex:t.currentFilmIndex});case"clear":return $e;case"remove-film":return Object(o.a)(Object(o.a)({},e),{},{removingFilmId:t.payload,isRemovingFilm:!0});case"remove-film-success":if(!e.removingFilmId)return Object(o.a)(Object(o.a)({},e),{},{isRemovingFilm:!1});var a=e.playlist.films.filter((function(t){return t.id!==e.removingFilmId}));return Object(o.a)(Object(o.a)({},e),{},{currentFilm:e.removingFilmId===e.currentFilm?null:e.currentFilm,currentFilmIndex:e.removingFilmId===e.currentFilm?0:a.findIndex((function(t){return t.id===e.currentFilm}))+1,playlist:Object(o.a)(Object(o.a)({},e.playlist),{},{films:a}),isRemovingFilm:!1});case"change-playlist-privacy-success":return Object(o.a)(Object(o.a)({},e),{},{playlist:Object(o.a)(Object(o.a)({},e.playlist),{},{is_public:t.payload.is_public})});case"error":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}};var tt=function(e){var t=Object(n.useContext)(V),a=t.showModal,c=t.clear,s=t.removeModalData,i=Object(m.h)(),r=Object(n.useContext)(H).user,o=Object(n.useContext)(Re),j=Object(u.a)(o,2),b=j[0],h=j[1],x=Object(n.useReducer)(et,$e),y=Object(u.a)(x,2),g=y[0],v=y[1],w=g.playlist,N=g.isRemovingPlaylist,k=g.isRemovingFilm,A=g.removingFilmId,C=g.currentFilm,L=g.currentFilmIndex,E=g.headerHeight,F=g.playerHeight,S=g.error,P=function(){v({type:"clear"})},R=Object(n.useCallback)((function(e){null!==e&&v({type:"field",fieldName:"headerHeight",payload:e.getBoundingClientRect().height})}),[]);Object(n.useEffect)((function(){v({type:"field",fieldName:"playerHeight",payload:b.playerHeight})}),[b.playerHeight]),Object(n.useEffect)((function(){v({type:"error",payload:b.error})}),[b.error]),Object(n.useEffect)((function(){function t(){return(t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,me(w.id).then((function(t){var a=0,n=null;return Array.prototype.forEach.call(t.data.films,(function(t,c){t&&t.id===e.match.params.id&&(a=c+1,n=t.id)})),v({type:"success",playlist:t.data,currentFilm:n,currentFilmIndex:a}),h({type:"field",fieldName:"reloadPlaylist",payload:!1}),t.data})).catch((function(e){console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}b.reloadPlaylist&&w&&function(){t.apply(this,arguments)}()}),[b.reloadPlaylist,w,h,e.match.params.id]),Object(n.useEffect)((function(){var t=Se.a.parse(i.search);function a(){return(a=Object(d.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,me(t.list).then((function(t){var a=0,n=null;return Array.prototype.forEach.call(t.data.films,(function(t,c){t&&t.id===e.match.params.id&&(a=c+1,n=t.id)})),v({type:"success",playlist:t.data,currentFilm:n,currentFilmIndex:a}),t.data})).catch((function(e){console.error(e),P()}));case 2:case"end":return a.stop()}}),a)})))).apply(this,arguments)}t.list?!S&&b.isPreviewLoaded&&function(){a.apply(this,arguments)}():P()}),[e.match.params.id,i.search,S,b.isPreviewLoaded]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(w.id).then((function(e){P(),c()})).catch((function(e){console.error(e),c()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}N&&s.isRemoving&&s.id===w.id&&"playlist"===s.type&&s.title===w.title&&function(){e.apply(this,arguments)}()}),[c,N,w,s]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(w.id,{films_id:[A],is_remove_films:!0}).then((function(e){v({type:"remove-film-success"})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}k&&function(){e.apply(this,arguments)}()}),[k,w,A]);var I=function(e){k||v({type:"remove-film",payload:e})};return w&&F&&!S&&Object(X.jsx)(f.a,{className:"mb-4",children:Object(X.jsxs)(f.a,{className:"p-0 border",children:[Object(X.jsx)(f.a,{ref:R,style:{height:E+"px"},className:"remove-container pt-2 pb-2 film-preview-playlist-header",sm:12,children:Object(X.jsxs)(O.a,{className:"m-0 px-2",children:[Object(X.jsx)(f.a,{className:"film-preview-playlist-title-width",children:Object(X.jsx)("p",{className:"mb-1 fw-bold film-preview-playlist-text-truncate",children:w.title})}),Object(X.jsx)(f.a,{className:"justify-content-end d-flex",children:r.id===w.author_id&&Object(X.jsx)(Ce,{handleRemove:function(){s.isRemoving||(v({type:"field",fieldName:"isRemovingPlaylist",payload:!0}),a(w.id,"playlist",w.title))}})}),Object(X.jsxs)(f.a,{xs:12,sm:12,children:[r.id===w.author_id&&Object(X.jsx)(ye,{id:w.id,isPublic:w.is_public,isProfile:!1,dispatchPrivacyUpdate:v}),r.id===w.author_id&&Object(X.jsx)("small",{children:"\xa0"}),Object(X.jsxs)("small",{children:[w.author_name,"\xa0"]}),Object(X.jsxs)("small",{className:"film-preview-playlist-index",children:["- ",L,"/",w.films.length]})]})]})}),Object(X.jsx)(f.a,{style:{height:F-E+"px"},className:"p-0 film-preview-playlist-container",xs:12,sm:12,children:Object(X.jsx)(qe.a,{onYReachEnd:function(){},onScrollY:function(){},children:w.films.map((function(t,a){return t&&!t.isNonExisting?Object(X.jsxs)(O.a,{xs:12,sm:12,className:"m-0 p-0 remove-container",children:[Object(X.jsx)(f.a,{xs:9,sm:9,className:a===w.films.length-1?"mt-3 mb-3 ":"mt-3",onClick:function(){return e.handleRedirect(t.id)},children:Object(X.jsxs)(O.a,{className:"m-0 p-0 play-outer-container",children:[Object(X.jsx)(f.a,{xs:1,sm:1,className:"text-center justify-content-center d-flex align-items-center p-0 ps-1",children:C===t.id?Object(X.jsx)("small",{children:Object(X.jsx)(p.a,{style:{fontWeight:300},icon:"play"})}):Object(X.jsx)("small",{children:a+1})}),Object(X.jsx)(f.a,{xs:6,sm:6,className:"pe-2 ps-2",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(X.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:Object(X.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail?width=small")})})}),Object(X.jsxs)(f.a,{xs:5,sm:5,className:"p-0",children:[Object(X.jsx)(ne.a,{line:1,text:t.title,className:"mb-0 title fw-bold"}),Object(X.jsx)("p",{className:"mb-1 author-nick-color",children:Object(X.jsx)("small",{children:t.author_name})})]})]})}),r.id===w.author_id&&Object(X.jsx)(Ce,{handleRemove:function(){return I(t.id)}})]},t.id):Object(X.jsxs)(O.a,{xs:12,sm:12,className:"m-0 p-0 remove-container",children:[Object(X.jsx)(f.a,{xs:9,sm:9,className:a===w.films.length-1?"mt-3 mb-3 ":"mt-3",children:Object(X.jsxs)(O.a,{className:"m-0 p-0",children:[Object(X.jsx)(f.a,{xs:1,sm:1,className:"text-center justify-content-center d-flex align-items-center p-0 ps-1",children:Object(X.jsx)("small",{children:a+1})}),Object(X.jsx)(f.a,{xs:6,sm:6,className:"pe-2 ps-2",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(X.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:Object(X.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:Ze})})}),Object(X.jsx)(f.a,{xs:5,sm:5,className:"p-0",children:Object(X.jsx)(ne.a,{line:2,text:"Not found",className:"mb-0 title fw-bold"})})]})}),r.id===w.author_id&&Object(X.jsx)(Ce,{handleRemove:function(){return I(t.id)}})]},t.id)}))})})]})})},at=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],s=function(){c(window.innerWidth<600)};return Object(n.useEffect)((function(){return s(),window.addEventListener("resize",s),function(){return window.removeEventListener("resize",s)}}),[]),a},nt={isPreviewLoaded:!1,comments:null,commentsCount:null,playerHeight:null,reloadPlaylist:!1,error:null},ct=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"success":return Object(o.a)(Object(o.a)({},e),{},{isPreviewLoaded:!0,comments:t.comments,commentsCount:t.commentsCount,error:null});case"reset-comments":return Object(o.a)(Object(o.a)({},e),{},{comments:null,commentsCount:null});default:return e}},st=function(e){var t=e.children,a=Object(n.useReducer)(ct,nt),c=Object(u.a)(a,2),s=c[0],i=c[1];return Object(X.jsx)(Re.Provider,{value:[s,i],children:t})};var it=function(e){var t=Object(m.g)(),a=Object(m.h)(),n=at(),c=function(e){var n=Se.a.parse(a.search),c={pathname:"".concat("/filmapp-react-frontend/","film/")+e};n.list&&(c=Object(o.a)(Object(o.a)({},c),{},{search:"?list=".concat(n.list)})),t.push(c)};return Object(X.jsx)(st,{children:Object(X.jsxs)(O.a,{className:"p-0 m-0 mt-4 mx-2",children:[Object(X.jsxs)(f.a,{xs:{span:12,order:"first"},sm:8,children:[Object(X.jsx)(Te,Object(o.a)({},e)),!n&&Object(X.jsx)(Ve,Object(o.a)({},e))]}),Object(X.jsxs)(f.a,{xs:{span:12,order:2},sm:4,children:[Object(X.jsx)(tt,Object(o.a)({handleRedirect:c},e)),Object(X.jsx)(Ue,Object(o.a)({handleRedirect:c},e))]}),n&&Object(X.jsx)(f.a,{xs:{span:12,order:"last"},sm:8,children:Object(X.jsx)(Ve,Object(o.a)({},e))})]})})},rt=a(586),lt=function(e){return C.post("auth",{},{auth:{username:e.email,password:e.password}})},ot=function(e){return C.post("users",e)},dt=function(e){return C.post("auth/password/forgot",e)},ut=function(e,t){return C.post("auth/password/reset/".concat(e),t)},mt={email:"",nick:"",password:"",isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},pt=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({isSubmitted:!1},t.fieldName,t.payload));case"submit":return Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,isSubmitted:!0});case"send":return Object(o.a)(Object(o.a)({},e),{},{isSending:!0});case"success":return Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,isSending:!1,isSuccess:!0});case"error":return Object(o.a)(Object(o.a)({},e),{},{isSending:!1,isError:!0,error:t.payload});default:return e}};var jt=function(e){var t=Object(n.useContext)(H).login,a=Object(m.g)(),c=Object(m.h)(),s=Object(n.useReducer)(pt,mt),i=Object(u.a)(s,2),r=i[0],o=i[1],p=r.email,j=r.password,b=r.isSubmitted,O=r.isSending,g=r.isError,v=r.error,w=Object(n.useState)(!0),N=Object(u.a)(w,2),k=N[0],A=N[1];Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt({email:p,password:j}).then((function(e){t(e.data.user.name,e.data.user.id,e.data.token,e.data.refreshToken);var n=c.pathname.slice(0,-6);""===n&&(n="/filmapp-react-frontend/"),a.replace({pathname:n,search:c.search,state:c.state})})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors),o({type:"error",payload:t}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}O&&function(){e.apply(this,arguments)}()}),[O,p,j,a,c,t]);var C=function(){A(!1),c.state?a.push("/filmapp-react-frontend/"):a.goBack()};return Object(X.jsxs)(K.a,{onHide:C,show:k,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(X.jsx)(K.a.Header,{closeButton:!0,children:Object(X.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:"Login"})}),Object(X.jsxs)(K.a.Body,{children:[Object(X.jsxs)(h.a,{onSubmit:O?null:function(e){e.preventDefault(),o({type:"submit"}),p&&j&&o({type:"send"})},children:[Object(X.jsxs)(h.a.Group,{children:[Object(X.jsx)(h.a.Label,{htmlFor:"email",children:"Email"}),Object(X.jsx)(h.a.Control,{isInvalid:b&&!p,type:"email",name:"email",value:p,onChange:function(e){return o({type:"field",fieldName:"email",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Email is required"})]}),Object(X.jsxs)(h.a.Group,{className:"mt-2",children:[Object(X.jsx)(h.a.Label,{htmlFor:"password",children:"Password"}),Object(X.jsx)(h.a.Control,{isInvalid:b&&!j,type:"password",name:"password",value:j,onChange:function(e){return o({type:"field",fieldName:"password",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Password is required"})]}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{disabled:O,type:"submit",className:"btn-primary",children:"Login"}),O&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]}),g&&Object(X.jsx)(rt.a,{variant:"danger",className:"mt-2 mb-0",children:v||"Error while logging in."}),Object(X.jsx)(y.a,{variant:"link",onClick:function(){a.goBack(),setTimeout((function(){a.push("".concat(c.pathname.slice(0,-5),"register").concat(c.search))}),500)},className:"p-0 mt-2 btn btn-link",children:"Register"}),Object(X.jsx)(f.a,{className:"p-0 m-0 ",xs:12,sm:12,children:Object(X.jsx)(y.a,{variant:"link",onClick:function(){a.goBack(),setTimeout((function(){a.push("".concat(c.pathname.slice(0,-5),"forgot").concat(c.search))}),500)},className:"p-0 mt-2 btn btn-link",children:"Forgot password?"})})]}),Object(X.jsx)(K.a.Footer,{children:Object(X.jsx)(y.a,{onClick:C,children:"Close"})})]})};var bt=function(e){var t=Object(m.g)(),a=Object(n.useContext)(H).login,c=Object(n.useReducer)(pt,mt),s=Object(u.a)(c,2),i=s[0],r=s[1],o=i.email,p=i.nick,j=i.password,b=i.isSubmitted,f=i.isSuccess,O=i.isSending,g=i.isError,v=i.error,w=Object(n.useState)(!0),N=Object(u.a)(w,2),k=N[0],A=N[1];Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ot({email:o,password:j,name:p}).then((function(e){r({type:"success"}),setTimeout((function(){a(e.data.user.name,e.data.user.id,e.data.token,e.data.refreshToken),t.goBack()}),1500)})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors?t=e.response.data.errors:e.response&&e.response.data&&e.response.data.error&&(t=e.response.data.error),r({type:"error",payload:t}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}O&&function(){e.apply(this,arguments)}()}),[O,o,p,j,t,a]);var C=function(){A(!1),t.goBack()};return Object(X.jsxs)(K.a,{onHide:C,show:k,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(X.jsx)(K.a.Header,{closeButton:!0,children:Object(X.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:"Register"})}),Object(X.jsx)(K.a.Body,{children:Object(X.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),r({type:"submit"}),o&&p&&j&&j.length>=6&&r({type:"send"})},children:[Object(X.jsxs)(h.a.Group,{children:[Object(X.jsx)(h.a.Label,{htmlFor:"nick",children:"Nick"}),Object(X.jsx)(h.a.Control,{isInvalid:b&&!p,type:"text",name:"nick",value:p,onChange:function(e){return r({type:"field",fieldName:"nick",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Nick is required"})]}),Object(X.jsxs)(h.a.Group,{className:"mt-2",children:[Object(X.jsx)(h.a.Label,{htmlFor:"email",children:"Email"}),Object(X.jsx)(h.a.Control,{isInvalid:b&&!o,type:"email",name:"email",value:o,onChange:function(e){return r({type:"field",fieldName:"email",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Email is required"})]}),Object(X.jsxs)(h.a.Group,{className:"mt-2",children:[Object(X.jsx)(h.a.Label,{htmlFor:"password",children:"Password"}),Object(X.jsx)(h.a.Control,{isInvalid:b&&j.length<6,type:"password",name:"password",value:j,maxLength:"11",onChange:function(e){return r({type:"field",fieldName:"password",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:0===j.length?"Password is required":"Password too short (min 6 chars)"})]}),f&&Object(X.jsx)(rt.a,{variant:"success",className:"mt-2",children:"You have successfully registered and logged in."}),g&&Object(X.jsx)(rt.a,{variant:"danger",className:"mt-2",children:v||"Error while registtering."}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{type:"submit",className:"btn-primary",children:"Register"}),O&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]})}),Object(X.jsx)(K.a.Footer,{children:Object(X.jsx)(y.a,{onClick:C,children:"Close"})})]})},ft=a(323),ht=(a(550),a(587)),Ot=a(334),xt={films:[],isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null,search:"",filter:"",sort:"",dir:1,sorts:[{id:"upload_date",title:"Upload date",dir:1},{id:"view_count",title:"View count",dir:1},{id:"rating",title:"Rating",dir:1}]},yt=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"initial-success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isInitialLoaded:!0,error:null,isAllFetched:t.payload.films.length<$,films:t.payload.films,search:t.payload.params.search,sort:t.payload.params.sort,filter:t.payload.params.filter,dir:t.payload.params.dir});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.error?e:Object(o.a)(Object(o.a)({},e),{},{isLoading:!0});case"load-success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:null,isAllFetched:t.payload.length<$,films:[].concat(Object(U.a)(e.films),Object(U.a)(t.payload))});case"sorts-change":return Object(o.a)(Object(o.a)({},e),{},{sort:t.resetSort?"":e.sort,sorts:e.sorts.map((function(e){return e.id===t.payload.id?t.payload:e}))});case"error":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:!0});default:return e}},gt=[{id:"last_hour",title:"Last hour"},{id:"today",title:"Today"},{id:"this_week",title:"This week"},{id:"this_month",title:"This month"},{id:"this_year",title:"This year"}],vt=function(e){var t=Object(m.g)(),a=Object(m.h)(),c=Object(n.useReducer)(yt,xt),s=Object(u.a)(c,2),i=s[0],r=s[1],j=i.films,b=i.isLoading,h=i.isAllFetched,y=i.search,g=i.sort,v=i.filter,w=i.dir,N=i.sorts,k=i.error,A=i.isInitialLoaded,C=Object(n.useState)(!1),L=Object(u.a)(C,2),E=L[0],F=L[1],P=Object(n.useCallback)((function(){b||h||k||!A||r({type:"load"})}),[k,h,A,b]);J(P),Object(n.useEffect)((function(){var e,t,n,c=Se.a.parse(a.search),s={search:c.title,sort:null!==(e=c.sort)&&void 0!==e?e:"",filter:null!==(t=c.filter)&&void 0!==t?t:"",dir:null!==(n=c.dir)&&void 0!==n?n:1};function i(){return(i=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(Object(o.a)(Object(o.a)({},s),{},{limit:$})).then((function(e){r({type:"initial-success",payload:{films:e.data,params:s}})})).catch((function(e){r({type:"error"}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a.state&&a.state.films?r({type:"initial-success",payload:{films:a.state.films,params:s}}):function(){i.apply(this,arguments)}()}),[a]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S({search:y,sort:g,filter:v,dir:w,skip:j.length,limit:$}).then((function(e){r({type:"load-success",payload:e.data})})).catch((function(e){r({type:"error"}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b&&function(){e.apply(this,arguments)}()}),[w,j.length,v,b,y,g]);var R=function(e,a){var n=v,c=g,s=w;if("filter"===e)n=n===a.id?"":a.id;else{var i=a;c===a.id?(c=a.id,1===i.dir?(i.dir=-1,s=a.dir):-1===i.dir&&(i.dir=1,c=""),r({type:"sorts-change",payload:i,resetSort:""===c}),s=a.dir):(c=a.id,s=a.dir)}""!==c&&""!==n?t.push({search:"?title=".concat(y,"&sort=").concat(c,"&dir=").concat(s,"&filter=").concat(n)}):""===c&&""!==n?t.push({search:"?title=".concat(y,"&filter=").concat(n)}):""!==c&&""===n?t.push({search:"?title=".concat(y,"&sort=").concat(c,"&dir=").concat(s)}):""===c&&""===n&&t.push({search:"?title=".concat(y)})};return Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)(ht.a,{onClick:function(){return F(!E)},"aria-controls":"filter-collapse","aria-expanded":E,className:"mt-3 mx-3 p-2 m-button",children:Object(X.jsx)(p.a,{style:{cursor:"pointer"},icon:"filter"})}),Object(X.jsx)(ft.a,{in:E,children:Object(X.jsxs)(O.a,{id:"filter-collapse",className:"mx-2",children:[Object(X.jsxs)(f.a,{className:"mt-4",sm:4,children:[Object(X.jsx)("p",{style:{fontWeight:500},children:"UPLOAD DATE"}),Object(X.jsx)(f.a,{sm:8,className:"mt-3 mb-3 divider"}),gt.map((function(e){return Object(X.jsx)("p",{style:v===e.id?{fontWeight:700,fontSize:"80%"}:{fontWeight:400,fontSize:"80%"},onClick:function(){return R("filter",e)},className:"search-filter",children:e.title},e.id)}))]}),Object(X.jsxs)(f.a,{className:"mt-4",sm:4,children:[Object(X.jsx)("p",{style:{fontWeight:500},children:"SORT BY"}),Object(X.jsx)(f.a,{sm:8,className:"mt-3 mb-3 divider"}),N.map((function(e){return Object(X.jsxs)(f.a,{className:"d-flex",children:[Object(X.jsx)("p",{style:g===e.id?{fontWeight:700,fontSize:"80%"}:{fontWeight:400,fontSize:"80%"},onClick:function(){return R("sort",e)},className:"search-filter",children:e.title}),g===e.id&&1===e.dir?Object(X.jsx)(p.a,{className:"ms-2",icon:"sort-up"}):g===e.id&&-1===e.dir?Object(X.jsx)(p.a,{className:"ms-2",icon:"sort-down"}):""]},e.id)}))]})]})}),Object(X.jsx)(f.a,{sm:12,className:"mt-2 mb-3 divider"}),Object(X.jsx)(O.a,{className:"mx-2 mt-4",children:j.map((function(e,a){var n=function(e){var t=new Date(Date.parse(e.createdAt)),a=new Date,n=Math.abs(Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())-Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()))/6e4));return n/60>=1?(n/=60)/24>=1?(n/=24)/30>=1?(n/=30)/12>=1?(n/=12,n=Math.floor(n)+" years "):n=Math.floor(n)+" months ":n=Math.floor(n)+" days ":n=Math.floor(n)+" hours ":n=Math.floor(n)+" minutes ",n+"ago"}(e);return Object(X.jsx)(f.a,{xs:12,sm:12,lg:8,children:Object(X.jsx)(f.a,{className:"play-outer-container m-0 mb-1",onClick:function(a){var n;ke(a.target)||(n=e.id,t.push("".concat("/filmapp-react-frontend/","film/")+n))},children:Object(X.jsxs)(O.a,{className:"search-style mb-4 m-0",children:[Object(X.jsx)(f.a,{xs:8,sm:4,className:"p-0",children:Object(X.jsxs)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:[Object(X.jsx)(se,{image:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")}),Object(X.jsx)(p.a,{className:"play-middle",icon:"play"})]})}),Object(X.jsxs)(f.a,{xs:4,sm:8,children:[Object(X.jsxs)(O.a,{className:"m-0",children:[Object(X.jsx)(f.a,{className:"p-0 mb-1",style:{flex:"0 0 auto !important",width:"calc(83.33333333% - 24px) !important"},children:Object(X.jsx)(Ot.a,{lines:1,className:"mb-0 search-title fw-bold",children:e.title})}),Object(X.jsx)(f.a,{className:"d-flex justify-content-end",children:Object(X.jsx)(Ne,{index:a,filmID:e.id})})]}),Object(X.jsx)("p",{className:"d-none d-sm-inline mb-1 author-nick-search",children:Object(X.jsxs)("small",{children:[e.author_name," \xb7 ",e.views," views \xb7 ",n]})}),Object(X.jsx)("p",{className:"d-inline d-sm-none mb-0 author-nick-color",children:Object(X.jsxs)("small",{children:[e.author_name," \xb7 ",e.views," views"]})}),Object(X.jsx)("small",{className:"d-none d-sm-inline",children:Object(X.jsx)(ne.a,{className:"mb-0 author-nick-search",line:2,text:e.description})})]})]})})},e.id)}))}),!h&&Object(X.jsx)("div",{style:{height:"32px",width:"100%"},className:"d-flex justify-content-center",children:(b||!A)&&Object(X.jsx)(x.a,{animation:"border"})})]})},wt={playlists:null,playlistsCount:0,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null},Nt=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"initial-success":return Object(o.a)(Object(o.a)({},e),{},{playlists:Object(U.a)(new Set(Object(U.a)(t.playlists))),isLoading:!1,isInitialLoaded:!0,isAllFetched:t.responseCount<q,playlistsCount:e.playlistsCount+t.responseCount});case"load":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1,error:null});case"success":return Object(o.a)(Object(o.a)({},e),{},{playlists:Object(U.a)(new Set([].concat(Object(U.a)(e.playlists),Object(U.a)(t.playlists)))),isLoading:!1,isAllFetched:t.responseCount<$,playlistsCount:e.playlistsCount+t.responseCount,error:null});case"clear":return wt;case"error":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isAllFetched:!1,error:t.payload});default:return e}},kt=function(e){var t=e.playlist,a=e.handleRedirect,c=e.handleRemove,s=e.isProfile,i=e.dispatchPrivacyUpdate,r=s?8:10,l=Object(n.useState)("mb-5 play-outer-container remove-container"),o=Object(u.a)(l,2),d=o[0],m=o[1];return Object(n.useEffect)((function(){t.film_id||m("mb-5 play-cursor-default remove-container")}),[t.film_id]),Object(X.jsx)(f.a,{xs:12,sm:6,md:3,lg:2,children:Object(X.jsxs)(f.a,{className:d,onClick:function(){return a(t.id,t.film_id)},children:[Object(X.jsxs)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:[Object(X.jsx)(se,{image:t.img}),Object(X.jsxs)(O.a,{style:{width:"100%",margin:0},className:"play-middle",children:[Object(X.jsx)(f.a,{xs:5,sm:5,style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:Object(X.jsx)(p.a,{icon:"play"})}),Object(X.jsx)(f.a,{xs:7,sm:7,style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:Object(X.jsx)("small",{className:"fw-bold",children:"Play all"})})]})]}),Object(X.jsxs)(O.a,{className:"m-0",children:[Object(X.jsx)(f.a,{xs:r,sm:r,className:"p-0",children:Object(X.jsx)(ne.a,{line:1,text:t.title,className:"mb-1 mt-1 title "})}),s&&Object(X.jsxs)(f.a,{xs:4,sm:4,className:"p-0 d-flex justify-content-end",children:[Object(X.jsx)(ye,{id:t.id,isPublic:t.is_public,isProfile:!0,dispatchPrivacyUpdate:i}),Object(X.jsx)(Ce,{handleRemove:c})]})]}),Object(X.jsx)("p",{className:"mb-0 author-nick-color",children:Object(X.jsx)("small",{children:t.author_name})})]})},t.id)};var At=function(e){var t=Object(m.g)(),a=Object(n.useReducer)(Nt,wt),c=Object(u.a)(a,2),s=c[0],i=c[1],r=s.playlists,o=s.isLoading,p=s.isAllFetched,j=s.isInitialLoaded,b=s.playlistsCount,f=Object(n.useCallback)((function(){o||p||!j||i({type:"load"})}),[p,o,j]);J(f,{triggerOnNoScroll:!0}),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe({limit:q}).then((function(e){var t=e.data,a=t.filter((function(e){return e.film_id}));a.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.film_id,"/thumbnail?width=small")})),i({type:"initial-success",playlists:a,responseCount:t.length})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i({type:"clear"}),function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe({skip:b,limit:$}).then((function(e){var t=e.data,a=t.filter((function(e){return e.film_id}));a.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.film_id,"/thumbnail?width=small")})),i({type:"success",playlists:a,responseCount:t.length})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o&&j&&function(){e.apply(this,arguments)}()}),[o,j,r,b]);var h=function(e,a){t.push({pathname:"".concat("/filmapp-react-frontend/","film/")+a,search:"?list=".concat(e)})};return Object(X.jsxs)(O.a,{className:"mt-5 mx-2",children:[r&&r.map((function(e,t){return Object(X.jsx)(kt,{playlist:e,index:t,handleRedirect:h},e.id)})),!p&&Object(X.jsx)("div",{style:{height:"32px",width:"100%"},className:"d-flex justify-content-center",children:(o||!j)&&Object(X.jsx)(x.a,{animation:"border"})})]})},Ct=(a(551),function(e){return{file:null,name:e?Et:Ft,preview:null}}),Lt={type:"",message:""},Et="Choose a film ",Ft="Choose a thumbnail ",St={title:"",description:"",film:Ct(!0),thumbnail:Ct(!1),isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},Pt=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({isError:!1,error:null},t.fieldName,t.payload));case"file-add":return!0===t.isFilm?Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,alert:Lt,film:{file:t.file,name:t.fileName,preview:t.preview}}):Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,alert:Lt,thumbnail:{file:t.file,name:t.fileName,preview:t.preview}});case"file-clear":return!0===t.isFilm?Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,film:Ct(!0)}):Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,thumbnail:Ct(!1)});case"submit":return Object(o.a)(Object(o.a)({},e),{},{isError:!1,error:null,alert:Lt,isSubmitted:!0});case"send":return Object(o.a)(Object(o.a)({},e),{},{isSending:!0});case"success":return Object(o.a)(Object(o.a)({},e),{},{isSending:!1,isSuccess:!0});case"error":return Object(o.a)(Object(o.a)({},e),{},{isSending:!1,isSuccess:!1,isError:!0,error:t.payload});case"error-422":return Object(o.a)(Object(o.a)({},e),{},{isError:!0,error:t.payload,film:Ct(!0),thumbnail:Ct(!1)});default:return e}};var Rt=function(){var e=Object(n.useContext)(H),t=e.user,a=e.clearUser,c=Object(m.g)(),s=Object(n.useRef)(null),i=Object(n.useRef)(null),r=Object(n.useReducer)(Pt,St),o=Object(u.a)(r,2),j=o[0],b=o[1],g=j.title,v=j.description,w=j.film,N=j.thumbnail,k=j.isSubmitted,A=j.isSending,C=j.isError,L=j.error;Object(n.useEffect)((function(){!t.auth&&t.isInitialLoaded&&(c.replace("".concat("/filmapp-react-frontend/")),c.push("".concat("/filmapp-react-frontend/","login")),a())}),[t,c,a]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).set("title",g),t.set("description",v),t.set("film",w.file),t.set("thumbnail",N.file),e.next=7,R(t).then((function(e){b({type:"success"}),c.push("".concat("/filmapp-react-frontend/","film/").concat(e.data.id))})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.error?t=e.response.data.error:e.response&&e.response.data&&e.response.data.errors&&(e.response.data.errors.description?t=e.response.data.errors.description.message:e.response.data.errors.title&&(t=e.response.data.errors.title.message)),422===e.response.status?b({type:"error-422",payload:t}):b({type:"error",payload:t})}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}A&&function(){e.apply(this,arguments)}()}),[v,w.file,c,A,N.file,g]);var E=function(e,t){switch(e.preventDefault(),t){case"film":b({type:"file-add",isFilm:!0,file:s.current.files[0],fileName:s.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])});break;case"thumbnail":b({type:"file-add",isFilm:!1,file:i.current.files[0],fileName:i.current.files[0].name,preview:URL.createObjectURL(e.target.files[0])})}};return Object(X.jsxs)(O.a,{className:"mt-4 mx-2",sm:12,children:[Object(X.jsxs)(f.a,{className:"mb-4",sm:6,lg:5,children:[Object(X.jsx)(f.a,{className:"mb-4",xs:12,sm:12,lg:10,children:Object(X.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half",children:Object(X.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(X.jsx)(ce.a,{aspectRatio:"16x9",children:Object(X.jsx)("video",{muted:!0,autoPlay:!0,className:"embed-responsive-item",loop:!0,src:w.preview?w.preview:""})}),Object(X.jsx)("input",{id:"film",accept:"video/mp4, video/ogg",onChange:function(e){return E(e,"film")},type:"file",ref:s,className:"inputfile"}),Object(X.jsx)("label",{htmlFor:"film",className:"position-absolute",children:w.name===Et&&Object(X.jsx)("span",{children:w.name})}),w.preview&&Object(X.jsx)(f.a,{className:"card-img-overlay film-add-item-opacity"}),w.preview&&Object(X.jsx)(p.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){b({type:"file-clear",isFilm:!0})}})]})})}),Object(X.jsx)(f.a,{xs:12,sm:12,lg:10,children:Object(X.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half",children:Object(X.jsxs)("div",{className:"position-relative justify-content-center d-flex align-items-center embed-responsive-item text-center box has-advanced-upload",children:[Object(X.jsx)(ce.a,{aspectRatio:"16x9",children:Object(X.jsx)("img",{alt:"",src:N.preview?N.preview:"data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})}),Object(X.jsx)("input",{id:"thumbnail",accept:"image/jpg, image/png, image/jpeg",onChange:function(e){return E(e,"thumbnail")},type:"file",ref:i,className:" inputfile position-absolute"}),Object(X.jsx)("label",{htmlFor:"thumbnail",className:"position-absolute",children:N.name===Ft&&Object(X.jsx)("span",{children:N.name})}),N.preview&&Object(X.jsx)(f.a,{className:"card-img-overlay film-add-item-opacity"}),N.preview&&Object(X.jsx)(p.a,{className:"film-add-item-middle fa-3x",style:{color:"#ffffff"},icon:"times",onClick:function(){b({type:"file-clear",isFilm:!1})}})]})})})]}),Object(X.jsxs)(f.a,{className:"mb-2",sm:6,lg:5,children:[Object(X.jsxs)(h.a.Group,{className:"mb-3",sm:12,children:[Object(X.jsx)(le.a,{placeholder:"Title","aria-label":"Title","aria-describedby":"basic-addon1",isInvalid:k&&!g,name:"title",value:g,onChange:function(e){return b({type:"field",fieldName:"title",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Title is required"})]}),Object(X.jsxs)(h.a.Group,{className:"mb-3",sm:12,children:[Object(X.jsx)(le.a,{placeholder:"Description",as:"textarea","aria-label":"With textarea",isInvalid:k&&!v,name:"description",value:v,onChange:function(e){return b({type:"field",fieldName:"description",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Description is required"})]}),Object(X.jsx)(f.a,{className:"mb-3 p-0 ",sm:12,children:Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center",children:[Object(X.jsx)(y.a,{variant:"primary",disabled:A||!g||!v,onClick:A?null:function(e){e.preventDefault(),b({type:"submit"}),t.auth?g&&v&&b({type:"send"}):c.push("".concat("/filmapp-react-frontend/","add/login"))},children:A?"Loading\u2026":"Add"}),A&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})}),C&&Object(X.jsx)(rt.a,{variant:"danger",children:L||"Error while creating film."})]})]})},It=a.p+"static/media/page-not-found.0e39e8d9.svg";var Dt=function(){var e=Object(m.g)(),t=Object(m.h)();return Object(n.useEffect)((function(){t.pathname.includes("login")&&e.replace("".concat("/filmapp-react-frontend/","login"))}),[e,t]),Object(X.jsx)(f.a,{xs:12,sm:12,className:"mt-4 px-4 embed-responsive embed-responsive-16by9",children:Object(X.jsx)(ce.a,{aspectRatio:"16x9",children:Object(X.jsx)("img",{className:"embed-responsive-item",src:It,alt:""})})})},Tt={name:"",email:""},Bt=Object(o.a)(Object(o.a)({},Tt),{},{password:"",initialUser:Tt,isInitialLoaded:!1,isSubmitted:!1,isSending:!1,error:"",success:""}),Ht=function(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({error:""},t.fieldName,t.payload));case"initial-success":return Object(o.a)(Object(o.a)({},e),{},{initialUser:{email:t.email,name:t.name},isInitialLoaded:!0});case"submit":return Object(o.a)(Object(o.a)({},e),{},{isSubmitted:!0,error:null});case"send":return Object(o.a)(Object(o.a)({},e),{},{isSending:!0});case"success":return Object(o.a)(Object(o.a)({},e),{},{isSubmitted:!1,isSending:!1,success:"Changes saved successfully!",error:null});case"error":return Object(o.a)(Object(o.a)({},e),{},{isSending:!1,isSubmitted:!1,error:t.payload});default:return e}},Ut=function(e){var t=Object(n.useContext)(H),a=t.user,c=t.clearUser,s=t.updateUser,i=Object(m.g)(),r=Object(m.h)(),p=Object(n.useReducer)(Ht,Bt),j=Object(u.a)(p,2),b=j[0],f=j[1],O=b.email,g=b.name,v=b.password,w=b.initialUser,N=(b.isSubmitted,b.isSending),k=b.isInitialLoaded,A=b.success,C=b.error,L=Object(n.useState)(!0),E=Object(u.a)(L,2),F=E[0],S=E[1];Object(n.useEffect)((function(){!a.auth&&a.isInitialLoaded&&(S(!1),i.replace("".concat("/filmapp-react-frontend/")),i.push("".concat("/filmapp-react-frontend/","login")),c())}),[a,i,c]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe().then((function(e){f({type:"initial-success",name:e.data.name,email:e.data.email})})).catch((function(e){console.error(e),f({type:"error",payload:!0})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},v&&(t={password:v}),O&&""!==O&&O!==w.email&&(t=Object(o.a)(Object(o.a)({},t),{},{email:O})),g&&""!==g&&g!==w.name&&(t=Object(o.a)(Object(o.a)({},t),{},{name:g})),e.next=6,de(t).then((function(e){f({type:"success"}),setTimeout((function(){var t=r.pathname.slice(0,-9);""===t&&(t="/filmapp-react-frontend/"),i.replace({pathname:t,search:r.search,state:r.state}),s(e.data.accessToken)}),500)})).catch((function(e){console.error(e),f({type:"error",payload:e.response&&e.response.data&&e.response.data.error?e.response.data.error:"Something went wrong!"})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}N&&function(){e.apply(this,arguments)}()}),[O,w.email,w.name,N,g,v,i,r,s]);return Object(X.jsxs)(K.a,{onHide:function(){S(!1),i.goBack()},show:F,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(X.jsx)(K.a.Header,{closeButton:!0,children:Object(X.jsx)(K.a.Title,{children:"Settings"})}),Object(X.jsxs)(K.a.Body,{children:[Object(X.jsxs)(h.a,{onSubmit:N?null:function(e){e.preventDefault(),f({type:"submit"}),(v||O&&""!==O&&O!==w.email||g&&""!==g&&g!==w.name)&&f({type:"send"})},children:[Object(X.jsxs)(h.a.Group,{children:[Object(X.jsx)(h.a.Label,{htmlFor:"name",children:"Name"}),Object(X.jsx)(h.a.Control,{type:"text",name:"email",value:g,placeholder:w.name,onChange:function(e){return f({type:"field",fieldName:"name",payload:e.target.value})}})]}),Object(X.jsxs)(h.a.Group,{className:"mt-2",children:[Object(X.jsx)(h.a.Label,{htmlFor:"email",children:"Email"}),Object(X.jsx)(h.a.Control,{type:"email",name:"email",value:O,placeholder:w.email,onChange:function(e){return f({type:"field",fieldName:"email",payload:e.target.value})}})]}),Object(X.jsxs)(h.a.Group,{className:"mt-2",children:[Object(X.jsx)(h.a.Label,{htmlFor:"password",children:"Password"}),Object(X.jsx)(h.a.Control,{type:"password",name:"password",value:v,onChange:function(e){return f({type:"field",fieldName:"password",payload:e.target.value})}})]}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{disabled:N||!k,type:"submit",className:"btn-primary",children:"Change"}),N&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]}),C&&Object(X.jsx)(rt.a,{variant:"danger",className:"mt-2 mb-0",children:C||"Error while logging in."}),A&&Object(X.jsx)(rt.a,{variant:"success",className:"mt-2 mb-0",children:A})]})]})},Mt=a(44),Gt=a(97),_t=a(49);var Yt=function(e){var t=Object(m.g)(),a=Object(n.useReducer)(pt,mt),c=Object(u.a)(a,2),s=c[0],i=c[1],r=s.password,o=s.isSubmitted,p=s.isSending,j=s.isSuccess,b=s.isError,f=s.error,O=Object(n.useState)(!0),g=Object(u.a)(O,2),v=g[0],w=g[1];Object(n.useEffect)((function(){function a(){return(a=Object(d.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ut(e.match.params.token,{password:r}).then((function(e){i({type:"success"}),setTimeout((function(){w(!1),t.push("".concat("/filmapp-react-frontend/")),setTimeout((function(){t.push("".concat("/filmapp-react-frontend/","login"))}),500)}),1500)})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors),i({type:"error",payload:t})}));case 2:case"end":return a.stop()}}),a)})))).apply(this,arguments)}p&&function(){a.apply(this,arguments)}()}),[p,t,r,e.match.params.token]);var N=function(){w(!1),t.push("".concat("/filmapp-react-frontend/"))};return Object(X.jsxs)(K.a,{onHide:N,show:v,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(X.jsx)(K.a.Header,{closeButton:!0,children:Object(X.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:"Reset"})}),Object(X.jsx)(K.a.Body,{children:Object(X.jsxs)(h.a,{onSubmit:function(t){t.preventDefault(),i({type:"submit"}),e.match.params.token&&r&&r.length>=6&&i({type:"send"})},children:[Object(X.jsxs)(h.a.Group,{children:[Object(X.jsx)(h.a.Label,{htmlFor:"password",children:"Password"}),Object(X.jsx)(h.a.Control,{isInvalid:o&&r.length<6,type:"password",name:"password",value:r,maxLength:"11",onChange:function(e){return i({type:"field",fieldName:"password",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:0===r.length?"Password is required":"Password too short (min 6 chars)"})]}),j&&Object(X.jsx)(rt.a,{variant:"success",className:"mt-2",children:"Password has been reseated! Redirecting to login page."}),b&&Object(X.jsx)(rt.a,{variant:"danger",className:"mt-2",children:f||"Error while resetting password."}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{type:"submit",className:"btn-primary",children:"Reset password"}),p&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]})}),Object(X.jsx)(K.a.Footer,{children:Object(X.jsx)(y.a,{onClick:N,children:"Close"})})]})};var zt=function(e){var t=Object(m.g)(),a=Object(n.useState)(!0),c=Object(u.a)(a,2),s=c[0],i=c[1],r=Object(n.useReducer)(pt,mt),o=Object(u.a)(r,2),p=o[0],j=o[1],b=p.email,f=p.isSuccess,O=p.isSubmitted,g=p.isSending,v=p.isError,w=p.error;Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dt({email:b}).then((function(e){j({type:"success"})})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors),j({type:"error",payload:t}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}g&&function(){e.apply(this,arguments)}()}),[g,b]);var N=function(){i(!1),t.goBack()};return Object(X.jsxs)(K.a,{onHide:N,show:s,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(X.jsx)(K.a.Header,{closeButton:!0,children:Object(X.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:"Forgot"})}),Object(X.jsx)(K.a.Body,{children:Object(X.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),j({type:"submit"}),b&&j({type:"send"})},children:[Object(X.jsxs)(h.a.Group,{children:[Object(X.jsx)(h.a.Label,{htmlFor:"email",children:"Email"}),Object(X.jsx)(h.a.Control,{isInvalid:O&&!b,type:"email",name:"email",value:b,onChange:function(e){return j({type:"field",fieldName:"email",payload:e.target.value})}}),Object(X.jsx)(h.a.Control.Feedback,{type:"invalid",children:"Email is required"})]}),f&&Object(X.jsx)(rt.a,{variant:"success",className:"mt-2",children:"Email with link to reset password has been sent."}),v&&Object(X.jsx)(rt.a,{variant:"danger",className:"mt-2",children:w||"Error while sending email."}),Object(X.jsxs)(h.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(X.jsx)(y.a,{type:"submit",className:"btn-primary",children:"Reset password"}),g&&Object(X.jsx)(x.a,{className:"ms-2",animation:"grow"})]})]})}),Object(X.jsx)(K.a.Footer,{children:Object(X.jsx)(y.a,{onClick:N,children:"Close"})})]})},Jt=a(8),Xt=["component"],Wt=function(e){var t=e.component,a=Object(Jt.a)(e,Xt);return Object(X.jsx)(m.b,Object(o.a)(Object(o.a)({},a),{},{render:function(e){return localStorage.getItem("accessToken")?Object(X.jsx)(t,Object(o.a)({},e)):Object(X.jsx)(m.a,{to:{pathname:"".concat("/filmapp-react-frontend/","login"),state:{from:e.location}}})}}))},Kt={data:[],isLoading:!1,isAllFetched:!1,isRemoving:!1,toRemove:null,error:null,filmsCount:0,playlistsCount:0};function Vt(e,t){switch(t.type){case"field":return Object(o.a)(Object(o.a)({},e),{},Object(M.a)({},t.fieldName,t.payload));case"initial-success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isInitialLoaded:!0,isAllFetched:t.filmsCount<$&&t.playlistsCount<$,filmsCount:e.filmsCount+t.filmsCount,playlistsCount:e.playlistsCount+t.playlistsCount,data:Object(U.a)(new Set(t.data))});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.error?e:Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,isAllFetched:t.filmsCount<$&&t.playlistsCount<$,filmsCount:e.filmsCount+t.filmsCount,playlistsCount:e.playlistsCount+t.playlistsCount,data:Object(U.a)(new Set([].concat(Object(U.a)(e.data),Object(U.a)(t.data))))});case"remove":return Object(o.a)(Object(o.a)({},e),{},{toRemove:t.payload,isRemoving:!0});case"remove-success":return Object(o.a)(Object(o.a)({},e),{},{isRemoving:!1,toRemove:null,data:e.toRemove?e.data.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"change-playlist-privacy-success":return Object(o.a)(Object(o.a)({},e),{},{data:e.data.map((function(e){return e.isPlaylist&&e.id===t.payload.id?Object(o.a)(Object(o.a)({},e),{},{is_public:t.payload.is_public}):e}))});case"clear":return Kt;default:return e}}var Zt=function(e){var t=Object(n.useContext)(H),a=t.user,c=t.clearUser,s=Object(n.useContext)(V),i=s.showModal,r=s.clear,p=s.removeModalData,j=Object(m.g)(),b=Object(n.useReducer)(Vt,Kt),f=Object(u.a)(b,2),h=f[0],y=f[1],g=h.data,v=h.isLoading,w=h.isAllFetched,N=h.isInitialLoaded,k=h.error,A=h.isRemoving,C=h.toRemove,L=h.filmsCount,E=h.playlistsCount,F=Object(n.useCallback)((function(){v||w||!N||k||y({type:"load"})}),[v,w,N,k]);J(F,{triggerOnNoScroll:!0}),Object(n.useEffect)((function(){!a.auth&&a.isInitialLoaded&&(j.replace("".concat("/filmapp-react-frontend/")),j.push("".concat("/filmapp-react-frontend/","login")),c())}),[a,j,c]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,a,n,c,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([oe({skipFilms:0,skipPlaylists:0,limit:q})]);case 2:t=e.sent,a=Object(u.a)(t,1),n=a[0],c=[],s=[],i=[],"fulfilled"===n.status&&(s=n.value.data.films.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})})),i=n.value.data.playlists.map((function(e){var t=e.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.film_id,"/thumbnail?width=small"):Ze;return Object(o.a)(Object(o.a)({},e),{},{img:t,isPlaylist:!0})})),c=[].concat(Object(U.a)(c),Object(U.a)(s),Object(U.a)(i))),y({type:"initial-success",data:c,filmsCount:s.length,playlistsCount:i.length});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}y({type:"clear"}),function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,a,n,c,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([oe({skipFilms:L,skipPlaylists:E,limit:$})]);case 2:t=e.sent,a=Object(u.a)(t,1),n=a[0],c=[],s=[],i=[],"fulfilled"===n.status&&(s=n.value.data.films.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small")})})),i=n.value.data.playlists.map((function(e){var t=e.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.film_id,"/thumbnail?width=small"):Ze;return Object(o.a)(Object(o.a)({},e),{},{img:t,isPlaylist:!0})})),c=[].concat(Object(U.a)(c),Object(U.a)(s),Object(U.a)(i))),y({type:"success",data:c,filmsCount:s.length,playlistsCount:i.length});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}v&&N&&function(){e.apply(this,arguments)}()}),[L,v,E,N]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!C.isPlaylist){e.next=8;break}return e.next=4,be(C.id);case 4:204===e.sent.status&&(y({type:"remove-success"}),r()),e.next=12;break;case 8:return e.next=10,D(C.id);case 10:204===e.sent.status&&(y({type:"remove-success"}),r());case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}A&&p.isRemoving&&C&&p.id===C.id&&p.title===C.title&&p.type===(C.isPlaylist?"playlist":"film")&&function(){e.apply(this,arguments)}()}),[A,p,C,r]);var S=function(e,t){e.stopPropagation(),p.isRemoving||(y({type:"remove",payload:t}),i(t.id,t.isPlaylist?"playlist":"film",t.title))};return Object(X.jsxs)(O.a,{className:"mt-5 mx-2",children:[g.map((function(e,t){return e.isPlaylist?Object(X.jsx)(kt,{playlist:e,index:t,isProfile:!0,dispatchPrivacyUpdate:y,handleRedirect:function(){return function(e){e.film_id&&j.push({pathname:"".concat("/filmapp-react-frontend/","film/")+e.film_id,search:"?list=".concat(e.id)})}(e)},handleRemove:function(t){return S(t,e)}},e.id):Object(X.jsx)(Le,{isProfile:!0,film:e,index:t,handleRedirect:function(){return t=e.id,void j.push({pathname:"".concat("/filmapp-react-frontend/","film/")+t});var t},handleRemove:function(t){return S(t,e)}},e.id)})),!w&&Object(X.jsx)("div",{style:{height:"32px",width:"100%"},className:"d-flex justify-content-center",children:(v||!N)&&Object(X.jsx)(x.a,{animation:"border"})})]})},Qt=a(592),qt=function(e){var t=e.children,a=Object(n.useContext)(H).logout;return Object(n.useMemo)((function(){C.interceptors.response.use((function(e){return e}),(function(e){var t,n=localStorage.getItem("accessToken"),c=e.config;return e.response&&401===e.response.status&&n&&!c._retry?"auth/refresh"===e.config.url?(a(),Promise.reject(e)):(c._retry=!0,(t={refreshToken:JSON.parse(localStorage.getItem("refreshToken"))},C.post("auth/refresh",t,{headers:L()})).then((function(e){if(201===e.status){var t=e.data.token;return localStorage.setItem("accessToken",JSON.stringify(t)),c.headers.Authorization="Bearer "+t,C(c)}}))):Promise.reject(e)}))}),[]),t},$t=a(218),ea=function(e){var t=e.children,a=Object(m.h)().pathname,c=Object(n.useState)({name:"",id:null,auth:!1,isInitialLoaded:!1}),s=Object(u.a)(c,2),i=s[0],r=s[1];Object(n.useEffect)((function(){window.scrollTo(0,0)}),[a]),Object(n.useEffect)((function(){!function(){var e=localStorage.getItem("accessToken");if(e){var t=Object($t.a)(e);r((function(){return{name:t.name,auth:!0,id:t.id,isInitialLoaded:!0}}))}else r((function(e){return Object(o.a)(Object(o.a)({},e),{},{isInitialLoaded:!0})}))}()}),[]);return Object(X.jsx)(H.Provider,{value:{user:i,login:function(e,t,a,n){localStorage.setItem("accessToken",JSON.stringify(a)),localStorage.setItem("refreshToken",JSON.stringify(n)),r((function(){return{name:e,auth:!0,id:t,isInitialLoaded:!0}}))},logout:function(){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),r((function(e){return Object(o.a)(Object(o.a)({},e),{},{name:"",auth:!1,id:null})}))},clearUser:function(){r((function(e){return Object(o.a)(Object(o.a)({},e),{},{isInitialLoaded:!1})}))},updateUser:function(e){localStorage.setItem("accessToken",JSON.stringify(e));var t=Object($t.a)(e);r((function(e){return Object(o.a)(Object(o.a)({},e),{},{name:t.name})})),window.location.reload()}},children:t})};Gt.b.add(_t.j,_t.i,_t.n,_t.m,_t.d,_t.h,_t.e,_t.b,_t.a,_t.c,_t.k,_t.l,_t.p,_t.o,_t.f,_t.g);var ta="/filmapp-react-frontend/";var aa=function(e){var t=Object(n.useContext)(fe),a=t.toast,c=t.clearToast;return Object(X.jsxs)("div",{children:[Object(X.jsx)("div",{className:"toast-root",children:Object(X.jsxs)(Qt.a,{show:a.isOpen,onClose:c,autohide:!0,className:"toast-element bg-secondary",children:[Object(X.jsx)(Qt.a.Header,{children:Object(X.jsx)("strong",{className:"me-auto",children:"Playlist"})}),Object(X.jsx)(Qt.a.Body,{children:a.message})]})}),Object(X.jsx)(Mt.a,{children:Object(X.jsx)(ea,{children:Object(X.jsxs)(qt,{children:[Object(X.jsx)(m.b,{component:function(){return Object(X.jsx)(W,{})}}),Object(X.jsx)(Wt,{exact:!0,path:["".concat(ta,"settings"),"".concat(ta,"profile/settings"),"".concat(ta,"film/:id/settings"),"".concat(ta,"search/settings"),"".concat(ta,"add/settings"),"".concat(ta,"playlists/settings")],component:Ut}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"login"),"".concat(ta,"film/:id/login"),"".concat(ta,"search/login"),"".concat(ta,"add/login"),"".concat(ta,"playlists/login")],component:jt}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"register"),"".concat(ta,"film/:id/register"),"".concat(ta,"search/register"),"".concat(ta,"add/register"),"".concat(ta,"playlists/register")],component:bt}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"reset/:token"),"".concat(ta,"film/:id/reset/:token"),"".concat(ta,"search/reset/:token"),"".concat(ta,"add/reset/:token"),"".concat(ta,"playlists/reset/:token")],component:Yt}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"forgot"),"".concat(ta,"film/:id/forgot"),"".concat(ta,"search/forgot"),"".concat(ta,"add/forgot"),"".concat(ta,"playlists/forgot")],component:zt}),Object(X.jsxs)(m.d,{children:[Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"film/:id"),"".concat(ta,"film/:id/login"),"".concat(ta,"film/:id/register"),"".concat(ta,"film/:id/reset/:token"),"".concat(ta,"film/:id/forgot"),"".concat(ta,"film/:id/settings")],component:it}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta),"".concat(ta,"login"),"".concat(ta,"register"),"".concat(ta,"settings"),"".concat(ta,"reset/:token"),"".concat(ta,"forgot")],component:Ee}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"search"),"".concat(ta,"search/login"),"".concat(ta,"search/settings"),"".concat(ta,"search/register"),"".concat(ta,"search/reset/:token"),"".concat(ta,"search/forgot")],component:vt}),Object(X.jsx)(Wt,{exact:!0,path:["".concat(ta,"add"),"".concat(ta,"add/settings")],component:Rt}),Object(X.jsx)(m.b,{exact:!0,path:["".concat(ta,"playlists"),"".concat(ta,"playlists/login"),"".concat(ta,"playlists/settings"),"".concat(ta,"playlists/register"),"".concat(ta,"playlists/reset/:token"),"".concat(ta,"playlists/forgot")],component:At}),Object(X.jsx)(Wt,{exact:!0,path:["".concat(ta,"profile"),"".concat(ta,"profile/settings")],component:Zt}),Object(X.jsx)(m.b,{exact:!0,path:"*",component:Dt})]})]})})}),Object(X.jsx)(Z,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var na=function(e){var t=e.children,a=Object(n.useState)({isOpen:!1,message:"",isPrevoius:!1}),c=Object(u.a)(a,2),s=c[0],i=c[1];return Object(X.jsx)(fe.Provider,{value:{toast:s,createToast:function(e){s.isPrevoius?(i({isOpen:!1,message:"",isPrevoius:!0}),setTimeout((function(){return i({isOpen:!0,message:e,isPrevoius:!0})}),850)):i({isOpen:!0,message:e,isPrevoius:!0})},clearToast:function(){i({isOpen:!1,message:"",isPrevoius:!1})}},children:t})},ca=function(e){var t=e.children,a=Object(n.useState)({show:!1,isRemoving:!1,id:null,type:null,title:""}),c=Object(u.a)(a,2),s=c[0],i=c[1];return Object(X.jsx)(V.Provider,{value:{showModal:function(e,t,a){i({show:!0,isRemoving:!1,id:e,type:t,title:a})},removeModalData:s,remove:function(){i((function(e){return Object(o.a)(Object(o.a)({},e),{},{show:!1,isRemoving:!0})}))},clear:function(){i({show:!1,isRemoving:!1,id:null,type:null,title:""})}},children:t})};i.a.render(Object(X.jsx)(na,{children:Object(X.jsx)(ca,{children:Object(X.jsx)(aa,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[552,1,2]]]);
//# sourceMappingURL=main.71ad3814.chunk.js.map