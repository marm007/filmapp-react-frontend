{"version":3,"sources":["config/index.js","services/playlistService.js","helpers/components/changePrivacyButton.js","components/blurredImage/index.js","helpers/components/removeButton.js","helpers/index.js","components/add/reducers/playlistDropdownMenuReducer.js","components/add/playlistDropdownMenu.js","components/add/playlistAddButton.js","helpers/components/film.js","images/image_not_found.png","helpers/contexts/film/filmContext.js","components/filmPage/reducers/previewReducer.js","components/filmPage/preview.js","components/filmPage/reducers/recommendationsReducer.js","components/filmPage/recommendations.js","services/commentService.js","components/filmPage/reducers/commentsReducer.js","components/filmPage/comments.js","components/filmPage/reducers/playlistReducer.js","components/filmPage/playlist.js","helpers/contexts/film/filmProvider.js","components/filmPage/index.js"],"names":["commentsMaxFetchCount","recommendationsMaxFetchCount","playlistButtonMaxFetchCount","pageInitialMaxFetchCount","pageMaxFetchCount","create","body","axios","post","headers","authHeader","index","id","get","show","params","partialUpdate","patch","remove","delete","ChangePrivacyButton","isPublic","isProfile","dispatchPrivacyUpdate","filmDispatch","useState","isChanging","setIsChanging","useEffect","a","playlistApi","is_public","then","res","type","payload","data","undefined","fieldName","catch","err","console","error","changePrivacy","privacyButton","style","marginLeft","borderRadius","width","height","className","onClick","e","stopPropagation","icon","BlurredImageComponent","props","image","setImage","aspectRatio","alt","src","RemoveButton","handleRemove","checkIfPlaylistButtonClick","target","tagName","parentNode","animVal","includes","displayCommentDate","comment","date","Date","parse","createdAt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","parseSearchDate","film","today","time","Math","abs","floor","UTC","playlistDropdownMenuInitialState","playlists","isLoading","isAllFetched","isCreating","isAdding","playlistToUpgrade","title","playlistDropdownMenuReducer","state","action","map","playlist","contains","PlaylistDropdownMenu","filmID","handlePlaylistClose","isPreview","useRipple","background","addRipple","ripples","createToast","useContext","ToastContext","useReducer","dispatch","handleOnPlaylistDropdownMenuBottom","useCallback","scrollRef","useBottomScrollListener","userApi","skip","length","limit","result","forEach","films","indexOf","getMyPlaylists","films_id","errorMessage","response","errors","creatPlaylist","is_remove_films","message","addToPlaylist","Dropdown","Menu","Row","Col","xs","sm","setTimeout","Divider","ref","maxHeight","overflowY","minHeight","Form","Check","FormCheck","Input","onChange","handleAddToPlaylist","checked","Label","Spinner","animation","ItemText","FormControl","isInvalid","value","placeholder","Feedback","Select","Group","Button","disabled","PlaylistAddButton","user","UserContext","isOpen","setIsOpen","auth","onToggle","event","metadata","Toggle","variant","bsPrefix","color","display","verticalAlign","opacity","faEllipsisV","Film","handleRedirect","isRecommendations","concat","img","line","text","author_name","views","FilmContext","createContext","initialPreviewState","video","likes","dislikes","description","isLiked","isDisliked","isLikeButtonClicked","likeAction","isDescExpanded","previewReducer","FilmPreview","history","useHistory","location","useLocation","playerRef","node","getBoundingClientRect","setPlayerNode","playerNode","measure","window","addEventListener","removeEventListener","requests","filmApi","match","push","details","Promise","allSettled","filmResponse","filmViewResponse","userResponse","status","filmData","comments","commentsCount","comments_count","process","liked","disliked","handleGetFilm","likeResult","likeData","userResult","pathname","handleLike","handleTruncate","preventDefault","TruncateButton","playsInline","poster","Fragment","faEye","cursor","faThumbsUp","faThumbsDown","whiteSpace","textAlign","truncateText","textTruncateChild","recommendationsInitialState","isInitialLoaded","recommendationsReducer","FilmsRecommendations","filmState","handleRecommendationsOnBottom","exclude","isPreviewLoaded","initialLoad","fetchData","all","film_id","sort","commentsInitialState","isRemoving","toRemove","isSorting","sorts","dir","commentsReducer","filter","sortToChange","Comments","RemoveModalContext","showModal","clear","removeModalData","handleOnCommentsBottom","commentApi","loadSortedComments","loadComments","form","addComment","substring","removeComment","sortParams","sortComments","md","DropdownButton","onSelect","tmpSort","handleSortComments","sortTmp","Item","eventKey","active","TextField","label","multiline","fullWidth","maxrow","author_id","handleRemoveComment","filmPlaylistInitialState","currentFilm","currentFilmIndex","isRemovingPlaylist","isRemovingFilm","removingFilmId","headerHeight","playerHeight","filmPlaylistReducer","filtered","findIndex","Playlist","clearPlaylist","headerRef","filmIndex","filmId","Array","prototype","call","reloadPlaylist","handleReloadPlaylist","parsed","queryString","search","list","handleGetPlaylist","removePlaylist","removeFilm","handleRemoveFromPlaylist","onYReachEnd","onScrollY","isNonExisting","fontWeight","justifyContent","alignItems","image_not_found","filmInitialState","filmReducer","FilmProvider","children","Provider","onSmallScreen","useWindowWidth","historyObject","span","order"],"mappings":"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","file":"static/js/7.3576185d.chunk.js","sourcesContent":["export const commentsMaxFetchCount = 10\nexport const recommendationsMaxFetchCount = 12\n\nexport const playlistButtonMaxFetchCount = 10\n\nexport const pageInitialMaxFetchCount = 40\nexport const pageMaxFetchCount = 20\n","import axios from '../helpers/axios'\nimport authHeader from '../helpers/authHeader'\n\n\nexport const create = (body) => axios.post('playlists', body, { headers: authHeader() })\nexport const index = (id) => axios.get(`playlists/${id}`, { headers: authHeader() })\nexport const show = (params) => axios.get(`playlists`, { params, headers: authHeader() })\nexport const partialUpdate = (id, body) => axios.patch(`playlists/${id}`, body, { headers: authHeader() })\n\n\nexport const remove = (id) => axios.delete(`playlists/${id}`, { headers: authHeader() })\n\n","import Col  from \"react-bootstrap/Col\"\nimport ButtonBase  from \"@material-ui/core/ButtonBase\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { useEffect, useState } from \"react\"\nimport * as playlistApi from '../../services/playlistService'\n\nconst ChangePrivacyButton = ({ isPublic, id, isProfile, dispatchPrivacyUpdate, filmDispatch }) => {\n\n    const [isChanging, setIsChanging] = useState(false)\n\n\n    useEffect(() => {\n        async function changePrivacy() {\n            await playlistApi.partialUpdate(id, { is_public: !isPublic })\n                .then(res => {\n                    setIsChanging(false)\n\n                    dispatchPrivacyUpdate({\n                        type: 'change-playlist-privacy-success',\n                        payload: res.data\n                    })\n\n                    if (filmDispatch !== undefined) {\n                        filmDispatch({\n                            type: 'field',\n                            fieldName: 'reloadPlaylist',\n                            payload: true\n                        })\n                    }\n                })\n                .catch(err => {\n                    console.error(err)\n                    setIsChanging(false)\n                })\n        }\n        if (isChanging) changePrivacy()\n    }, [dispatchPrivacyUpdate, isChanging, isPublic, id, filmDispatch])\n\n    const handleChangePrivacy = (e) => {\n        e.stopPropagation()\n        if (!isChanging) setIsChanging(true)\n    }\n\n    const privacyButton = (\n        <ButtonBase\n            style={{ marginLeft: 'auto', borderRadius: 20 + \"px\", width: 24 + \"px\", height: 24 + \"px\" }}\n            className=\"m-button\"\n            onClick={handleChangePrivacy}>\n            <FontAwesomeIcon icon={isPublic ? \"globe-europe\" : \"lock\"} />\n        </ButtonBase>\n    )\n\n    return isProfile ?\n        (\n            <Col className=\"text-center justify-content-center d-flex align-items-center p-0 flex-grow-0\"\n            >\n                <Col\n                    className=\"remove-holder p-0 m-0 flex-grow-0\"\n                    style={{ height: '24px', width: '24' }}>\n                    {privacyButton}\n                </Col>\n            </Col>\n        ) :\n        privacyButton\n}\n\nexport default ChangePrivacyButton","import React, { useState, useEffect } from 'react';\nimport { Ratio } from 'react-bootstrap'\n\nfunction BlurredImageComponent(props) {\n\n    const [image, setImage] = useState(\"data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\")\n\n    useEffect(() => {\n        setImage(props.image);\n    }, [props.image])\n\n\n    return (\n        <Ratio aspectRatio=\"16x9\">\n            <img\n                alt=\"\"\n                className=\"embed-responsive-item play-image\"\n                src={image} />\n        </Ratio>);\n}\n\nexport default BlurredImageComponent;","import Col from \"react-bootstrap/Col\"\nimport ButtonBase from \"@material-ui/core/ButtonBase\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\n\nconst RemoveButton = ({ handleRemove }) => {\n    return (\n        <Col\n            className=\"text-center justify-content-center d-flex align-items-center p-0 flex-grow-0\">\n            <Col\n                className=\"remove-holder p-0 m-0 flex-grow-0\"\n                style={{ height: '24px', width: '24px' }}>\n                <ButtonBase\n                    style={{ marginLeft: 'auto', borderRadius: 20 + \"px\", width: 24 + \"px\", height: 24 + \"px\" }}\n                    className=\"m-button \"\n                    onClick={handleRemove}>\n                    <FontAwesomeIcon icon=\"trash-alt\" />\n                </ButtonBase>\n            </Col>\n        </Col>\n    )\n}\n\nexport default RemoveButton","export const checkIfPlaylistButtonClick = (target) => {\n    if ((target.tagName === 'path' && target.parentNode.className.animVal && target.parentNode.className.animVal.includes('playlist-add-icon')) ||\n        (target.tagName === 'svg' && target.className.animVal && target.className.animVal.includes('playlist-add-icon')) ||\n        (target.className && typeof target.className === 'string' && target.className.includes('playlist-add-icon-holder')))\n        return true\n    return false\n}\n\nexport const displayCommentDate = (comment) => {\n    let date = new Date(Date.parse(comment.createdAt));\n    let time = (('0' + date.getDate()).slice(-2) + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-'\n        + ('0' + date.getFullYear()).slice(-2)\n        + ' o ' + ('0' + date.getHours()).slice(-2) + ':' + ('0' + date.getMinutes()).slice(-2))\n    return time;\n};\n\nexport const parseSearchDate = (film) => {\n\n    let date = new Date(Date.parse(film.createdAt));\n    let today = new Date();\n\n\n    let time = Math.abs(Math.floor((\n        Date.UTC(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours(),\n            date.getMinutes()) -\n        Date.UTC(\n            today.getFullYear(),\n            today.getMonth(),\n            today.getDate(),\n            today.getHours(),\n            today.getMinutes()))\n        / (1000 * 60)));\n\n    if (time / 60 >= 1) {\n        time /= 60;\n\n        if (time / 24 >= 1) {\n\n            time /= 24;\n\n            if (time / 30 >= 1) {\n\n                time /= 30;\n\n                if (time / 12 >= 1) {\n\n                    time = time / 12;\n                    time = Math.floor(time) + ' years ';\n\n                } else {\n                    time = Math.floor(time) + ' months ';\n                }\n\n            } else {\n                time = Math.floor(time) + ' days ';\n            }\n\n        } else {\n            time = Math.floor(time) + ' hours ';\n        }\n    } else {\n        time = Math.floor(time) + ' minutes ';\n    }\n\n    time = time + 'ago';\n\n    return time;\n};\n","import { playlistButtonMaxFetchCount } from \"../../../config\"\n\nexport const playlistDropdownMenuInitialState = {\n    playlists: [],\n    isLoading: true,\n    isAllFetched: false,\n    isCreating: false,\n    isAdding: false,\n    playlistToUpgrade: null,\n    title: '',\n    isPublic: false,\n    error: '',\n}\n\nexport function playlistDropdownMenuReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                error: '',\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'load': {\n            return {\n                ...state,\n                isLoading: true,\n                isAllFetched: false,\n            }\n        }\n        case 'load-success': {\n            return {\n                ...state,\n                playlists: [...state.playlists, ...action.payload],\n                isLoading: false,\n                isAllFetched: action.payload < playlistButtonMaxFetchCount,\n                error: '',\n            }\n        }\n        case 'create': {\n            return {\n                ...state,\n                isLoading: false,\n                isCreating: true\n            }\n        }\n        case 'create-success': {\n            return {\n                ...state,\n                isLoading: false,\n                isCreating: false\n            }\n        }\n        case 'add': {\n            return {\n                ...state,\n                isLoading: false,\n                isAdding: true,\n                playlistToUpgrade: action.payload\n            }\n        }\n        case 'add-update-playlist': {\n            return {\n                ...state,\n                playlists: state.playlists.map(playlist => {\n                    if (playlist.id === state.playlistToUpgrade.id) return { ...playlist, contains: !playlist.contains }\n                    else return playlist\n                }),\n                playlistToUpgrade: null\n            }\n        }\n        case 'add-success': {\n            return {\n                ...state,\n                isAdding: false\n            }\n        }\n        case 'change-playlist-privacy-success': {\n            return {\n                ...state,\n                playlists: state.playlists.map(playlist => {\n                    if (playlist.id === action.payload.id) return { ...playlist, is_public: action.payload.is_public }\n                    return playlist\n                })\n            }\n        }\n        case 'error':\n            return {\n                ...state,\n                isLoading: false,\n                isAllFetched: false,\n                isCreating: false,\n                error: action.payload,\n                title: ''\n            }\n        default:\n            return state\n\n    }\n}\n","import React, { useCallback, useEffect, useContext, useReducer } from 'react';\nimport { Button, Col, Dropdown, Form, FormCheck, FormControl, Row, Spinner } from \"react-bootstrap\";\n\nimport * as userApi from '../../services/userService'\nimport * as playlistApi from '../../services/playlistService'\n\nimport ToastContext from '../../helpers/contexts/toast/toastContext';\nimport useBottomScrollListener from '../../helpers/hooks/useBottomScrollListener';\nimport { playlistDropdownMenuReducer, playlistDropdownMenuInitialState } from './reducers/playlistDropdownMenuReducer'\nimport ChangePrivacyButton from '../../helpers/components/changePrivacyButton';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport useRipple from \"useripple\"\nimport { playlistButtonMaxFetchCount } from '../../config';\n\nfunction PlaylistDropdownMenu({ filmID, handlePlaylistClose, isPreview, filmDispatch }) {\n\n    const [addRipple, ripples] = useRipple({ background: \"black\" })\n\n    const { createToast } = useContext(ToastContext);\n    const [state, dispatch] = useReducer(playlistDropdownMenuReducer, playlistDropdownMenuInitialState);\n\n    const { playlists, title, isPublic, isLoading, isAllFetched, isCreating, isAdding, playlistToUpgrade, error } = state\n\n    const handleOnPlaylistDropdownMenuBottom = useCallback(() => {\n        if (!isLoading && !isAllFetched && !isCreating && !isAdding) {\n            dispatch({\n                type: 'load'\n            })\n        }\n    }, [isLoading, isAllFetched, isCreating, isAdding])\n\n    const scrollRef = useBottomScrollListener(handleOnPlaylistDropdownMenuBottom);\n\n    useEffect(() => {\n        async function getMyPlaylists() {\n            await userApi.me({ playlists: true, skip: playlists.length, limit: playlistButtonMaxFetchCount })\n                .then(res => {\n\n                    let result = res.data.playlists\n\n                    result.forEach(playlist => {\n                        playlist.contains = playlist.films.indexOf(filmID) > -1\n                    });\n\n                    dispatch({\n                        type: 'load-success',\n                        payload: result\n                    })\n                })\n                .catch(err => {\n                    console.error(err)\n                })\n        }\n\n        if (isLoading) getMyPlaylists()\n\n    }, [filmID, playlists, isLoading])\n\n    useEffect(() => {\n\n        async function creatPlaylist() {\n            const body = { title: title, is_public: isPublic, films_id: [filmID] };\n\n            await playlistApi.create(body)\n                .then(res => {\n                    dispatch({\n                        type: 'create-success'\n                    })\n                    createToast(`Created playlist ${title}`)\n                    handlePlaylistClose()\n\n                })\n                .catch(err => {\n                    console.error(err)\n                    let errorMessage = null\n\n                    if (err.response && err.response.data && err.response.data.error) {\n                        errorMessage = err.response.data.error\n                    } else if (err.response && err.response.data && err.response.data.errors) {\n                        errorMessage = err.response.data.errors[0]\n                    }\n\n                    dispatch({\n                        type: 'error',\n                        payload: errorMessage === \"Path `title` is required.\" ? 'Playlist title is required' : errorMessage\n                    })\n                })\n        }\n\n        if (isCreating) creatPlaylist()\n\n    }, [isCreating, title, isPublic, createToast, handlePlaylistClose, filmID,])\n\n    useEffect(() => {\n        async function addToPlaylist() {\n\n            let body = { films_id: [filmID] };\n\n            body = playlistToUpgrade.contains ? { ...body, is_remove_films: true } : { ...body, is_remove_films: false }\n\n            const message = playlistToUpgrade.contains ? `Deleted from playlist ${playlistToUpgrade.title}` : `Added to playlist ${playlistToUpgrade.title}`\n\n            dispatch({\n                type: 'add-update-playlist',\n                playlist: playlistToUpgrade\n            })\n\n            await playlistApi.partialUpdate(playlistToUpgrade.id, body)\n                .then(res => {\n                    dispatch({\n                        type: 'add-success'\n                    })\n\n                    if (isPreview) {\n                        filmDispatch({\n                            type: 'field',\n                            fieldName: 'reloadPlaylist',\n                            payload: true\n                        })\n                    }\n                    createToast(message)\n                })\n                .catch(err => console.error(err))\n        }\n        if (isAdding && playlistToUpgrade) addToPlaylist()\n    }, [isAdding, playlistToUpgrade, createToast, filmDispatch, filmID, isPreview])\n\n    const handleAddToPlaylist = (playlist) => {\n        dispatch({\n            type: 'add',\n            payload: playlist\n        })\n    };\n\n    const handleCreatePlaylist = (e) => {\n        e.stopPropagation()\n        dispatch({\n            type: 'create'\n        })\n    };\n\n    return (\n\n        <Dropdown.Menu\n            onClick={e => e.stopPropagation()}\n            style={{ width: 240 + \"px\" }}>\n            <Row className=\"m-0 m-button playlist-add-button-ripple\" >\n                <Col className=\"playlist-add-exit-text-width\">Save to...</Col>\n                <Col xs={2} sm={2}\n                    onClick={(e) => {\n                        addRipple(e)\n                        setTimeout(handlePlaylistClose, 150)\n                    }}\n                    style={{ borderRadius: 20 + \"px\", width: 24 + \"px\", height: 24 + \"px\" }}\n                    className=\"playlist-add-icon-holder p-0 playlist-add-button-ripple d-flex align-items-center text-center justify-content-center\">\n                    <FontAwesomeIcon icon=\"times\" />\n                    {ripples}\n                </Col>\n            </Row>\n            <Dropdown.Divider />\n            <div\n                ref={scrollRef}\n                style={{\n                    maxHeight: 100 + 'px', overflowY: 'scroll', minHeight: 3 + 'rem'\n                }}>\n\n                {\n                    playlists.map((playlist, index) => {\n                        return (<Row className=\"m-0 playlist-form-group\" key={playlist.id} >\n                            <Col xs={10} sm={10} className=\"p-0\">\n                                <Form.Check id={playlist.id} className=\"form-check\">\n                                    <FormCheck.Input type=\"checkbox\"\n                                        onChange={() => handleAddToPlaylist(playlist)}\n                                        checked={playlist.contains} />\n                                    <FormCheck.Label>\n                                        <p className=\"playlist-check-label\">\n                                            {playlist.title}\n                                        </p>\n                                    </FormCheck.Label>\n                                </Form.Check>\n\n                            </Col>\n                            <ChangePrivacyButton\n                                id={playlist.id}\n                                isPublic={playlist.is_public}\n                                isProfile={false}\n                                filmDispatch={filmDispatch}\n                                dispatchPrivacyUpdate={dispatch} />\n\n                        </Row>)\n                    })\n                }\n\n                {\n                    !isAllFetched && <div style={{ height: 32 + 'px' }} className=\"d-flex justify-content-center\">\n                        {isLoading && <Spinner animation=\"border\" />}\n                    </div>\n                }\n            </div>\n            <Dropdown.Divider />\n            <Dropdown.ItemText>Create a new playlist</Dropdown.ItemText>\n            <Row className=\"m-0 p-0\">\n                <Form>\n                    <FormControl\n                        isInvalid={error !== ''}\n                        onChange={(e) => dispatch({ type: 'field', fieldName: 'title', payload: e.target.value })}\n                        className=\"mb-2 mt-2\"\n                        placeholder=\"Enter playlist title...\" />\n\n                    <FormControl.Feedback type=\"invalid\"\n                        className=\"mb-2 mt-2\">\n                        {error}\n                    </FormControl.Feedback>\n                    <Form.Select aria-label=\"Privacy\" className=\"mb-2 mt-2\"\n                        onChange={(e) => dispatch({ type: 'field', fieldName: 'isPublic', payload: e.target.value === 'public' })}>\n                        <option value=\"private\">Private</option>\n                        <option value=\"public\">Public</option>\n                    </Form.Select>\n\n                    <Form.Group className=\"d-flex align-items-center mt-2\">\n                        <Button disabled={isCreating}\n                            onClick={isCreating ? null : handleCreatePlaylist}>Create</Button>\n\n                        {\n                            isCreating &&\n                            <Spinner className=\"ms-2\" animation=\"grow\" />\n                        }\n                    </Form.Group>\n\n                </Form>\n\n            </Row>\n\n        </Dropdown.Menu>\n\n\n    )\n}\n\nexport default PlaylistDropdownMenu\n","import React, { useState, useContext } from 'react';\nimport { Col, Dropdown } from \"react-bootstrap\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport PlaylistDropdownMenu from './playlistDropdownMenu'\nimport UserContext from '../../helpers/contexts/user/userContext';\nimport useRipple from \"useripple\"\n\nimport { faEllipsisV } from '@fortawesome/free-solid-svg-icons'\n\nimport './playlistAdd.css'\n\nfunction PlaylistAddButton(props) {\n\n    const { user } = useContext(UserContext);\n\n    const [addRipple, ripples] = useRipple({ background: \"black\" })\n\n    const [isOpen, setIsOpen] = useState(false)\n\n    const handlePlaylistClose = () => {\n        setIsOpen(false)\n    }\n\n    const allClass = \"\"\n    const previewClass = \"col-sm-2 col-2 p-0\"\n\n    return (\n\n        user.auth ?\n            <Dropdown show={isOpen}\n                onToggle={(isOpen, event, metadata) => {\n                    setIsOpen(isOpen)\n                }} className={props.isPreview ? previewClass : allClass} >\n                <Dropdown.Toggle variant=\"link\" bsPrefix=\"p-0\"\n                    className=\"m-button playlist-add-button-ripple\"\n                    style={{ color: \"black\" }}>\n                    <div style={{ display: 'inline-block', width: '100%', height: '100%' }}>\n                        <Col\n                            onClick={addRipple}\n                            style={{ verticalAlign: 'top', borderRadius: 20 + \"px\", width: 24 + \"px\", height: 24 + \"px\" }}\n                            className=\"playlist-add-icon-holder p-0 playlist-add-button-ripple\">\n                            <FontAwesomeIcon style={{ opacity: (isOpen ? 1 : \"\") }}\n                                className=\"playlist-add-icon\" icon={faEllipsisV} />\n                            {ripples}\n                        </Col>\n                    </div>\n                </Dropdown.Toggle>\n                {isOpen && <PlaylistDropdownMenu\n                    isPreview={props.isPreview}\n                    filmDispatch={props.filmDispatch}\n                    isOpen={isOpen}\n                    filmID={props.filmID}\n                    handlePlaylistClose={handlePlaylistClose} />}\n            </Dropdown>\n            :\n            null\n\n    )\n}\n\nexport default PlaylistAddButton\n","import React from 'react';\nimport { Col, Row } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport TextTruncate from \"react-text-truncate\";\n\nimport BlurredImageComponent from \"../../components/blurredImage\";\nimport PlaylistAddButtonComponent from \"../../components/add/playlistAddButton\";\n\nimport { checkIfPlaylistButtonClick } from '../index'\nimport RemoveButton from './removeButton';\nimport '../../components/filmPage/film.css'\n\nconst Film = ({ film, index, handleRedirect, handleRemove, isProfile, isRecommendations }) => {\n\n    const recommendationsClass = \"row mx-0 mb-4\"\n    const normalClass = \"col mb-5 col-12 col-sm-6 col-md-3 col-lg-2\"\n\n    return (\n        <div className={isRecommendations ? recommendationsClass : normalClass}>\n            <div className={(isRecommendations ? \"row p-0 m-0\" : \"col\").concat(\" play-outer-container remove-container\")}\n                onClick={(e) => {\n                    const isPlaylistButton = checkIfPlaylistButtonClick(e.target)\n                    if (!isPlaylistButton) handleRedirect(film.id)\n                }}>\n                <Col xs={isRecommendations ? 6 : 12} sm={isRecommendations ? 6 : 12}\n                    className=\"m-0 p-0\">\n                    <div\n                        className=\"embed-responsive embed-responsive-16by9 z-depth-1-half play-container\">\n                        <BlurredImageComponent\n                            image={film.img} />\n                        <FontAwesomeIcon className=\"play-middle\" icon=\"play\" />\n                    </div>\n                </Col>\n                <Col xs={isRecommendations ? 6 : 12} sm={isRecommendations ? 6 : 12}\n                    className={isRecommendations ? \"m-0\" : \"m-0 p-0\"}>\n                    <Row className=\"m-0 mt-1\">\n                        <Col className=\"film-preview-playlist-title-width p-0\">\n                            <TextTruncate line={1} text={film.title}\n                                className=\"mb-1 mt-1 title \" />\n                        </Col>\n\n                        <Col className=\"p-0 d-flex justify-content-end\">\n                            {\n                                isProfile ?\n                                    <RemoveButton handleRemove={handleRemove} /> :\n                                    <PlaylistAddButtonComponent\n                                        index={index}\n                                        filmID={film.id} />\n                            }\n                        </Col>\n                    </Row>\n                    <p className=\"mb-0 author-nick-color\">\n                        <small>{film.author_name}</small>\n                    </p>\n                    <p className=\"mb-0 film-views\">\n                        <small>{film.views} views</small>\n                    </p>\n                </Col>\n            </div>\n        </div>\n    )\n}\n\nexport default Film","export default __webpack_public_path__ + \"static/media/image_not_found.c4ba1e76.png\";","import { createContext } from 'react'\nconst FilmContext = createContext();\nexport default FilmContext","const initialFilm = {\n    img: '',\n    video: '',\n    film: '',\n    title: '',\n    views: '',\n    likes: '',\n    dislikes: '',\n    description: `\\r\\n\\n\\n`,\n}\n\nexport const initialPreviewState = {\n    film: initialFilm,\n    isLiked: false,\n    isDisliked: false,\n    isLikeButtonClicked: false,\n    likeAction: null,\n    isDescExpanded: false\n}\n\nexport function previewReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'like': {\n            return {\n                ...state,\n                isLikeButtonClicked: true,\n                likeAction: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                film: action.film,\n                isLiked: action.isLiked,\n                isDisliked: action.isDisliked,\n                isLikeButtonClicked: false,\n                likeAction: null,\n                isDescExpanded: false\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isLikeButtonClicked: false,\n                likeAction: null\n            }\n        }\n        default: return state\n    }\n}","import React, { useState, useEffect, useCallback, useContext, useReducer } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom'\n\nimport { Button, Col, Row } from \"react-bootstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport * as filmApi from '../../services/filmService'\nimport * as userApi from '../../services/userService'\n\nimport { Player } from 'video-react';\nimport TextTruncate from 'react-text-truncate';\n\nimport FilmContext from '../../helpers/contexts/film/filmContext'\n\nimport \"../../../node_modules/video-react/dist/video-react.css\";\nimport { initialPreviewState, previewReducer } from './reducers/previewReducer';\nimport UserContext from '../../helpers/contexts/user/userContext';\nimport { faEye, faThumbsDown, faThumbsUp } from '@fortawesome/free-solid-svg-icons'\n\n\nfunction FilmPreview(props) {\n\n    let history = useHistory()\n    let location = useLocation()\n\n    const { user } = useContext(UserContext)\n\n    // eslint-disable-next-line no-unused-vars\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const playerRef = useCallback(node => {\n        if (node !== null) {\n            filmDispatch({\n                type: 'field',\n                fieldName: 'playerHeight',\n                payload: node.getBoundingClientRect().height\n            })\n            setPlayerNode(node)\n        }\n    }, [filmDispatch])\n\n    const [state, dispatch] = useReducer(previewReducer, initialPreviewState)\n\n    const { film, isLiked, isDisliked, isLikeButtonClicked, likeAction, isDescExpanded } = state\n\n    const [playerNode, setPlayerNode] = useState(null);\n\n\n    useEffect(() => {\n        if (playerNode) {\n\n            const measure = () => {\n                filmDispatch({\n                    type: 'field',\n                    fieldName: 'playerHeight',\n                    payload: playerNode.getBoundingClientRect().height\n                })\n            }\n\n            window.addEventListener(\"resize\", measure);\n\n            return () => window.removeEventListener(\"resize\", measure);\n        }\n    }, [playerNode, filmDispatch]);\n\n    useEffect(() => {\n        async function handleGetFilm() {\n            let requests = [filmApi.index(props.match.params.id), filmApi.view(props.match.params.id)]\n            if (user.auth) requests.push(userApi.me({ details: true }))\n\n            const [filmResponse, filmViewResponse, userResponse] = await Promise.allSettled(requests);\n\n            if (filmResponse.status === \"rejected\" || filmViewResponse.status === \"rejected\") {\n                filmDispatch({\n                    type: 'field',\n                    fieldName: 'error',\n                    payload: true\n                })\n                return\n            }\n\n\n            const filmData = filmResponse.value.data\n\n            filmDispatch({\n                type: 'success',\n                comments: filmData.comments,\n                commentsCount: filmData.comments_count\n            })\n\n            const film = {\n                ...filmData,\n                img: `${process.env.REACT_APP_API_URL}films/${filmData.id}/thumbnail?width=poster`,\n                video: `${process.env.REACT_APP_API_URL}films/${filmData.id}/video`,\n                views: filmViewResponse.value.data.views\n            }\n            let isLiked = false\n            let isDisliked = false\n\n\n            if (userResponse && userResponse.status === \"fulfilled\") {\n                const details = userResponse.value.data.details\n                isLiked = details.liked.indexOf(props.match.params.id) > -1\n                isDisliked = details.disliked.indexOf(props.match.params.id) > -1\n            }\n\n            dispatch({\n                type: 'success',\n                film: film,\n                isLiked: isLiked,\n                isDisliked: isDisliked\n            })\n\n        }\n        handleGetFilm()\n    }, [props.match.params.id, filmDispatch, user.auth])\n\n    useEffect(() => {\n        async function handleLike() {\n            if (likeAction === null) return\n\n            try {\n                const likeResult = await filmApi.like(film.id, { action: likeAction })\n\n                let likeData = likeResult.data\n                likeData.img = `${process.env.REACT_APP_API_URL}films/${likeData.id}/thumbnail?width=poster`\n                likeData.video = `${process.env.REACT_APP_API_URL}films/${likeData.id}/video`\n\n                const userResult = await userApi.me({ details: true })\n                const details = userResult.data.details\n                const isLiked = details.liked.indexOf(likeData.id) > -1\n                const isDisliked = details.disliked.indexOf(likeData.id) > -1\n\n                dispatch({\n                    type: 'success',\n                    film: likeData,\n                    isLiked: isLiked,\n                    isDisliked: isDisliked\n                })\n\n            } catch (err) {\n                console.error(err)\n                dispatch({\n                    type: 'error'\n                })\n                if (err.response && err.response.status === 401) {\n                    history.push(`${location.pathname}/login`);\n                }\n            }\n        }\n\n        if (isLikeButtonClicked) handleLike()\n    }, [film.id, isLikeButtonClicked, likeAction, history, location])\n\n    const handleTruncate = (e) => {\n        e.preventDefault();\n        dispatch({\n            type: 'field',\n            fieldName: 'isDescExpanded',\n            payload: !isDescExpanded\n        })\n    }\n\n    const handleLike = (action) => {\n        if (isLikeButtonClicked) return\n        dispatch({\n            type: 'like',\n            payload: action\n        })\n\n    };\n\n    const TruncateButton = (title) => {\n        return (<span>\n            <Button variant=\"link\"\n                className=\"p-0 m-0 mb-1 title fw-bold\"\n                onClick={handleTruncate}>{title}</Button>\n        </span>)\n    }\n    return (\n\n        <Col>\n            <Col sm={12}>\n                <div ref={playerRef}>\n                    <Player\n                        playsInline\n                        poster={film.img}\n                        src={film.video} />\n                </div>\n            </Col>\n            {\n                film &&\n                <React.Fragment>\n                    <Col className=\"mt-4\" sm={12}>\n                        <Row className=\"p-0 m-0\">\n                            <Col sm={12} className=\"p-0\">\n                                {!film.title && <p className=\"fw-bold\"><br /></p>}\n                                <p className=\"fw-bold\">{film.title}</p>\n                            </Col>\n                            <Col xs={4} sm={4} className=\"p-0\">\n                                <p><FontAwesomeIcon icon={faEye} /> &ensp;{film.views}</p>\n                            </Col>\n                            <Col xs={4} sm={4} className=\"text-right d-flex justify-content-end\">\n                                <p style={{ cursor: \"pointer\" }}\n                                    className={isLiked ? 'film-picked-thumb-color' : ''}\n                                    onClick={() => handleLike('like')}>\n                                    <FontAwesomeIcon icon={faThumbsUp} />\n                                    &ensp;{film.likes}\n                                </p>\n                            </Col>\n                            <Col xs={4} sm={4}>\n                                <p style={{ cursor: \"pointer\" }} className={isDisliked ? 'film-picked-thumb-color' : ''}\n                                    onClick={() => handleLike('dislike')}>\n                                    <FontAwesomeIcon icon={faThumbsDown} />\n                                    &ensp;{film.dislikes}\n                                </p>\n                            </Col>\n                            <Col sm={12} className=\"mt-4 mb-4 divider\" />\n\n                            <Col sm={12} className=\"p-0\" style={{ whiteSpace: 'pre-line', textAlign: 'justify' }}>\n                                <TextTruncate line={!isDescExpanded && 2}\n                                    truncateText=\"…\"\n                                    text={film.description}\n                                    textTruncateChild={TruncateButton('Show more')} />\n\n                                {isDescExpanded && TruncateButton('Show less')}\n                            </Col>\n                        </Row>\n                    </Col>\n                    <Col sm={12} className=\"mt-4 mb-2 divider\" />\n                </React.Fragment>\n            }\n        </Col>\n\n\n    )\n}\n\n\nexport default FilmPreview\n","import { recommendationsMaxFetchCount } from \"../../../config\"\n\nexport const recommendationsInitialState = {\n    films: null,\n    id: null,\n    isLoading: false,\n    isAllFetched: false,\n    isInitialLoaded: false,\n    error: null,\n}\n\nexport function recommendationsReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'clear': {\n            return recommendationsInitialState\n        }\n        case 'initial-success': {\n            return {\n                ...recommendationsInitialState,\n                films: action.films,\n                id: action.id,\n                isInitialLoaded: true\n            }\n        }\n        case 'load': {\n\n            return {\n                ...state,\n                isLoading: true,\n                isAllFetched: false\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                films: [...state.films, ...action.payload],\n                isLoading: false,\n                isAllFetched: action.payload.length < recommendationsMaxFetchCount\n            }\n        }\n        case 'error': {\n            return {\n                ...recommendationsInitialState,\n                error: action.payload\n            }\n        }\n        default: return state\n    }\n}\n","import React, { useEffect, useReducer, useCallback, useContext } from 'react';\n\nimport { Col, Spinner } from \"react-bootstrap\";\n\nimport * as filmApi from '../../services/filmService'\n\nimport useBottomScrollListener from '../../helpers/hooks/useBottomScrollListener';\nimport Film from '../../helpers/components/film';\nimport { recommendationsReducer, recommendationsInitialState } from './reducers/recommendationsReducer'\nimport { recommendationsMaxFetchCount } from \"../../config\"\nimport FilmContext from '../../helpers/contexts/film/filmContext';\n\nfunction FilmsRecommendations(props) {\n\n    // eslint-disable-next-line no-unused-vars\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(recommendationsReducer, recommendationsInitialState)\n\n    const { films, isLoading, isAllFetched, isInitialLoaded, id, error } = state\n\n    const handleRecommendationsOnBottom = useCallback(() => {\n        if (!isLoading && !isAllFetched && isInitialLoaded && !error && id) {\n            dispatch({\n                type: 'load'\n            })\n        }\n    }, [isLoading, isAllFetched, isInitialLoaded, error, id])\n\n    useBottomScrollListener(handleRecommendationsOnBottom)\n\n    useEffect(() => {\n        async function initialLoad() {\n            await filmApi.all({ exclude: props.match.params.id, limit: recommendationsMaxFetchCount })\n                .then(res => {\n                    let films = res.data;\n\n                    films.forEach(film => {\n                        film.img = `${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail?width=small_webp`\n\n                    });\n\n                    dispatch({\n                        type: 'initial-success',\n                        films: films,\n                        id: props.match.params.id\n                    })\n\n\n                })\n                .catch(err => console.error(err))\n        }\n\n        dispatch({\n            type: 'clear'\n        })\n\n        if (filmState.isPreviewLoaded) {\n            initialLoad()\n        }\n    }, [props.match.params.id, filmState.isPreviewLoaded])\n\n    useEffect(() => {\n        if (filmState.error) {\n            dispatch({\n                type: 'error',\n                payload: filmState.error\n            })\n        }\n    }, [filmState.error])\n\n    useEffect(() => {\n        async function fetchData() {\n            await filmApi.all({ exclude: id, skip: films.length, limit: recommendationsMaxFetchCount }).then(res => {\n                let films = res.data;\n\n                films.forEach(film => {\n                    film.img = `${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail?width=small_webp`\n\n                });\n\n                dispatch({\n                    type: 'success',\n                    payload: films\n                })\n            })\n        }\n        if (isLoading && films && id) fetchData()\n    }, [isLoading, id, films])\n\n    return (\n\n        <Col>\n\n            {\n                films && films.map((film, index) => <Film key={film.id} film={film} index={index} isRecommendations={true} handleRedirect={() => props.handleRedirect(film.id)} />)\n            }\n\n\n            {\n                !isAllFetched && <div style={{ height: 32 + 'px' }} className=\"d-flex justify-content-center\">\n                    {(isLoading || !isInitialLoaded) && !error && <Spinner animation=\"border\" />}\n                </div>\n            }\n        </Col>\n    )\n}\n\nexport default FilmsRecommendations\n","import axios from '../helpers/axios'\nimport authHeader from '../helpers/authHeader'\n\n\nexport const all = (film_id, params) => axios.get(`films/${film_id}/comments`, { params })\n\nexport const create = (film_id, form) => axios.post(`films/${film_id}/comments`, form, { headers: authHeader() })\n\nexport const update = (id, update) => axios.put(`comments/${id}`, update, { headers: authHeader() })\n\nexport const remove = (id) => axios.delete(`comments/${id}`, { headers: authHeader() })\n\nexport const sort = (film_id, params) => axios.get(`films/${film_id}/comments/sort`, { params, headers: authHeader() })\n\n\n","import { commentsMaxFetchCount } from \"../../../config\"\n\nexport const commentsInitialState = {\n    comments: null,\n    commentsCount: null,\n    text: '',\n    id: null,\n    isLoading: false,\n    isAllFetched: false,\n    isInitialLoaded: false,\n    isAdding: false,\n    isRemoving: false,\n    toRemove: null,\n    isSorting: false,\n    sort: null,\n    sorts: [\n        { id: 'created_at', title: 'By date', dir: 1 },\n        { id: 'author_name', title: 'By author name', dir: 1 }\n    ],\n    error: null\n}\n\nexport function commentsReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'clear': {\n            return {\n                ...commentsInitialState,\n                id: action.id\n            }\n        }\n        case 'load': {\n            return !state.isLoading && !state.isAllFetched && state.isInitialLoaded && !state.isAdding &&\n                !state.error && state.id && !state.isSorting ?\n                {\n                    ...state,\n                    isLoading: true\n                } : state\n        }\n        case 'initial-success': {\n            return {\n                ...state,\n                comments: action.comments,\n                commentsCount: action.commentsCount,\n                isAllFetched: action.comments.length < commentsMaxFetchCount,\n                isInitialLoaded: true,\n                error: null,\n            }\n        }\n        case 'load-success': {\n            return {\n                ...state,\n                comments: [...state.comments, ...action.payload],\n                isLoading: false,\n                isAllFetched: action.payload.length < commentsMaxFetchCount\n            }\n        }\n        case 'add': {\n            return {\n                ...state,\n                isAdding: true,\n                error: null\n            }\n        }\n        case 'add-success': {\n            return {\n                ...state,\n                text: '',\n                commentsCount: state.commentsCount + 1,\n                comments: [action.payload, ...state.comments],\n                isAdding: false\n            }\n        }\n        case 'remove': {\n            return {\n                ...state,\n                isRemoving: true,\n                toRemove: action.payload\n            }\n        }\n        case 'remove-success': {\n            return {\n                ...state,\n                isRemoving: false,\n                toRemove: null,\n                commentsCount: state.commentsCount - 1,\n                comments: state.toRemove ? state.comments.filter(comment => comment.id !== state.toRemove.id) : state.data\n            }\n        }\n        case 'sort': {\n            return {\n                ...state,\n                comments: null,\n                isAllFetched: false,\n                sorts: state.sorts.map(sort => {\n                    if (sort.id === action.sortToChange.id) return action.sortToChange\n                    else return sort\n                }),\n                sort: action.sort,\n                isSorting: true,\n            }\n        }\n        case 'sort-success': {\n            return {\n                ...state,\n                isSorting: false,\n                comments: action.payload,\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isAdding: false,\n                isLoading: false,\n                isSorting: false,\n                error: action.payload,\n            }\n        }\n        default: return state\n    }\n}","import React, { useContext, useEffect, useReducer, useCallback } from 'react';\n\nimport { Button, Col, Dropdown, DropdownButton, Row, Spinner } from \"react-bootstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport TextField from '@material-ui/core/TextField';\nimport ButtonBase from \"@material-ui/core/ButtonBase/ButtonBase\";\n\nimport * as commentApi from '../../services/commentService'\n\nimport useBottomScrollListener from '../../helpers/hooks/useBottomScrollListener';\nimport { commentsReducer, commentsInitialState } from './reducers/commentsReducer';\nimport { commentsMaxFetchCount } from \"../../config\"\nimport UserContext from '../../helpers/contexts/user/userContext';\nimport FilmContext from '../../helpers/contexts/film/filmContext';\nimport { displayCommentDate } from '../../helpers';\nimport RemoveModalContext from '../../helpers/contexts/removeModal/removeModalContext';\n\nfunction Comments(props) {\n\n    const { showModal, clear, removeModalData } = useContext(RemoveModalContext)\n\n    const { user } = useContext(UserContext);\n\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(commentsReducer, commentsInitialState)\n    const {\n        comments,\n        commentsCount,\n        text,\n        isInitialLoaded,\n        isLoading,\n        isAllFetched,\n        isAdding,\n        id,\n        isRemoving,\n        toRemove,\n        isSorting,\n        sort,\n        sorts,\n        error\n    } = state\n\n    const handleOnCommentsBottom = useCallback(() => {\n        if (!isLoading && !isAllFetched && isInitialLoaded && !isAdding && !error && id && !isSorting) {\n            dispatch({\n                type: 'load'\n            })\n        }\n    }, [isLoading, isAllFetched, isInitialLoaded, isAdding, error, id, isSorting])\n\n    useBottomScrollListener(handleOnCommentsBottom)\n\n    useEffect(() => {\n        dispatch({\n            type: 'clear',\n            id: props.match.params.id\n        })\n    }, [props.match.params.id])\n\n    useEffect(() => {\n        if (filmState.error) {\n            dispatch({\n                type: 'error',\n                payload: filmState.error\n            })\n        }\n    }, [filmState.error])\n\n    useEffect(() => {\n        function getCommentsFromContext() {\n            dispatch({\n                type: 'initial-success',\n                comments: filmState.comments,\n                commentsCount: filmState.commentsCount,\n            })\n        }\n\n        if (filmState.comments && filmState.commentsCount !== null) getCommentsFromContext()\n    }, [filmState.comments, filmState.commentsCount, filmDispatch])\n\n    useEffect(() => {\n        async function loadComments() {\n            await commentApi.all(id, { skip: comments.length, limit: commentsMaxFetchCount })\n                .then(res => {\n                    dispatch({\n                        type: 'load-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error'\n                    })\n                })\n        }\n        async function loadSortedComments() {\n            await commentApi.sort(id, { [sort.id]: sort.dir, skip: comments.length, limit: commentsMaxFetchCount })\n                .then(res => {\n                    dispatch({\n                        type: 'load-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error'\n                    })\n                })\n        }\n        if (isLoading && isInitialLoaded && !isAdding &&\n            comments && id && !isSorting) {\n            if (!sort)\n                loadComments()\n            else\n                loadSortedComments()\n        }\n    }, [isLoading, isAdding, id, comments, isInitialLoaded, isSorting, sort])\n\n\n    useEffect(() => {\n        const addComment = async () => {\n            const comment = { text: text }\n\n            await commentApi.create(id, comment)\n                .then(res => {\n                    dispatch({\n                        type: 'add-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error',\n                        payload: err.response.status\n                    })\n                })\n        };\n        if (isAdding && !isLoading && id) addComment()\n    }, [isAdding, isLoading, id, text])\n\n    useEffect(() => {\n        async function removeComment() {\n            await commentApi.remove(toRemove.id)\n                .then(res => {\n                    dispatch({ type: 'remove-success' })\n                    clear()\n                })\n                .catch(err => {\n                    clear()\n                    console.error(err)\n                })\n        }\n\n        if (isRemoving && toRemove && removeModalData.isRemoving &&\n            removeModalData.id === toRemove.id && removeModalData.type === 'comment' &&\n            removeModalData.title === toRemove.text.substring(0, 10).concat('...')) removeComment()\n    }, [isRemoving, toRemove, clear, removeModalData])\n\n    useEffect(() => {\n        async function sortComments() {\n            const sortParams = sort ? { [sort.id]: sort.dir, limit: commentsMaxFetchCount } : {}\n\n            await commentApi.sort(id, sortParams)\n                .then(res => {\n                    dispatch({ type: 'sort-success', payload: res.data })\n                })\n                .catch(err => {\n                    dispatch({ type: 'error', payload: 'Sort error.' })\n                    console.error(err)\n                })\n        }\n        if (isSorting) sortComments()\n    }, [isSorting, sort, id])\n\n    const handleAddComment = () => {\n        dispatch({\n            type: 'add'\n        })\n    }\n\n    const handleRemoveComment = (comment) => {\n        if (removeModalData.isRemoving) return\n        dispatch({ type: 'remove', payload: comment })\n        showModal(comment.id, 'comment', comment.text.substring(0, 10).concat('...'))\n    }\n\n    const handleSortComments = (e) => {\n\n        let sortToChange = null\n\n        switch (e) {\n            case 'created_at':\n                sortToChange = sorts[0]\n\n                break;\n            case 'author_name':\n                sortToChange = sorts[1]\n                break;\n            default:\n                return;\n        }\n\n        let tmpSort = null\n\n        if (sort && sort.id === sortToChange.id) {\n            sortToChange.dir *= -1\n            tmpSort = sortToChange\n            if (sortToChange.dir === 1) {\n                tmpSort = null\n            }\n        } else {\n            tmpSort = sortToChange\n        }\n\n        dispatch({\n            type: 'sort',\n            sortToChange: sortToChange,\n            sort: tmpSort\n        })\n\n    };\n\n\n    return (\n\n        <Col>\n            <Row className=\"p-0 mt-4 mb-4\">\n                <Col xs={7} sm={5} md={4} className=\"d-flex align-items-center \">\n                    {commentsCount !== null && <span>{commentsCount}{commentsCount === 1 ? ' comment' : ' comments'} </span>}\n                </Col>\n                <Col xs={2} sm={2}>\n                    <DropdownButton\n                        variant=\"secondary\"\n                        title=\"Sort\"\n                        id=\"dropdown-button-drop-down\"\n                        onSelect={e => handleSortComments(e)}>\n                        {\n                            sorts.map(sortTmp => (\n                                <Dropdown.Item key={sortTmp.id} eventKey={sortTmp.id} active={sort && sortTmp.id === sort.id}>\n                                    {sortTmp.title}\n                                    {sort && sort.id === sortTmp.id && sortTmp.dir === 1 ?\n                                        <FontAwesomeIcon className=\"ms-2\" icon=\"sort-up\" /> :\n                                        sort && sort.id === sortTmp.id && sortTmp.dir === -1 ?\n                                            <FontAwesomeIcon className=\"ms-2\" icon=\"sort-down\" /> : \"\"}\n                                </Dropdown.Item>)\n                            )\n                        }\n                    </DropdownButton>\n                </Col>\n            </Row>\n            <TextField\n                value={text}\n                onChange={e => dispatch({ type: 'field', fieldName: 'text', payload: e.target.value })}\n                type=\"text\"\n                id=\"standard-multiline-flexible\"\n                label=\"Comment\"\n                multiline\n                fullWidth\n                maxrow=\"4\" />\n            <Col className=\"d-flex justify-content-end\" >\n                <Button disabled={isAdding || !text}\n                    className=\"mt-3\" variant=\"primary\"\n                    onClick={(text && !isAdding) ? handleAddComment : null}>\n                    Submit\n                </Button>\n            </Col>\n\n            {\n                isAdding && <div style={{ height: 32 + 'px' }} className=\"d-flex justify-content-center\">\n                    <Spinner animation=\"border\" />\n                </div>\n            }\n            {\n                comments && comments.map(comment => {\n                    return (\n                        <Col className=\"p-0 mt-4 remove-container\" sm={12} key={comment.id}>\n                            <div className=\"d-flex\">\n                                <p className=\"m-0 fw-bold\">\n                                    <small className=\"m-0 fw-bold\">{comment.author_name}&nbsp;</small>\n                                </p>\n                                <p >\n                                    <small className=\"m-0\">{displayCommentDate(comment)}</small>\n                                </p>\n                                {\n                                    user.id === comment.author_id &&\n                                    <Col\n                                        xs={2} sm={2}\n                                        className=\"d-flex justify-content-center align-items-center remove-holder p-0 m-0 ms-auto\"\n                                        style={{ height: 24 + 'px', width: 24 + \"px\" }}>\n                                        <ButtonBase\n                                            style={{ borderRadius: 20 + \"px\", width: 24 + \"px\", height: 24 + \"px\" }}\n                                            className=\"m-button cursor-pointer\"\n                                            onClick={() => handleRemoveComment(comment)}>\n                                            <FontAwesomeIcon icon=\"trash-alt\" />\n                                        </ButtonBase>\n                                    </Col>\n                                }\n                            </div>\n                            <p className=\"d-block d-sm-block\">\n                                <small>{comment.text}</small>\n                            </p>\n                        </Col>\n                    )\n                })\n            }\n\n            {\n                !isAllFetched && <div style={{ height: 32 + 'px' }} className=\"d-flex justify-content-center\">\n                    {(isLoading || !isInitialLoaded || isSorting) && !error && <Spinner animation=\"border\" />}\n                </div>\n            }\n\n        </Col>\n\n    )\n}\n\nexport default Comments","\nexport const filmPlaylistInitialState = {\n    playlist: null,\n    currentFilm: null,\n    currentFilmIndex: 0,\n    isLoading: false,\n    isRemovingPlaylist: false,\n    isRemovingFilm: false,\n    removingFilmId: null,\n    headerHeight: null,\n    playerHeight: null\n}\n\nexport const filmPlaylistReducer = (state, action) => {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                isLoading: false,\n                playlist: action.playlist,\n                currentFilm: action.currentFilm,\n                currentFilmIndex: action.currentFilmIndex\n            }\n        }\n        case 'clear': {\n            return filmPlaylistInitialState\n        }\n        case 'remove-film': {\n            return {\n                ...state,\n                removingFilmId: action.payload,\n                isRemovingFilm: true\n            }\n        }\n        case 'remove-film-success': {\n\n            if (!state.removingFilmId)\n                return {\n                    ...state,\n                    isRemovingFilm: false\n                }\n\n            const filtered = state.playlist.films.filter(film => film.id !== state.removingFilmId)\n            return {\n                ...state,\n                currentFilm: state.removingFilmId === state.currentFilm ? null : state.currentFilm,\n                currentFilmIndex: state.removingFilmId === state.currentFilm ? 0 : filtered.findIndex(film => film.id === state.currentFilm) + 1,\n                playlist: {\n                    ...state.playlist,\n                    films: filtered\n                },\n                isRemovingFilm: false,\n            }\n        }\n        case 'change-playlist-privacy-success': {\n            return {\n                ...state,\n                playlist: { ...state.playlist, is_public: action.payload.is_public }\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isLoading: false,\n                error: action.payload\n            }\n        }\n        default:\n            return state\n    }\n}","import React, { useContext, useEffect, useCallback, useReducer } from 'react';\nimport { useLocation } from 'react-router-dom'\nimport { Col, Row } from \"react-bootstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport queryString from \"query-string\";\n\nimport TextTruncate from \"react-text-truncate\";\nimport image_not_found from '../../images/image_not_found.png'; // Tell Webpack this JS file uses this image\n\nimport 'react-perfect-scrollbar/dist/css/styles.css';\nimport PerfectScrollbar from 'react-perfect-scrollbar'\n\nimport * as playlistApi from '../../services/playlistService'\nimport FilmContext from '../../helpers/contexts/film/filmContext';\n\nimport { filmPlaylistInitialState, filmPlaylistReducer } from './reducers/playlistReducer';\n\nimport UserContext from '../../helpers/contexts/user/userContext';\nimport RemoveButton from '../../helpers/components/removeButton';\nimport ChangePrivacyButton from '../../helpers/components/changePrivacyButton';\nimport RemoveModalContext from '../../helpers/contexts/removeModal/removeModalContext';\n\nfunction Playlist(props) {\n\n    const { showModal, clear, removeModalData } = useContext(RemoveModalContext)\n\n    let location = useLocation()\n\n    const { user } = useContext(UserContext)\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(filmPlaylistReducer, filmPlaylistInitialState)\n\n    const {\n        playlist,\n        isRemovingPlaylist,\n        isRemovingFilm,\n        removingFilmId,\n        currentFilm,\n        currentFilmIndex,\n        headerHeight,\n        playerHeight,\n        error\n    } = state\n\n    const clearPlaylist = () => {\n        dispatch({ type: 'clear' })\n    }\n\n    const headerRef = useCallback(node => {\n        if (node !== null) {\n            dispatch({\n                type: 'field',\n                fieldName: 'headerHeight',\n                payload: node.getBoundingClientRect().height\n            });\n        }\n    }, [])\n\n    useEffect(() => {\n        dispatch({\n            type: 'field',\n            fieldName: 'playerHeight',\n            payload: filmState.playerHeight\n        });\n    }, [filmState.playerHeight])\n\n    useEffect(() => {\n        dispatch({\n            type: 'error',\n            payload: filmState.error\n        });\n    }, [filmState.error])\n\n\n    useEffect(() => {\n        async function handleReloadPlaylist() {\n            await playlistApi.index(playlist.id)\n                .then(res => {\n\n                    let filmIndex = 0\n                    let filmId = null\n\n                    Array.prototype.forEach.call(res.data.films, (film, index) => {\n                        if (film && film.id === props.match.params.id) {\n                            filmIndex = index + 1\n                            filmId = film.id\n                        }\n                    })\n\n                    dispatch({\n                        type: 'success',\n                        playlist: res.data,\n                        currentFilm: filmId,\n                        currentFilmIndex: filmIndex\n                    })\n\n                    filmDispatch({\n                        type: 'field',\n                        fieldName: 'reloadPlaylist',\n                        payload: false\n                    })\n\n                    return res.data\n                })\n                .catch(err => {\n                    console.error(err)\n                })\n        }\n\n        if (filmState.reloadPlaylist && playlist) handleReloadPlaylist()\n\n    }, [filmState.reloadPlaylist, playlist, filmDispatch, props.match.params.id])\n\n\n\n    useEffect(() => {\n        const parsed = queryString.parse(location.search);\n        if (!parsed.list) {\n            clearPlaylist()\n            return\n        }\n\n        async function handleGetPlaylist() {\n            await playlistApi.index(parsed.list).then(res => {\n\n                let filmIndex = 0\n                let filmId = null\n\n                Array.prototype.forEach.call(res.data.films, (film, index) => {\n                    if (film && film.id === props.match.params.id) {\n                        filmIndex = index + 1\n                        filmId = film.id\n                    }\n                })\n\n                dispatch({\n                    type: 'success',\n                    playlist: res.data,\n                    currentFilm: filmId,\n                    currentFilmIndex: filmIndex\n                })\n                return res.data\n            }).catch(err => {\n                console.error(err)\n                clearPlaylist()\n            })\n        }\n        if (!error && filmState.isPreviewLoaded) handleGetPlaylist()\n    }, [props.match.params.id, location.search, error, filmState.isPreviewLoaded])\n\n\n    useEffect(() => {\n        async function removePlaylist() {\n            await playlistApi.remove(playlist.id)\n                .then(res => {\n                    clearPlaylist()\n                    clear()\n                })\n                .catch(err => {\n                    console.error(err)\n                    clear()\n                })\n        }\n        if (isRemovingPlaylist && removeModalData.isRemoving &&\n            removeModalData.id === playlist.id && removeModalData.type === 'playlist' &&\n            removeModalData.title === playlist.title) removePlaylist()\n    }, [clear, isRemovingPlaylist, playlist, removeModalData])\n\n\n    useEffect(() => {\n        async function removeFilm() {\n            await playlistApi.partialUpdate(playlist.id, { films_id: [removingFilmId], is_remove_films: true })\n                .then(res => {\n                    dispatch({\n                        type: 'remove-film-success'\n                    })\n                })\n                .catch(err => {\n                    console.error(err)\n                })\n        }\n\n        if (isRemovingFilm) removeFilm()\n    }, [isRemovingFilm, playlist, removingFilmId])\n\n    const handleRemovePlaylist = () => {\n\n        if (removeModalData.isRemoving) return\n\n        dispatch({\n            type: 'field',\n            fieldName: 'isRemovingPlaylist',\n            payload: true\n        })\n\n        showModal(playlist.id, 'playlist', playlist.title)\n    }\n\n    const handleRemoveFromPlaylist = (id) => {\n        if (isRemovingFilm) return\n\n        dispatch({\n            type: 'remove-film',\n            payload: id\n        })\n    }\n\n\n    return (\n\n        playlist && playerHeight && !error &&\n        <Col className='mb-4'>\n            <Col className='p-0 border'>\n                <Col ref={headerRef}\n                    style={{ height: headerHeight + 'px' }}\n                    className=\"remove-container pt-2 pb-2 film-preview-playlist-header\" sm={12}>\n                    <Row className=\"m-0 px-2\">\n                        <Col className=\"film-preview-playlist-title-width\">\n                            <p className=\"mb-1 fw-bold film-preview-playlist-text-truncate\">{playlist.title}</p>\n                        </Col>\n                        <Col className=\"justify-content-end d-flex\">\n                            {\n                                user.id === playlist.author_id &&\n                                <RemoveButton handleRemove={() => handleRemovePlaylist()} />\n                            }\n                        </Col>\n                        <Col xs={12} sm={12}>\n                            {\n                                user.id === playlist.author_id &&\n                                <ChangePrivacyButton\n                                    id={playlist.id}\n                                    isPublic={playlist.is_public}\n                                    isProfile={false}\n                                    dispatchPrivacyUpdate={dispatch} />\n                            }\n                            {\n                                user.id === playlist.author_id && <small>&nbsp;</small>\n\n                            }\n                            <small>{playlist.author_name}&nbsp;</small>\n                            <small\n                                className=\"film-preview-playlist-index\">\n                                - {currentFilmIndex}/{playlist.films.length}\n                            </small>\n                        </Col>\n                    </Row>\n                </Col>\n                <Col style={{ height: playerHeight - headerHeight + 'px' }}\n                    className=\"p-0 film-preview-playlist-container\" xs={12} sm={12}>\n                    <PerfectScrollbar\n                        onYReachEnd={() => { }}\n                        onScrollY={() => { }}>\n                        {\n                            playlist.films.map((film, index) => {\n                                return film && !film.isNonExisting ? (\n                                    <Row xs={12} sm={12} className=\"m-0 p-0 remove-container\" key={film.id}>\n                                        <Col xs={9} sm={9}\n                                            className={index === playlist.films.length - 1 ?\n                                                \"mt-3 mb-3 \" :\n                                                \"mt-3\"}\n                                            onClick={() => props.handleRedirect(film.id)} >\n                                            <Row className=\"m-0 p-0 play-outer-container\">\n                                                <Col xs={1} sm={1}\n                                                    className=\"text-center justify-content-center d-flex align-items-center p-0 ps-1\" >\n                                                    {\n                                                        (currentFilm === film.id) ?\n                                                            <small>\n                                                                <FontAwesomeIcon style={{ fontWeight: 300 }}\n                                                                    icon=\"play\" />\n                                                            </small>\n                                                            :\n                                                            <small>{index + 1}</small>\n\n                                                    }\n                                                </Col>\n                                                <Col xs={6} sm={6} className=\"pe-2 ps-2\"\n                                                    style={{\n                                                        display: 'flex',\n                                                        justifyContent: 'center',\n                                                        alignItems: 'center'\n                                                    }}>\n                                                    <div className=\"embed-responsive embed-responsive-16by9 z-depth-1-half play-container\">\n                                                        <img alt=\"\" className=\"embed-responsive-item play-image\"\n                                                            src={`${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail?width=small_webp`} />\n                                                    </div>\n                                                </Col>\n                                                <Col xs={5} sm={5} className=\"p-0\">\n                                                    <TextTruncate line={1} text={film.title}\n                                                        className=\"mb-0 title fw-bold\" />\n                                                    <p className=\"mb-1 author-nick-color\">\n                                                        <small>{film.author_name}</small>\n                                                    </p>\n                                                </Col>\n                                            </Row>\n                                        </Col>\n                                        {\n                                            user.id === playlist.author_id &&\n                                            <RemoveButton handleRemove={() => handleRemoveFromPlaylist(film.id)} />\n                                        }\n\n                                    </Row>\n                                ) : (\n                                    <Row xs={12} sm={12} className=\"m-0 p-0 remove-container\" key={film.id}>\n                                        <Col xs={9} sm={9}\n                                            className={index === playlist.films.length - 1 ?\n                                                \"mt-3 mb-3 \" :\n                                                \"mt-3\"} >\n                                            <Row className=\"m-0 p-0\">\n                                                <Col xs={1} sm={1}\n                                                    className=\"text-center justify-content-center d-flex align-items-center p-0 ps-1\" >\n                                                    <small>{index + 1}</small>\n                                                </Col>\n                                                <Col xs={6} sm={6} className=\"pe-2 ps-2\"\n                                                    style={{\n                                                        display: 'flex',\n                                                        justifyContent: 'center',\n                                                        alignItems: 'center'\n                                                    }}>\n                                                    <div className=\"embed-responsive embed-responsive-16by9 z-depth-1-half play-container\">\n                                                        <img alt=\"\" className=\"embed-responsive-item play-image\"\n                                                            src={image_not_found} />\n                                                    </div>\n                                                </Col>\n                                                <Col xs={5} sm={5} className=\"p-0\">\n                                                    <TextTruncate line={2} text=\"Not found\"\n                                                        className=\"mb-0 title fw-bold\" />\n                                                </Col>\n                                            </Row>\n                                        </Col>\n                                        {\n                                            user.id === playlist.author_id &&\n                                            <RemoveButton handleRemove={() => handleRemoveFromPlaylist(film.id)} />\n                                        }\n\n                                    </Row>\n                                )\n                            })\n                        }\n                    </PerfectScrollbar>\n\n                </Col>\n            </Col>\n        </Col >\n\n\n    )\n}\n\n\nexport default Playlist\n","import { useReducer } from \"react\"\nimport FilmContext from \"./filmContext\"\n\nconst filmInitialState = {\n    isPreviewLoaded: false,\n    comments: null,\n    commentsCount: null,\n    playerHeight: null,\n    reloadPlaylist: false,\n    error: null\n}\n\nconst filmReducer = (state, action) => {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                isPreviewLoaded: true,\n                comments: action.comments,\n                commentsCount: action.commentsCount,\n                error: null\n            }\n        }\n        case 'reset-comments': {\n            return {\n                ...state,\n                comments: null,\n                commentsCount: null\n            }\n        }\n        default:\n            return state\n    }\n}\n\nconst FilmProvider = ({ children }) => {\n    const [filmState, filmDispatch] = useReducer(filmReducer, filmInitialState)\n\n\n    return (\n        <FilmContext.Provider value={[filmState, filmDispatch]}>\n            {children}\n        </FilmContext.Provider>\n    );\n}\n\nexport default FilmProvider","import React from 'react'\nimport { useHistory, useLocation } from 'react-router-dom'\n\nimport queryString from \"query-string\";\n\nimport FilmPreview from './preview'\nimport { Row, Col } from \"react-bootstrap\";\nimport FilmsRecommendations from './recommendations';\nimport Comments from './comments';\nimport Playlist from './playlist';\nimport useWindowWidth from '../../helpers/hooks/useWindowsWidth'\n\nimport FilmProvider from '../../helpers/contexts/film/filmProvider'\nimport './film.css'\n\n\nfunction Film(props) {\n\n    let history = useHistory()\n    let location = useLocation()\n\n    const onSmallScreen = useWindowWidth();\n\n    const handleRedirect = (id) => {\n        const parsed = queryString.parse(location.search);\n        let historyObject = { pathname: `${process.env.REACT_APP_PATH_NAME}film/` + id }\n        if (parsed.list) historyObject = { ...historyObject, search: `?list=${parsed.list}` }\n        history.push(historyObject);\n    };\n\n    return (\n        <FilmProvider>\n            <Row className=\"p-0 m-0 mt-4 mx-2\">\n                <Col xs={{ span: 12, order: 'first' }} sm={8}>\n                    <FilmPreview {...props} />\n                    {!onSmallScreen && <Comments {...props} />}\n                </Col>\n                <Col xs={{ span: 12, order: 2 }} sm={4}>\n                    <Playlist handleRedirect={handleRedirect} {...props} />\n                    <FilmsRecommendations handleRedirect={handleRedirect} {...props} />\n                </Col>\n                {onSmallScreen &&\n                    <Col xs={{ span: 12, order: 'last' }} sm={8}>\n                        <Comments {...props} />\n                    </Col>\n                }\n            </Row>\n\n        </FilmProvider>\n    )\n}\n\nexport default Film"],"sourceRoot":""}