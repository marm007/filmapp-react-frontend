(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[9],{287:function(t,e,n){var i=n(66),a=n(14);t.exports="process"==i(a.process)},297:function(t,e,n){var i,a,c,o=n(14),r=n(25),s=n(13),l=n(137),u=n(87),f=n(298),d=n(287),p=o.location,m=o.setImmediate,v=o.clearImmediate,h=o.process,j=o.MessageChannel,b=o.Dispatch,y=0,O={},x="onreadystatechange",g=function(t){if(O.hasOwnProperty(t)){var e=O[t];delete O[t],e()}},w=function(t){return function(){g(t)}},C=function(t){g(t.data)},P=function(t){o.postMessage(t+"",p.protocol+"//"+p.host)};m&&v||(m=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return O[++y]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(y),y},v=function(t){delete O[t]},d?i=function(t){h.nextTick(w(t))}:b&&b.now?i=function(t){b.now(w(t))}:j&&!f?(c=(a=new j).port2,a.port1.onmessage=C,i=s(c.postMessage,c,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts&&p&&"file:"!==p.protocol&&!r(P)?(i=P,o.addEventListener("message",C,!1)):i=x in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),g(t)}}:function(t){setTimeout(w(t),0)}),t.exports={set:m,clear:v}},298:function(t,e,n){var i=n(136);t.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(i)},299:function(t,e,n){"use strict";var i=n(9),a=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new a(t)}},320:function(t,e,n){"use strict";var i,a,c,o,r=n(3),s=n(5),l=n(14),u=n(17),f=n(321),d=n(38),p=n(138),m=n(92),v=n(39),h=n(139),j=n(24),b=n(9),y=n(90),O=n(88),x=n(6),g=n(91),w=n(30),C=n(297).set,P=n(322),k=n(324),R=n(325),N=n(299),_=n(326),E=n(45),L=n(89),F=n(12),M=n(327),I=n(287),S=n(67),A=F("species"),T="Promise",U=E.get,D=E.set,J=E.getterFor(T),q=f&&f.prototype,z=f,B=q,H=l.TypeError,K=l.document,W=l.process,G=N.f,Q=G,V=!!(K&&K.createEvent&&l.dispatchEvent),X="function"==typeof PromiseRejectionEvent,Y="unhandledrejection",Z=!1,$=L(T,(function(){var t=O(z),e=t!==String(z);if(!e&&66===S)return!0;if(s&&!B.finally)return!0;if(S>=51&&/native code/.test(t))return!1;var n=new z((function(t){t(1)})),i=function(t){t((function(){}),(function(){}))};return(n.constructor={})[A]=i,!(Z=n.then((function(){}))instanceof i)||!e&&M&&!X})),tt=$||!g((function(t){z.all(t).catch((function(){}))})),et=function(t){var e;return!(!j(t)||"function"!=typeof(e=t.then))&&e},nt=function(t,e){if(!t.notified){t.notified=!0;var n=t.reactions;P((function(){for(var i=t.value,a=1==t.state,c=0;n.length>c;){var o,r,s,l=n[c++],u=a?l.ok:l.fail,f=l.resolve,d=l.reject,p=l.domain;try{u?(a||(2===t.rejection&&ot(t),t.rejection=1),!0===u?o=i:(p&&p.enter(),o=u(i),p&&(p.exit(),s=!0)),o===l.promise?d(H("Promise-chain cycle")):(r=et(o))?r.call(o,f,d):f(o)):d(i)}catch(m){p&&!s&&p.exit(),d(m)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&at(t)}))}},it=function(t,e,n){var i,a;V?((i=K.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),l.dispatchEvent(i)):i={promise:e,reason:n},!X&&(a=l["on"+t])?a(i):t===Y&&R("Unhandled promise rejection",n)},at=function(t){C.call(l,(function(){var e,n=t.facade,i=t.value;if(ct(t)&&(e=_((function(){I?W.emit("unhandledRejection",i,n):it(Y,n,i)})),t.rejection=I||ct(t)?2:1,e.error))throw e.value}))},ct=function(t){return 1!==t.rejection&&!t.parent},ot=function(t){C.call(l,(function(){var e=t.facade;I?W.emit("rejectionHandled",e):it("rejectionhandled",e,t.value)}))},rt=function(t,e,n){return function(i){t(e,i,n)}},st=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,nt(t,!0))},lt=function t(e,n,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===n)throw H("Promise can't be resolved itself");var a=et(n);a?P((function(){var i={done:!1};try{a.call(n,rt(t,i,e),rt(st,i,e))}catch(c){st(i,c,e)}})):(e.value=n,e.state=1,nt(e,!1))}catch(c){st({done:!1},c,e)}}};if($&&(B=(z=function(t){y(this,z,T),b(t),i.call(this);var e=U(this);try{t(rt(lt,e),rt(st,e))}catch(n){st(e,n)}}).prototype,(i=function(t){D(this,{type:T,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(B,{then:function(t,e){var n=J(this),i=G(w(this,z));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=I?W.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&nt(n,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i,e=U(t);this.promise=t,this.resolve=rt(lt,e),this.reject=rt(st,e)},N.f=G=function(t){return t===z||t===c?new a(t):Q(t)},!s&&"function"==typeof f&&q!==Object.prototype)){o=q.then,Z||(d(q,"then",(function(t,e){var n=this;return new z((function(t,e){o.call(n,t,e)})).then(t,e)}),{unsafe:!0}),d(q,"catch",B.catch,{unsafe:!0}));try{delete q.constructor}catch(ut){}m&&m(q,B)}r({global:!0,wrap:!0,forced:$},{Promise:z}),v(z,T,!1,!0),h(T),c=u(T),r({target:T,stat:!0,forced:$},{reject:function(t){var e=G(this);return e.reject.call(void 0,t),e.promise}}),r({target:T,stat:!0,forced:s||$},{resolve:function(t){return k(s&&this===c?z:this,t)}}),r({target:T,stat:!0,forced:tt},{all:function(t){var e=this,n=G(e),i=n.resolve,a=n.reject,c=_((function(){var n=b(e.resolve),c=[],o=0,r=1;x(t,(function(t){var s=o++,l=!1;c.push(void 0),r++,n.call(e,t).then((function(t){l||(l=!0,c[s]=t,--r||i(c))}),a)})),--r||i(c)}));return c.error&&a(c.value),n.promise},race:function(t){var e=this,n=G(e),i=n.reject,a=_((function(){var a=b(e.resolve);x(t,(function(t){a.call(e,t).then(n.resolve,i)}))}));return a.error&&i(a.value),n.promise}})},321:function(t,e,n){var i=n(14);t.exports=i.Promise},322:function(t,e,n){var i,a,c,o,r,s,l,u,f=n(14),d=n(65).f,p=n(297).set,m=n(298),v=n(323),h=n(287),j=f.MutationObserver||f.WebKitMutationObserver,b=f.document,y=f.process,O=f.Promise,x=d(f,"queueMicrotask"),g=x&&x.value;g||(i=function(){var t,e;for(h&&(t=y.domain)&&t.exit();a;){e=a.fn,a=a.next;try{e()}catch(n){throw a?o():c=void 0,n}}c=void 0,t&&t.enter()},m||h||v||!j||!b?O&&O.resolve?((l=O.resolve(void 0)).constructor=O,u=l.then,o=function(){u.call(l,i)}):o=h?function(){y.nextTick(i)}:function(){p.call(f,i)}:(r=!0,s=b.createTextNode(""),new j(i).observe(s,{characterData:!0}),o=function(){s.data=r=!r})),t.exports=g||function(t){var e={fn:t,next:void 0};c&&(c.next=e),a||(a=e,o()),c=e}},323:function(t,e,n){var i=n(136);t.exports=/web0s(?!.*chrome)/i.test(i)},324:function(t,e,n){var i=n(4),a=n(24),c=n(299);t.exports=function(t,e){if(i(t),a(e)&&e.constructor===t)return e;var n=c.f(t);return(0,n.resolve)(e),n.promise}},325:function(t,e,n){var i=n(14);t.exports=function(t,e){var n=i.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},326:function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},327:function(t,e){t.exports="object"==typeof window},330:function(t,e,n){"use strict";var i=n(29),a=n(0),c=n(278),o=n(292),r=n.n(o),s=n(305),l=n(302),u=n(301),f=n(1);e.a=function(t){var e=t.playlist,n=t.handleRedirect,o=t.handleRemove,d=t.isProfile,p=t.dispatchPrivacyUpdate,m=d?8:10,v=Object(a.useState)("mb-5 play-outer-container remove-container"),h=Object(i.a)(v,2),j=h[0],b=h[1];return Object(a.useEffect)((function(){e.film_id||b("mb-5 play-cursor-default remove-container")}),[e.film_id]),Object(f.jsx)("div",{className:"col-12 col-sm-6 col-md-3 col-lg-2",children:Object(f.jsxs)("div",{className:"col ".concat(j),onClick:function(){return n(e.id,e.film_id)},children:[Object(f.jsxs)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:[Object(f.jsx)(s.a,{image:e.img}),Object(f.jsxs)("div",{style:{width:"100%",margin:0},className:"row play-middle",children:[Object(f.jsx)("div",{className:"col-5 col-sm-5",style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:Object(f.jsx)(c.a,{icon:"play"})}),Object(f.jsx)("div",{className:"col-7 col-sm-7",style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:Object(f.jsx)("small",{className:"fw-bold",children:"Play all"})})]})]}),Object(f.jsxs)("div",{className:"row m-0 mt-1",children:[Object(f.jsx)("div",{className:"p-0 col-".concat(m," col-sm-").concat(m),children:Object(f.jsx)(r.a,{line:1,text:e.title,className:"mb-1 mt-1 title "})}),d&&Object(f.jsxs)("div",{className:"col-4 col-sm-4 p-0 d-flex justify-content-end",children:[Object(f.jsx)(u.a,{id:e.id,isPublic:e.is_public,isProfile:!0,dispatchPrivacyUpdate:p}),Object(f.jsx)(l.a,{handleRemove:o})]})]}),Object(f.jsx)("p",{className:"mb-0 author-nick",children:Object(f.jsx)("span",{children:e.author_name})})]})},e.id)}},331:function(t,e,n){"use strict";e.a=n.p+"static/media/image_not_found.c4ba1e76.png"},454:function(t,e,n){"use strict";n.r(e);n(320),n(93),n(140);var i=n(272),a=n.n(i),c=n(27),o=n(2),r=n(273),s=n(29),l=n(0),u=n(7),f=n(44),d=n(279),p={data:null,isLoading:!1,isAllFetched:!1,isRemoving:!1,toRemove:null,error:null,filmsCount:0,playlistsCount:0};function m(t,e){switch(e.type){case"field":return Object(o.a)(Object(o.a)({},t),{},Object(f.a)({},e.fieldName,e.payload));case"initial-success":return Object(o.a)(Object(o.a)({},t),{},{isLoading:!1,isInitialLoaded:!0,isAllFetched:e.filmsCount<d.c&&e.playlistsCount<d.c,filmsCount:t.filmsCount+e.filmsCount,playlistsCount:t.playlistsCount+e.playlistsCount,data:Object(c.a)(new Set(e.data))});case"load":return t.isLoading||t.isAllFetched||!t.isInitialLoaded||t.error?t:Object(o.a)(Object(o.a)({},t),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(o.a)(Object(o.a)({},t),{},{isLoading:!1,isAllFetched:e.filmsCount<d.c&&e.playlistsCount<d.c,filmsCount:t.filmsCount+e.filmsCount,playlistsCount:t.playlistsCount+e.playlistsCount,data:Object(c.a)(new Set([].concat(Object(c.a)(t.data),Object(c.a)(e.data))))});case"remove":return Object(o.a)(Object(o.a)({},t),{},{toRemove:e.payload,isRemoving:!0});case"remove-success":return Object(o.a)(Object(o.a)({},t),{},{isRemoving:!1,toRemove:null,data:t.toRemove?t.data.filter((function(e){return e.id!==t.toRemove.id})):t.data});case"change-playlist-privacy-success":return Object(o.a)(Object(o.a)({},t),{},{data:t.data.map((function(t){return t.isPlaylist&&t.id===e.payload.id?Object(o.a)(Object(o.a)({},t),{},{is_public:e.payload.is_public}):t}))});case"clear":return p;default:return t}}var v=n(314),h=n(330),j=n(300),b=n(288),y=n(283),O=n(51),x=n(52),g=n(281),w=n(331),C=n(293),P=n(1);e.default=function(){var t=Object(l.useContext)(O.a),e=t.user,n=t.clearUser,i=Object(l.useContext)(x.a),f=i.showModal,k=i.clear,R=i.removeModalData,N=Object(u.g)(),_=Object(l.useReducer)(m,p),E=Object(s.a)(_,2),L=E[0],F=E[1],M=L.data,I=L.isLoading,S=L.isAllFetched,A=L.isInitialLoaded,T=L.error,U=L.isRemoving,D=L.toRemove,J=L.filmsCount,q=L.playlistsCount,z=Object(l.useCallback)((function(){I||S||!A||T||F({type:"load"})}),[I,S,A,T]);Object(g.a)(z,{triggerOnNoScroll:!0}),Object(l.useEffect)((function(){!e.auth&&e.isInitialLoaded&&(N.replace("".concat("/filmapp-react-frontend/")),N.push("".concat("/filmapp-react-frontend/","login")),n())}),[e,N,n]),Object(l.useEffect)((function(){function t(){return(t=Object(r.a)(a.a.mark((function t(){var e,n,i,r,l,u;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.allSettled([j.a({skipFilms:0,skipPlaylists:0,limit:d.b})]);case 2:e=t.sent,n=Object(s.a)(e,1),i=n[0],r=[],l=[],u=[],"fulfilled"===i.status&&(l=i.value.data.films.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail")})})),u=i.value.data.playlists.map((function(t){var e=t.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.film_id,"/thumbnail"):w.a;return Object(o.a)(Object(o.a)({},t),{},{img:e,isPlaylist:!0})})),r=[].concat(Object(c.a)(r),Object(c.a)(l),Object(c.a)(u))),F({type:"initial-success",data:r,filmsCount:l.length,playlistsCount:u.length});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}F({type:"clear"}),function(){t.apply(this,arguments)}()}),[]),Object(l.useEffect)((function(){function t(){return(t=Object(r.a)(a.a.mark((function t(){var e,n,i,r,l,u;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.allSettled([j.a({skipFilms:J,skipPlaylists:q,limit:d.c})]);case 2:e=t.sent,n=Object(s.a)(e,1),i=n[0],r=[],l=[],u=[],"fulfilled"===i.status&&(l=i.value.data.films.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail")})})),u=i.value.data.playlists.map((function(t){var e=t.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.film_id,"/thumbnail"):w.a;return Object(o.a)(Object(o.a)({},t),{},{img:e,isPlaylist:!0})})),r=[].concat(Object(c.a)(r),Object(c.a)(l),Object(c.a)(u))),F({type:"success",data:r,filmsCount:l.length,playlistsCount:u.length});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}I&&A&&function(){t.apply(this,arguments)}()}),[J,I,q,A]),Object(l.useEffect)((function(){function t(){return(t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!D.isPlaylist){t.next=8;break}return t.next=4,b.d(D.id);case 4:204===t.sent.status&&(F({type:"remove-success"}),k()),t.next=12;break;case 8:return t.next=10,y.e(D.id);case 10:204===t.sent.status&&(F({type:"remove-success"}),k());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))).apply(this,arguments)}U&&R.isRemoving&&D&&R.id===D.id&&R.title===D.title&&R.type===(D.isPlaylist?"playlist":"film")&&function(){t.apply(this,arguments)}()}),[U,R,D,k]);var B=function(t,e){t.stopPropagation(),R.isRemoving||(F({type:"remove",payload:e}),f(e.id,e.isPlaylist?"playlist":"film",e.title))};return Object(P.jsxs)("div",{className:"row mt-5 mx-2",children:[M?M.map((function(t,e){return t.isPlaylist?Object(P.jsx)(h.a,{playlist:t,index:e,isProfile:!0,dispatchPrivacyUpdate:F,handleRedirect:function(){return function(t){t.film_id&&N.push({pathname:"".concat("/filmapp-react-frontend/","film/")+t.film_id,search:"?list=".concat(t.id)})}(t)},handleRemove:function(e){return B(e,t)}},t.id):Object(P.jsx)(v.a,{isProfile:!0,film:t,index:e,handleRedirect:function(){return e=t.id,void N.push({pathname:"".concat("/filmapp-react-frontend/","film/")+e});var e},handleRemove:function(e){return B(e,t)}},t.id)})):Object(c.a)(Array(20)).map((function(t,e){return Object(P.jsx)(C.a,{},e)})),!S&&Object(P.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:I&&Object(P.jsx)("div",{className:"spinner-border"})})]})}}}]);
//# sourceMappingURL=9.b583ad11.chunk.js.map