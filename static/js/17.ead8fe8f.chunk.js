(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[17],{519:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var n=a(11),r=a(143),s=a(48),c=a(1),i=a(543),o=a(144),l=a(86),u=a(555),d=a(539),b=a(2),m=function(){var e=Object(c.useContext)(l.a).login,t=Object(n.e)(),a=Object(n.f)(),r=Object(c.useReducer)(u.b,u.a),m=Object(s.a)(r,2),j=m[0],f=j.email,p=j.password,h=j.isSubmitted,g=j.isSending,O=j.isError,v=j.isSuccess,x=j.error,y=m[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("form",{onSubmit:g?null:function(a){if(a.preventDefault(),y({type:"submit"}),f&&p)return y({type:"send"}),Object(o.b)({email:f,password:p}).then((function(a){y({type:"success"}),e(a.data.user.name,a.data.user.id,a.data.token,a.data.refreshToken),setTimeout((function(){return Object(d.b)(t,"/login",!0)}),1e3)})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors),y({type:"error",payload:t}),console.error(e)}))},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{className:"form-label",htmlFor:"email",children:"Email"}),Object(b.jsx)(i.a,{isInvalid:h&&!f,type:"email",name:"email",value:f,onChange:function(e){return y({type:"field",fieldName:"email",payload:e.target.value})}}),Object(b.jsx)("div",{className:"invalid-feedback",children:"Email is required"})]}),Object(b.jsxs)("div",{className:"mt-2",children:[Object(b.jsx)("label",{className:"form-label",htmlFor:"password",children:"Password"}),Object(b.jsx)(i.a,{isInvalid:h&&!p,type:"password",name:"password",value:p,onChange:function(e){return y({type:"field",fieldName:"password",payload:e.target.value})}}),Object(b.jsx)("div",{className:"invalid-feedback",children:"Password is required"})]}),Object(b.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[Object(b.jsx)("button",{disabled:g,type:"submit",className:"btn btn-primary",children:"Login"}),g&&Object(b.jsx)("div",{className:"spinner-grow ml-2"})]})]}),O&&Object(b.jsx)("div",{className:"alert alert-danger mt-2 mb-0",children:x||"Error while logging in."}),v&&Object(b.jsx)("div",{className:"alert alert-success mt-2 mb-0",children:"You are now logged in."}),Object(b.jsx)("button",{onClick:function(){Object(d.b)(t,"/login"),setTimeout((function(){t.push("".concat(a.pathname.slice(0,-5),"register").concat(a.search))}),500)},className:"p-0 mt-2 btn btn-link",children:"Register"}),Object(b.jsx)("div",{className:"col-12 col-sm-12 p-0 m-0 ",children:Object(b.jsx)("button",{type:"button",onClick:function(){Object(d.b)(t,"/login"),setTimeout((function(){t.push("".concat(a.pathname.slice(0,-5),"forgot").concat(a.search))}),500)},className:"p-0 mt-2 btn btn-link",children:"Forgot password?"})})]})};function j(){var e=Object(n.e)();return Object(b.jsx)(r.a,{id:"loginModal",title:"Login",onClose:function(){Object(d.b)(e,"/login")},children:Object(b.jsx)(m,{})})}},539:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));var n=function(e){var t=new Date(Date.parse(e.createdAt));return("0"+t.getDate()).slice(-2)+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getFullYear()).slice(-2)+" o "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)},r=function(e){var t=new Date(Date.parse(e.createdAt)),a=new Date,n=Math.abs(Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())-Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()))/6e4));return n/60>=1?(n/=60)/24>=1?(n/=24)/30>=1?(n/=30)/12>=1?(n/=12,n=Math.floor(n)+" years "):n=Math.floor(n)+" months ":n=Math.floor(n)+" days ":n=Math.floor(n)+" hours ":n=Math.floor(n)+" minutes ",n+="ago"},s=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.location.pathname.split(t)[0],r={pathname:""===n?"/filmapp-react-frontend/":n,search:e.location.search,state:e.location.state};a?e.replace(r):e.push(r)}},543:function(e,t,a){"use strict";var n=a(1),r=a(2);t.a=function(e){var t=e.isInvalid,a=e.onChange,s=e.type,c=e.name,i=e.value,o=e.placeholder,l=void 0===o?"":o,u=Object(n.useRef)(null);return Object(n.useEffect)((function(){u.current&&(t?u.current.classList.add("is-invalid"):u.current.classList.remove("is-invalid"))}),[t]),"textarea"===s?Object(r.jsx)("textarea",{ref:u,className:"form-control",placeholder:l,type:s,name:c,value:i,onChange:a,rows:8}):Object(r.jsx)("input",{ref:u,className:"form-control",placeholder:l,type:s,name:c,value:i,onChange:a})}},555:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c}));var n=a(141),r=a(16),s={email:"",nick:"",password:"",isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},c=function(e,t){switch(t.type){case"field":return Object(r.a)(Object(r.a)({},e),{},Object(n.a)({isSubmitted:!1},t.fieldName,t.payload));case"submit":return Object(r.a)(Object(r.a)({},e),{},{isError:!1,error:null,isSubmitted:!0});case"send":return Object(r.a)(Object(r.a)({},e),{},{isSending:!0});case"success":return Object(r.a)(Object(r.a)({},e),{},{isError:!1,error:null,isSending:!1,isSuccess:!0});case"error":return Object(r.a)(Object(r.a)({},e),{},{isSending:!1,isError:!0,error:t.payload});default:return e}}}}]);
//# sourceMappingURL=17.ead8fe8f.chunk.js.map