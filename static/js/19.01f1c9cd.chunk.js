(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[19],{317:function(e,t,c){"use strict";t.a=c.p+"static/media/image_not_found.c4ba1e76.png"},336:function(e,t,c){"use strict";c.d(t,"a",(function(){return a})),c.d(t,"b",(function(){return n}));var a=function(e){var t=new Date(Date.parse(e.createdAt));return("0"+t.getDate()).slice(-2)+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getFullYear()).slice(-2)+" o "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)},n=function(e){var t=new Date(Date.parse(e.createdAt)),c=new Date,a=Math.abs(Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())-Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()))/6e4));return a/60>=1?(a/=60)/24>=1?(a/=24)/30>=1?(a/=30)/12>=1?(a/=12,a=Math.floor(a)+" years "):a=Math.floor(a)+" months ":a=Math.floor(a)+" days ":a=Math.floor(a)+" hours ":a=Math.floor(a)+" minutes ",a+="ago"}},435:function(e,t,c){"use strict";c.r(t);var a=c(2),n=c(7),i=c(305),s=c.n(i),r=c(270),l=c.n(r),o=c(271),d=c(29),u=c(0),m=c(276),j=c(35),p=c(403),b=c(289),f=c.n(b),h=(c(420),c(44)),O={film:{img:"",video:"",film:"",title:"",views:"",likes:"",dislikes:"",description:"\r\n\n\n"},isLiked:!1,isDisliked:!1,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1};function x(e,t){switch(t.type){case"field":return Object(a.a)(Object(a.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"like":return Object(a.a)(Object(a.a)({},e),{},{isLikeButtonClicked:!0,likeAction:t.payload});case"success":return Object(a.a)(Object(a.a)({},e),{},{film:t.film,isLiked:t.isLiked,isDisliked:t.isDisliked,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});case"error":return Object(a.a)(Object(a.a)({},e),{},{isLikeButtonClicked:!1,likeAction:null});default:return e}}var v=c(281),y=c(294),g=Object(u.createContext)(),w=c(51),N=c(1),k=function(e){var t=Object(n.g)(),c=Object(n.h)(),i=Object(u.useContext)(w.a).user,s=Object(u.useContext)(g),r=Object(d.a)(s,2),b=(r[0],r[1]),h=Object(u.useCallback)((function(e){null!==e&&(b({type:"field",fieldName:"playerHeight",payload:e.getBoundingClientRect().height}),H(e))}),[b]),k=Object(u.useReducer)(x,O),C=Object(d.a)(k,2),F=C[0],R=C[1],L=F.film,E=F.isLiked,D=F.isDisliked,A=F.isLikeButtonClicked,I=F.likeAction,_=F.isDescExpanded,P=Object(u.useState)(null),M=Object(d.a)(P,2),S=M[0],H=M[1];Object(u.useEffect)((function(){if(S){var e=function(){b({type:"field",fieldName:"playerHeight",payload:S.getBoundingClientRect().height})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[S,b]),Object(u.useEffect)((function(){function t(){return(t=Object(o.a)(l.a.mark((function t(){var c,n,s,r,o,u,m,j,p,f,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=[v.c(e.match.params.id),v.g(e.match.params.id)],i.auth&&c.push(y.a({details:!0})),t.next=4,Promise.allSettled(c);case 4:if(n=t.sent,s=Object(d.a)(n,3),r=s[0],o=s[1],u=s[2],"rejected"!==r.status&&"rejected"!==o.status){t.next=12;break}return b({type:"field",fieldName:"error",payload:!0}),t.abrupt("return");case 12:m=r.value.data,b({type:"success",comments:m.comments,commentsCount:m.comments_count}),j=Object(a.a)(Object(a.a)({},m),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/thumbnail?width=poster"),video:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/video"),views:o.value.data.views}),p=!1,f=!1,u&&"fulfilled"===u.status&&(h=u.value.data.details,p=h.liked.indexOf(e.match.params.id)>-1,f=h.disliked.indexOf(e.match.params.id)>-1),R({type:"success",film:j,isLiked:p,isDisliked:f});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.match.params.id,b,i.auth]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var a,n,i,s,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==I){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,v.d(L.id,{action:I});case 5:return a=e.sent,(n=a.data).img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(n.id,"/thumbnail?width=poster"),n.video="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(n.id,"/video"),e.next=11,y.a({details:!0});case 11:i=e.sent,s=i.data.details,r=s.liked.indexOf(n.id)>-1,o=s.disliked.indexOf(n.id)>-1,R({type:"success",film:n,isLiked:r,isDisliked:o}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(2),console.error(e.t0),R({type:"error"}),e.t0.response&&401===e.t0.response.status&&t.push("".concat(c.pathname,"/login"));case 23:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}A&&function(){e.apply(this,arguments)}()}),[L.id,A,I,t,c]);var B=function(e){e.preventDefault(),R({type:"field",fieldName:"isDescExpanded",payload:!_})},T=function(e){A||R({type:"like",payload:e})},Y=function(e){return Object(N.jsx)("span",{children:Object(N.jsx)("button",{className:"btn btn-link p-0 m-0 mb-1 title fw-bold",onClick:B,children:e})})};return Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{className:"col-12 col-sm-12",children:Object(N.jsx)("div",{ref:h,children:Object(N.jsx)(p.Player,{playsInline:!0,poster:L.img,src:L.video})})}),L&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",children:[!L.title&&Object(N.jsx)("p",{className:"fw-bold",children:Object(N.jsx)("br",{})}),Object(N.jsx)("p",{className:"fw-bold",children:L.title})]}),Object(N.jsx)("div",{className:"col-4 col-sm-4 p-0",children:Object(N.jsxs)("p",{children:[Object(N.jsx)(m.a,{icon:j.b})," \u2002",L.views]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4 text-right d-flex justify-content-end",children:Object(N.jsxs)("p",{style:{cursor:"pointer"},className:E?"film-picked-thumb-color":"",onClick:function(){return T("like")},children:[Object(N.jsx)(m.a,{icon:j.k}),"\u2002",L.likes]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4",children:Object(N.jsxs)("p",{style:{cursor:"pointer"},className:D?"film-picked-thumb-color":"",onClick:function(){return T("dislike")},children:[Object(N.jsx)(m.a,{icon:j.j}),"\u2002",L.dislikes]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-4 divider"}),Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",style:{whiteSpace:"pre-line",textAlign:"justify"},children:[Object(N.jsx)(f.a,{line:!_&&2,truncateText:"\u2026",text:L.description,textTruncateChild:Y("Show more")}),_&&Y("Show less")]})]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-2 divider"})]})]})},C=c(27),F=c(277),R={films:null,id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null};function L(e,t){switch(t.type){case"field":return Object(a.a)(Object(a.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return R;case"initial-success":return Object(a.a)(Object(a.a)({},R),{},{films:t.films,id:t.id,isInitialLoaded:!0});case"load":return Object(a.a)(Object(a.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(a.a)(Object(a.a)({},e),{},{films:[].concat(Object(C.a)(e.films),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<F.e});case"error":return Object(a.a)(Object(a.a)({},R),{},{error:t.payload});default:return e}}var E=c(308),D=c(279),A=c(304),I=c.n(A),_=function(){return Object(N.jsx)("div",{className:"row mx-0 mb-4",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsx)("div",{className:"col-6 col-sm-6 m-0 p-0",children:Object(N.jsx)("div",{className:"ratio ratio-16x9",children:Object(N.jsx)(I.a,{className:"w-100 h-100"})})}),Object(N.jsxs)("div",{className:"col-6 col-sm-6 m-0",children:[Object(N.jsx)("div",{className:"row m-0 h-25",children:Object(N.jsx)("div",{className:"col p-0",children:Object(N.jsx)(I.a,{className:"w-100 h-100"})})}),Object(N.jsx)("div",{className:"pt-2 h-75",children:Object(N.jsx)(I.a,{className:"w-100 h-100"})})]})]})})},P=c(290),M=c(288),S=function(e){var t=Object(M.a)(768),c=Object(u.useContext)(g),a=Object(d.a)(c,2),n=a[0],i=a[1],s=Object(u.useReducer)(L,R),r=Object(d.a)(s,2),m=r[0],j=r[1],p=m.films,b=m.isLoading,f=m.isAllFetched,h=m.isInitialLoaded,O=m.id,x=m.error,y=Object(u.useCallback)((function(){b||f||!h||x||!O||j({type:"load"})}),[b,f,h,x,O]);return Object(D.a)(y),Object(u.useEffect)((function(){function t(){return(t=Object(o.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a({exclude:e.match.params.id,limit:F.e}).then((function(t){var c=t.data;c.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),j({type:"initial-success",films:c,id:e.match.params.id})})).catch((function(e){return console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}j({type:"clear"}),n.isPreviewLoaded&&function(){t.apply(this,arguments)}()}),[e.match.params.id,n.isPreviewLoaded]),Object(u.useEffect)((function(){n.error&&j({type:"error",payload:n.error})}),[n.error]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a({exclude:O,skip:p.length,limit:F.e}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),j({type:"success",payload:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b&&p&&O&&function(){e.apply(this,arguments)}()}),[b,O,p]),Object(N.jsxs)("div",{className:"row",children:[p?p.map((function(t,c){return Object(N.jsx)(E.a,{film:t,index:c,isRecommendations:!0,filmDispatch:i,handleRedirect:function(){return e.handleRedirect(t.id)}},t.id)})):Object(C.a)(Array(20)).map((function(e,c){return t?Object(N.jsx)(P.a,{isRecommendations:!0},c):Object(N.jsx)(_,{},c)})),!f&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:b&&!x&&Object(N.jsx)("div",{className:"spinner-border"})})]})},H={comments:null,commentsCount:null,text:"",id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,isAdding:!1,isRemoving:!1,toRemove:null,isSorting:!1,sort:null,sorts:[{id:"created_at",title:"By date",dir:1},{id:"author_name",title:"By author name",dir:1}],error:null};function B(e,t){switch(t.type){case"field":return Object(a.a)(Object(a.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return Object(a.a)(Object(a.a)({},H),{},{id:t.id});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.isAdding||e.error||!e.id||e.isSorting?e:Object(a.a)(Object(a.a)({},e),{},{isLoading:!0});case"initial-success":return Object(a.a)(Object(a.a)({},e),{},{comments:t.comments,commentsCount:t.commentsCount,isAllFetched:t.comments.length<F.a,isInitialLoaded:!0,error:null});case"load-success":return Object(a.a)(Object(a.a)({},e),{},{comments:[].concat(Object(C.a)(e.comments),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<F.a});case"add":return Object(a.a)(Object(a.a)({},e),{},{isAdding:!0,error:null});case"add-success":return Object(a.a)(Object(a.a)({},e),{},{text:"",commentsCount:e.commentsCount+1,comments:[t.payload].concat(Object(C.a)(e.comments)),isAdding:!1});case"remove":return Object(a.a)(Object(a.a)({},e),{},{isRemoving:!0,toRemove:t.payload});case"remove-success":return Object(a.a)(Object(a.a)({},e),{},{isRemoving:!1,toRemove:null,commentsCount:e.commentsCount-1,comments:e.toRemove?e.comments.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"sort":return Object(a.a)(Object(a.a)({},e),{},{comments:null,isAllFetched:!1,sorts:e.sorts.map((function(e){return e.id===t.sortToChange.id?t.sortToChange:e})),sort:t.sort,isSorting:!0});case"sort-success":return Object(a.a)(Object(a.a)({},e),{},{isSorting:!1,comments:t.payload});case"error":return Object(a.a)(Object(a.a)({},e),{},{isAdding:!1,isLoading:!1,isSorting:!1,error:t.payload});default:return e}}var T=c(30),Y=c(84),z=function(e,t){return T.a.get("films/".concat(e,"/comments"),{params:t})},U=function(e){return T.a.delete("comments/".concat(e),{headers:Object(Y.a)()})},J=function(e,t){return T.a.get("films/".concat(e,"/comments/sort"),{params:t,headers:Object(Y.a)()})},W=c(336),q=c(52),G=c(283),K=function(e){var t=Object(u.useContext)(q.a),c=t.showModal,a=t.clear,n=t.removeModalData,i=Object(u.useContext)(w.a).user,s=Object(u.useContext)(g),r=Object(d.a)(s,2),j=r[0],p=r[1],b=Object(u.useReducer)(B,H),f=Object(d.a)(b,2),O=f[0],x=f[1],v=O.comments,y=O.commentsCount,k=O.text,C=O.isInitialLoaded,R=O.isLoading,L=O.isAllFetched,E=O.isAdding,A=O.id,I=O.isRemoving,_=O.toRemove,P=O.isSorting,M=O.sort,S=O.sorts,K=O.error,Q=Object(u.useCallback)((function(){R||L||!C||E||K||!A||P||x({type:"load"})}),[R,L,C,E,K,A,P]);Object(D.a)(Q),Object(u.useEffect)((function(){x({type:"clear",id:e.match.params.id})}),[e.match.params.id]),Object(u.useEffect)((function(){j.error&&x({type:"error",payload:j.error})}),[j.error]),Object(u.useEffect)((function(){j.comments&&null!==j.commentsCount&&x({type:"initial-success",comments:j.comments,commentsCount:j.commentsCount})}),[j.comments,j.commentsCount,p]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(A,{skip:v.length,limit:F.a}).then((function(e){x({type:"load-success",payload:e.data})})).catch((function(e){x({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(A,(t={},Object(h.a)(t,M.id,M.dir),Object(h.a)(t,"skip",v.length),Object(h.a)(t,"limit",F.a),t)).then((function(e){x({type:"load-success",payload:e.data})})).catch((function(e){x({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&C&&!E&&v&&A&&!P&&(M?function(){t.apply(this,arguments)}():function(){e.apply(this,arguments)}())}),[R,E,A,v,C,P,M]),Object(u.useEffect)((function(){E&&!R&&A&&function(){var e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={text:k},e.next=3,(c=A,a=t,T.a.post("films/".concat(c,"/comments"),a,{headers:Object(Y.a)()})).then((function(e){x({type:"add-success",payload:e.data})})).catch((function(e){x({type:"error",payload:e.response.status})}));case 3:case"end":return e.stop()}var c,a}),e)})));return function(){return e.apply(this,arguments)}}()()}),[E,R,A,k]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(_.id).then((function(e){x({type:"remove-success"}),a()})).catch((function(e){a(),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I&&_&&n.isRemoving&&n.id===_.id&&"comment"===n.type&&n.title===_.text.substring(0,10).concat("...")&&function(){e.apply(this,arguments)}()}),[I,_,a,n]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=M?(t={},Object(h.a)(t,M.id,M.dir),Object(h.a)(t,"limit",F.a),t):{},e.next=3,J(A,c).then((function(e){x({type:"sort-success",payload:e.data})})).catch((function(e){x({type:"error",payload:"Sort error."}),console.error(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}P&&function(){e.apply(this,arguments)}()}),[P,M,A]);return Object(N.jsxs)("div",{className:"col",children:[Object(N.jsxs)("div",{className:"row p-0 mt-4 mb-4",children:[Object(N.jsx)("div",{className:"col-7 col-sm-5 col-md-4 d-flex align-items-center ",children:null!==y&&Object(N.jsxs)("span",{children:[y,1===y?" comment":" comments"," "]})}),Object(N.jsxs)("div",{className:"dropdown col-2 col-sm-2",children:[Object(N.jsx)("button",{className:"btn btn-secondary dropdown-toggle",id:"sortDropDown","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Sort"}),Object(N.jsx)("ul",{className:"dropdown-menu","aria-labelledby":"#sortDropDown",children:S.map((function(e){return Object(N.jsx)("li",{onClick:function(t){return function(e,t){e.preventDefault();var c=null;switch(t){case"created_at":c=S[0];break;case"author_name":c=S[1];break;default:return}var a=null;M&&M.id===c.id?(c.dir*=-1,a=c,1===c.dir&&(a=null)):a=c,x({type:"sort",sortToChange:c,sort:a})}(t,e.id)},children:Object(N.jsxs)("a",{className:"dropdown-item".concat(M&&e.id===M.id?" active":""),href:"#",role:"button",children:[e.title,M&&M.id===e.id&&1===e.dir?Object(N.jsx)(m.a,{className:"ms-2",icon:"sort-up"}):M&&M.id===e.id&&-1===e.dir?Object(N.jsx)(m.a,{className:"ms-2",icon:"sort-down"}):""]})},e.id)}))})]})]}),Object(N.jsxs)("form",{onSubmit:function(e){return k&&!E?function(e){e.preventDefault(),x({type:"add"})}(e):null},children:[Object(N.jsx)("div",{id:"fiordur",children:Object(N.jsx)("input",{type:"text",placeholder:"Comment",value:k,onChange:function(e){return x({type:"field",fieldName:"text",payload:e.target.value})}})}),Object(N.jsx)("div",{className:"col d-flex justify-content-end",children:Object(N.jsx)("button",{disabled:E||!k,type:"submit",className:"btn btn-primary mt-3",children:"Submit"})})]}),E&&Object(N.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:Object(N.jsx)("div",{className:"spinner-border"})}),v&&v.map((function(e){return Object(N.jsxs)("div",{className:"col col-sm-12 p-0 mt-4 remove-container",children:[Object(N.jsxs)("div",{className:"d-flex",children:[Object(N.jsx)("p",{className:"m-0 fw-bold",children:Object(N.jsxs)("small",{className:"m-0 fw-bold",children:[e.author_name,"\xa0"]})}),Object(N.jsx)("p",{children:Object(N.jsx)("small",{className:"m-0",children:Object(W.a)(e)})}),i.id===e.author_id&&Object(N.jsx)(G.a,{className:"m-button cursor-pointer button-ripple-24 d-flex justify-content-center align-items-center remove-holder p-0 m-0 ms-auto",onClick:function(){return function(e){n.isRemoving||(x({type:"remove",payload:e}),c(e.id,"comment",e.text.substring(0,10).concat("...")))}(e)},children:Object(N.jsx)(m.a,{icon:"trash-alt"})})]}),Object(N.jsx)("p",{className:"d-block d-sm-block",children:Object(N.jsx)("small",{children:e.text})})]},e.id)})),!L&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:(R||P)&&!K&&Object(N.jsx)("div",{className:"spinner-border"})})]})},Q=c(421),V=c.n(Q),X=(c(424),{playlist:null,currentFilm:null,currentFilmIndex:0,isLoading:!1,isRemovingPlaylist:!1,isRemovingFilm:!1,removingFilmId:null,headerHeight:null,playerHeight:null}),Z=function(e,t){switch(t.type){case"field":return Object(a.a)(Object(a.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,playlist:t.playlist,currentFilm:t.currentFilm,currentFilmIndex:t.currentFilmIndex});case"clear":return X;case"remove-film":return Object(a.a)(Object(a.a)({},e),{},{removingFilmId:t.payload,isRemovingFilm:!0});case"remove-film-success":if(!e.removingFilmId)return Object(a.a)(Object(a.a)({},e),{},{isRemovingFilm:!1});var c=e.playlist.films.filter((function(t){return t.id!==e.removingFilmId}));return Object(a.a)(Object(a.a)({},e),{},{currentFilm:e.removingFilmId===e.currentFilm?null:e.currentFilm,currentFilmIndex:e.removingFilmId===e.currentFilm?0:c.findIndex((function(t){return t.id===e.currentFilm}))+1,playlist:Object(a.a)(Object(a.a)({},e.playlist),{},{films:c}),isRemovingFilm:!1});case"change-playlist-privacy-success":return Object(a.a)(Object(a.a)({},e),{},{playlist:Object(a.a)(Object(a.a)({},e.playlist),{},{is_public:t.payload.is_public})});case"error":return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}},$=c(299),ee=c(285),te=c(296),ce=c(295),ae=c(317),ne=function(e){var t=Object(u.useContext)(q.a),c=t.showModal,a=t.clear,i=t.removeModalData,r=Object(n.h)(),j=Object(u.useContext)(w.a).user,p=Object(u.useContext)(g),b=Object(d.a)(p,2),h=b[0],O=b[1],x=Object(u.useReducer)(Z,X),v=Object(d.a)(x,2),y=v[0],k=v[1],C=y.playlist,F=y.isRemovingPlaylist,R=y.isRemovingFilm,L=y.removingFilmId,E=y.currentFilm,D=y.currentFilmIndex,A=y.headerHeight,I=y.playerHeight,_=y.error,P=function(){k({type:"clear"})},M=Object(u.useCallback)((function(e){null!==e&&k({type:"field",fieldName:"headerHeight",payload:e.getBoundingClientRect().height})}),[]);Object(u.useEffect)((function(){k({type:"field",fieldName:"playerHeight",payload:h.playerHeight})}),[h.playerHeight]),Object(u.useEffect)((function(){k({type:"error",payload:h.error})}),[h.error]),Object(u.useEffect)((function(){function t(){return(t=Object(o.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee.b(C.id).then((function(t){var c=0,a=null;return Array.prototype.forEach.call(t.data.films,(function(t,n){t&&t.id===e.match.params.id&&(c=n+1,a=t.id)})),k({type:"success",playlist:t.data,currentFilm:a,currentFilmIndex:c}),O({type:"field",fieldName:"reloadPlaylist",payload:!1}),t.data})).catch((function(e){console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}h.reloadPlaylist&&C&&function(){t.apply(this,arguments)}()}),[h.reloadPlaylist,C,O,e.match.params.id]),Object(u.useEffect)((function(){var t=s.a.parse(r.search);function c(){return(c=Object(o.a)(l.a.mark((function c(){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ee.b(t.list).then((function(t){var c=0,a=null;return Array.prototype.forEach.call(t.data.films,(function(t,n){t&&t.id===e.match.params.id&&(c=n+1,a=t.id)})),k({type:"success",playlist:t.data,currentFilm:a,currentFilmIndex:c}),t.data})).catch((function(e){console.error(e),P()}));case 2:case"end":return c.stop()}}),c)})))).apply(this,arguments)}t.list?!_&&h.isPreviewLoaded&&function(){c.apply(this,arguments)}():P()}),[e.match.params.id,r.search,_,h.isPreviewLoaded]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.d(C.id).then((function(e){P(),a()})).catch((function(e){console.error(e),a()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}F&&i.isRemoving&&i.id===C.id&&"playlist"===i.type&&i.title===C.title&&function(){e.apply(this,arguments)}()}),[a,F,C,i]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.c(C.id,{films_id:[L],is_remove_films:!0}).then((function(e){k({type:"remove-film-success"})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&function(){e.apply(this,arguments)}()}),[R,C,L]);return C&&I&&!_&&Object(N.jsx)("div",{className:"col mb-4",children:Object(N.jsxs)("div",{className:"col p-0 border",children:[Object(N.jsx)("div",{ref:M,style:{height:A+"px"},className:"col remove-container pt-2 pb-2 film-preview-playlist-header",sm:12,children:Object(N.jsxs)("div",{className:"row m-0 px-2",children:[Object(N.jsx)("div",{className:"button-ripple-div-next-width colbutton-ripple-div-next-width",children:Object(N.jsx)("p",{className:"mb-1 fw-bold film-preview-playlist-text-truncate",children:C.title})}),Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 justify-content-end d-flex",children:j.id===C.author_id&&Object(N.jsx)(te.a,{handleRemove:function(){i.isRemoving||(k({type:"field",fieldName:"isRemovingPlaylist",payload:!0}),c(C.id,"playlist",C.title))}})}),Object(N.jsxs)("div",{className:"col-12 col-sm-12",children:[j.id===C.author_id&&Object(N.jsx)(ce.a,{id:C.id,isPublic:C.is_public,isProfile:!1,dispatchPrivacyUpdate:k}),j.id===C.author_id&&Object(N.jsx)("small",{children:"\xa0"}),Object(N.jsxs)("small",{children:[C.author_name,"\xa0"]}),Object(N.jsxs)("small",{className:"film-preview-playlist-index",children:["- ",D,"/",C.films.length]})]})]})}),Object(N.jsx)("div",{style:{height:I-A+"px"},className:"col-12 col-sm-12 p-0 film-preview-playlist-container",children:Object(N.jsx)(V.a,{onYReachEnd:function(){},onScrollY:function(){},children:C.films.map((function(t,c){return Object(N.jsxs)("div",{className:"row m-0 p-0 pe-2 remove-container",children:[Object(N.jsx)("div",{className:"".concat(c===C.films.length-1?"mt-3 mb-3 ":"mt-3"," button-ripple-div-next-width col"),onClick:function(){t.isNonExisting||e.handleRedirect(t.id)},children:Object(N.jsxs)("div",{className:"row m-0 p-0 play-outer-container",children:[Object(N.jsx)("div",{className:"col-1 col-sm-1 text-center justify-content-center d-flex align-items-center p-0 ps-1",children:E===t.id?Object(N.jsx)("small",{children:Object(N.jsx)(m.a,{style:{fontWeight:300},icon:"play"})}):Object(N.jsx)("small",{children:c+1})}),Object(N.jsx)("div",{className:"col-6 col-sm-6 pe-2 ps-2",children:Object(N.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half w-100 play-container",children:t.isNonExisting?Object(N.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:ae.a}):Object(N.jsx)($.a,{image:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail")})})}),Object(N.jsx)("div",{className:"col-5 col-sm-5 p-0",children:t.isNonExisting?Object(N.jsx)(f.a,{line:2,text:"Not found",className:"mb-0 title fw-bold"}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(f.a,{line:1,text:t.title,className:"mb-0 title fw-bold"}),Object(N.jsx)("p",{className:"mb-1 author-nick",children:Object(N.jsx)("span",{children:t.author_name})})]})})]})}),j.id===C.author_id&&Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 d-flex align-items-center justify-content-center",children:Object(N.jsx)(te.a,{handleRemove:function(){return e=t.id,void(R||k({type:"remove-film",payload:e}));var e}})})]},t.id)}))})})]})})},ie={isPreviewLoaded:!1,comments:null,commentsCount:null,playerHeight:null,reloadPlaylist:!1,error:null},se=function(e,t){switch(t.type){case"field":return Object(a.a)(Object(a.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(a.a)(Object(a.a)({},e),{},{isPreviewLoaded:!0,comments:t.comments,commentsCount:t.commentsCount,error:null});case"reset-comments":return Object(a.a)(Object(a.a)({},e),{},{comments:null,commentsCount:null});default:return e}},re=function(e){var t=e.children,c=Object(u.useReducer)(se,ie),a=Object(d.a)(c,2),n=a[0],i=a[1];return Object(N.jsx)(g.Provider,{value:[n,i],children:t})};c(297),t.default=function(e){var t=Object(n.g)(),c=Object(n.h)(),i=Object(M.a)(768),r=function(e){var n=s.a.parse(c.search),i={pathname:"".concat("/filmapp-react-frontend/","film/")+e};n.list&&(i=Object(a.a)(Object(a.a)({},i),{},{search:"?list=".concat(n.list)})),t.push(i)};return Object(N.jsx)(re,{children:Object(N.jsxs)("div",{className:"row p-0 m-0 mt-4 mx-2",children:[Object(N.jsxs)("div",{className:"col-12 order-first col-sm-12 order-first col-md-8",children:[Object(N.jsx)(k,Object(a.a)({},e)),!i&&Object(N.jsx)(K,Object(a.a)({},e))]}),Object(N.jsxs)("div",{className:"col-12 order-2 col-sm-12 order-2 col-md-4",children:[Object(N.jsx)(ne,Object(a.a)({handleRedirect:r},e)),Object(N.jsx)(S,Object(a.a)({handleRedirect:r},e))]}),i&&Object(N.jsx)("div",{className:"col-12 order-last col-sm-12 order-sm-last col-md-8 pb-5",children:Object(N.jsx)(K,Object(a.a)({},e))})]})})}}}]);
//# sourceMappingURL=19.01f1c9cd.chunk.js.map