(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[19],{513:function(e,t,c){"use strict";c.r(t);var n=c(15),i=c(7),a=c(569),s=c.n(a),r=c(528),l=c.n(r),o=c(529),d=c(46),u=c(1),m=c(536),p=c(45),j=c(668),f=c(552),b=c.n(f),h=(c(685),c(137)),O={film:{img:"",video:"",film:"",title:"",views:"",likes:"",dislikes:"",description:"\r\n\n\n"},isLiked:!1,isDisliked:!1,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1};function x(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"like":return Object(n.a)(Object(n.a)({},e),{},{isLikeButtonClicked:!0,likeAction:t.payload});case"success":return Object(n.a)(Object(n.a)({},e),{},{film:t.film,isLiked:t.isLiked,isDisliked:t.isDisliked,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});case"error":return Object(n.a)(Object(n.a)({},e),{},{isLikeButtonClicked:!1,likeAction:null});default:return e}}var v=c(543),y=c(557),g=Object(u.createContext)(),w=c(81),N=(c(582),c(2)),k=function(){var e=Object(i.g)(),t=Object(i.h)(),c=Object(i.i)().id,a=Object(u.useContext)(w.a).user,s=Object(u.useContext)(g),r=Object(d.a)(s,2),f=(r[0],r[1]),h=Object(u.useCallback)((function(e){null!==e&&(f({type:"field",fieldName:"playerHeight",payload:e.getBoundingClientRect().height}),H(e))}),[f]),k=Object(u.useReducer)(x,O),C=Object(d.a)(k,2),F=C[0],L=C[1],R=F.film,E=F.isLiked,D=F.isDisliked,A=F.isLikeButtonClicked,I=F.likeAction,_=F.isDescExpanded,P=Object(u.useState)(null),M=Object(d.a)(P,2),S=M[0],H=M[1];Object(u.useEffect)((function(){if(S){var e=function(){f({type:"field",fieldName:"playerHeight",payload:S.getBoundingClientRect().height})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[S,f]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t,i,s,r,o,u,m,p,j,b,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[v.i(c),v.c(c)],a.auth&&t.push(y.a({details:!0})),e.next=4,Promise.allSettled(t);case 4:if(i=e.sent,s=Object(d.a)(i,3),r=s[0],o=s[1],u=s[2],"rejected"!==o.status&&"rejected"!==r.status){e.next=12;break}return f({type:"field",fieldName:"error",payload:!0}),e.abrupt("return");case 12:m=o.value.data,f({type:"success"}),p=Object(n.a)(Object(n.a)({},m),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/thumbnail?width=poster"),video:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(m.id,"/video"),views:r.value.data.views}),j=!1,b=!1,u&&"fulfilled"===u.status&&(h=u.value.data.details,j=h.liked.indexOf(c)>-1,b=h.disliked.indexOf(c)>-1),L({type:"success",film:p,isLiked:j,isDisliked:b});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c,f,a.auth,e.location.state]),Object(u.useEffect)((function(){function c(){return(c=Object(o.a)(l.a.mark((function c(){var n,i,a,s,r,o;return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(null!==I){c.next=2;break}return c.abrupt("return");case 2:return c.prev=2,c.next=5,v.e(R.id,{action:I});case 5:return n=c.sent,(i=n.data).img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(i.id,"/thumbnail?width=poster"),i.video="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(i.id,"/video"),c.next=11,y.a({details:!0});case 11:a=c.sent,s=a.data.details,r=s.liked.indexOf(i.id)>-1,o=s.disliked.indexOf(i.id)>-1,L({type:"success",film:i,isLiked:r,isDisliked:o}),c.next=23;break;case 18:c.prev=18,c.t0=c.catch(2),console.error(c.t0),L({type:"error"}),c.t0.response&&401===c.t0.response.status&&e.push("".concat(t.pathname,"/login"));case 23:case"end":return c.stop()}}),c,null,[[2,18]])})))).apply(this,arguments)}A&&function(){c.apply(this,arguments)}()}),[R.id,A,I,e,t]);var B=function(e){e.preventDefault(),L({type:"field",fieldName:"isDescExpanded",payload:!_})},T=function(e){A||L({type:"like",payload:e})},Y=function(e){return Object(N.jsx)("span",{children:Object(N.jsx)("button",{className:"btn btn-link p-0 m-0 mb-1 title font-weight-bold",onClick:B,children:e})})};return Object(N.jsxs)("div",{className:"p-0",children:[Object(N.jsx)("div",{className:"col-12 col-sm-12 preview-margins p-0",children:Object(N.jsx)("div",{ref:h,children:Object(N.jsx)(j.Player,{playsInline:!0,poster:R.img,src:R.video})})}),R&&Object(N.jsxs)("div",{className:"px-0",children:[Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 p-0",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",children:[!R.title&&Object(N.jsx)("p",{className:"font-weight-bold",children:Object(N.jsx)("br",{})}),Object(N.jsx)("p",{className:"font-weight-bold",children:R.title})]}),Object(N.jsx)("div",{className:"col-4 col-sm-4 p-0",children:Object(N.jsxs)("p",{children:[Object(N.jsx)(m.a,{icon:p.c})," \u2002",R.views]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4 text-right d-flex justify-content-end",children:Object(N.jsxs)("p",{className:"".concat(E?"film-picked-thumb-color":""," cursor-pointer noselect"),onClick:function(){return T("like")},children:[Object(N.jsx)(m.a,{icon:p.l}),"\u2002",R.likes]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4 d-flex justify-content-start",children:Object(N.jsxs)("p",{className:"".concat(D?"film-picked-thumb-color":""," cursor-pointer noselect"),onClick:function(){return T("dislike")},children:[Object(N.jsx)(m.a,{icon:p.k}),"\u2002",R.dislikes]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-4 divider"}),Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",style:{whiteSpace:"pre-line",textAlign:"justify"},children:[Object(N.jsx)(b.a,{line:!_&&2,truncateText:"\u2026",text:R.description,textTruncateChild:Y("Show more")}),_&&Y("Show less")]})]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-2 divider p-0"})]})]})},C=c(542),F=c(539),L={films:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null};function R(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return L;case"initial-success":return Object(n.a)(Object(n.a)({},L),{},{films:t.films,isInitialLoaded:!0});case"load":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(n.a)(Object(n.a)({},e),{},{films:[].concat(Object(C.a)(e.films),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<F.e});case"error":return Object(n.a)(Object(n.a)({},L),{},{error:t.payload});default:return e}}var E=c(572),D=c(544),A=c(568),I=c.n(A),_=function(){return Object(N.jsx)("div",{className:"col-12 mx-0 mb-4 container-px",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsx)("div",{className:"col-6 col-sm-6 m-0 p-0",children:Object(N.jsx)("div",{className:"embed-responsive embed-responsive-16by9 p-0",children:Object(N.jsx)(I.a,{className:"embed-responsive-item w-100 h-100 p-0"})})}),Object(N.jsxs)("div",{className:"col-6 col-sm-6 m-0",children:[Object(N.jsx)("div",{className:"row m-0 h-25",children:Object(N.jsx)("div",{className:"col p-0 w-100 h-100",children:Object(N.jsx)(I.a,{className:"w-100 h-100 line-height-unset"})})}),Object(N.jsx)("div",{className:"pt-2 h-75",children:Object(N.jsx)(I.a,{className:"w-100 h-100 line-height-unset"})})]})]})})},P=c(553),M=c(551),S=function(e){var t=e.handleRedirect,c=Object(i.i)().id,n=Object(M.a)(768),a=Object(u.useContext)(g),s=Object(d.a)(a,2),r=s[0],m=s[1],p=Object(u.useReducer)(R,L),j=Object(d.a)(p,2),f=j[0],b=j[1],h=f.films,O=f.isLoading,x=f.isAllFetched,y=f.isInitialLoaded,w=f.error,k=Object(u.useCallback)((function(){O||x||!y||w||!c||b({type:"load"})}),[O,x,y,w,c]);return Object(D.a)(k),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a({exclude:c,limit:F.e,preview:!0}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),b({type:"initial-success",films:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b({type:"clear"}),r.isPreviewLoaded&&function(){e.apply(this,arguments)}()}),[c,r.isPreviewLoaded]),Object(u.useEffect)((function(){r.error&&b({type:"error",payload:r.error})}),[r.error]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a({exclude:c,skip:h.length,limit:F.e,preview:!0}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),b({type:"success",payload:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}O&&h&&c&&function(){e.apply(this,arguments)}()}),[O,c,h]),Object(N.jsxs)("div",{className:"row m-0",children:[h?h.map((function(e,c){return Object(N.jsx)(E.a,{film:e,index:c,isRecommendations:!0,filmDispatch:m,handleRedirect:function(){return t(e)}},e.id)})):Object(C.a)(Array(20)).map((function(e,t){return n?Object(N.jsx)(P.a,{isRecommendations:!0},t):Object(N.jsx)(_,{},t)})),!x&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:O&&!w&&Object(N.jsx)("div",{className:"spinner-border"})})]})},H={comments:null,commentsCount:null,text:"",isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,isAdding:!1,isRemoving:!1,toRemove:null,isSorting:!1,sort:null,sorts:[{id:"created_at",title:"By date",dir:1},{id:"author_name",title:"By author name",dir:1}],error:null};function B(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return Object(n.a)({},H);case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.isAdding||e.error||e.isSorting?e:Object(n.a)(Object(n.a)({},e),{},{isLoading:!0});case"initial-success":return Object(n.a)(Object(n.a)({},e),{},{comments:t.comments,commentsCount:t.commentsCount,isAllFetched:t.comments.length<F.a,isInitialLoaded:!0,error:null});case"load-success":return Object(n.a)(Object(n.a)({},e),{},{comments:[].concat(Object(C.a)(e.comments),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<F.a});case"add":return Object(n.a)(Object(n.a)({},e),{},{isAdding:!0,error:null});case"add-success":return Object(n.a)(Object(n.a)({},e),{},{text:"",commentsCount:e.commentsCount+1,comments:[t.payload].concat(Object(C.a)(e.comments)),isAdding:!1});case"remove":return Object(n.a)(Object(n.a)({},e),{},{isRemoving:!0,toRemove:t.payload});case"remove-success":return Object(n.a)(Object(n.a)({},e),{},{isRemoving:!1,toRemove:null,commentsCount:e.commentsCount-1,comments:e.toRemove?e.comments.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"sort":return Object(n.a)(Object(n.a)({},e),{},{comments:null,isAllFetched:!1,sorts:e.sorts.map((function(e){return e.id===t.sortToChange.id?t.sortToChange:e})),sort:t.sort,isSorting:!0});case"sort-success":return Object(n.a)(Object(n.a)({},e),{},{isSorting:!1,comments:t.payload});case"error":return Object(n.a)(Object(n.a)({},e),{},{isAdding:!1,isLoading:!1,isSorting:!1,error:t.payload});default:return e}}var T=c(42),Y=c(138),U=function(e,t){return T.a.get("films/".concat(e,"/comments"),{params:t})},z=function(e){return T.a.delete("comments/".concat(e),{headers:Object(Y.a)()})},J=function(e,t){return T.a.get("films/".concat(e,"/comments/sort"),{params:t,headers:Object(Y.a)()})},W=c(540),q=c(82),G=c(545),K=function(){var e=Object(i.i)().id,t=Object(u.useContext)(q.a),c=t.showModal,n=t.clear,a=t.removeModalData,s=Object(u.useContext)(w.a).user,r=Object(u.useContext)(g),p=Object(d.a)(r,2),j=p[0],f=(p[1],Object(u.useReducer)(B,H)),b=Object(d.a)(f,2),O=b[0],x=b[1],y=O.comments,k=O.commentsCount,C=O.text,L=O.isInitialLoaded,R=O.isLoading,E=O.isAllFetched,A=O.isAdding,I=O.isRemoving,_=O.toRemove,P=O.isSorting,M=O.sort,S=O.sorts,K=O.error,Q=Object(u.useCallback)((function(){R||E||!L||A||K||!e||P||x({type:"load"})}),[R,E,L,A,K,e,P]);Object(D.a)(Q),Object(u.useEffect)((function(){j.error&&x({type:"error",payload:j.error})}),[j.error]),Object(u.useEffect)((function(){var t=function(){var t=Object(o.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.d(e).then((function(e){x({type:"initial-success",comments:e.data.comments,commentsCount:e.data.comments_count})})).catch((function(e){console.error(e),x({type:"error",payload:"Something went wrong!"})}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();j.isPreviewLoaded&&t()}),[e,j.isPreviewLoaded]),Object(u.useEffect)((function(){function t(){return(t=Object(o.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U(e,{skip:y.length,limit:F.a}).then((function(e){x({type:"load-success",payload:e.data})})).catch((function(e){x({type:"error"})}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function c(){return(c=Object(o.a)(l.a.mark((function t(){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J(e,(c={},Object(h.a)(c,M.id,M.dir),Object(h.a)(c,"skip",y.length),Object(h.a)(c,"limit",F.a),c)).then((function(e){x({type:"load-success",payload:e.data})})).catch((function(e){x({type:"error"})}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}R&&L&&!A&&y&&e&&!P&&(M?function(){c.apply(this,arguments)}():function(){t.apply(this,arguments)}())}),[R,A,e,y,L,P,M]),Object(u.useEffect)((function(){A&&!R&&e&&function(){var t=Object(o.a)(l.a.mark((function t(){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={text:C},t.next=3,(n=e,i=c,T.a.post("films/".concat(n,"/comments"),i,{headers:Object(Y.a)()})).then((function(e){x({type:"add-success",payload:e.data})})).catch((function(e){x({type:"error",payload:e.response.status})}));case 3:case"end":return t.stop()}var n,i}),t)})));return function(){return t.apply(this,arguments)}}()()}),[A,R,e,C]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(_.id).then((function(e){x({type:"remove-success"}),n()})).catch((function(e){n(),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I&&_&&a.isRemoving&&a.id===_.id&&"comment"===a.type&&a.title===_.text.substring(0,10).concat("...")&&function(){e.apply(this,arguments)}()}),[I,_,n,a]),Object(u.useEffect)((function(){function t(){return(t=Object(o.a)(l.a.mark((function t(){var c,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=M?(c={},Object(h.a)(c,M.id,M.dir),Object(h.a)(c,"limit",F.a),c):{},t.next=3,J(e,n).then((function(e){x({type:"sort-success",payload:e.data})})).catch((function(e){x({type:"error",payload:"Sort error."}),console.error(e)}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}P&&function(){t.apply(this,arguments)}()}),[P,M,e]);return Object(N.jsxs)("div",{className:"col p-0",children:[Object(N.jsxs)("div",{className:"row p-0 mt-4 mb-4",children:[Object(N.jsx)("div",{className:"col-7 col-sm-5 col-md-4 d-flex align-items-center ",children:null!==k&&Object(N.jsxs)("span",{children:[k,1===k?" comment":" comments"," "]})}),Object(N.jsxs)("div",{className:"dropdown col-2 col-sm-2",children:[Object(N.jsx)("button",{className:"btn btn-secondary dropdown-toggle",id:"sortDropDown","data-toggle":"dropdown","aria-expanded":"false",children:"Sort"}),Object(N.jsx)("ul",{className:"dropdown-menu","aria-labelledby":"#sortDropDown",children:S.map((function(e){return Object(N.jsx)("li",{onClick:function(t){return function(e,t){e.preventDefault();var c=null;switch(t){case"created_at":c=S[0];break;case"author_name":c=S[1];break;default:return}var n=null;M&&M.id===c.id?(c.dir*=-1,n=c,1===c.dir&&(n=null)):n=c,x({type:"sort",sortToChange:c,sort:n})}(t,e.id)},children:Object(N.jsxs)("a",{className:"dropdown-item".concat(M&&e.id===M.id?" active":""),href:"#",role:"button",children:[e.title,M&&M.id===e.id&&1===e.dir?Object(N.jsx)(m.a,{className:"ml-2",icon:"sort-up"}):M&&M.id===e.id&&-1===e.dir?Object(N.jsx)(m.a,{className:"ml-2",icon:"sort-down"}):""]})},e.id)}))})]})]}),Object(N.jsxs)("form",{onSubmit:function(e){return C&&!A?function(e){e.preventDefault(),x({type:"add"})}(e):null},children:[Object(N.jsx)("div",{id:"fiordur",children:Object(N.jsx)("input",{type:"text",placeholder:"Comment",value:C,onChange:function(e){return x({type:"field",fieldName:"text",payload:e.target.value})}})}),Object(N.jsx)("div",{className:"col d-flex justify-content-end",children:Object(N.jsx)("button",{disabled:A||!C,type:"submit",className:"btn btn-primary mt-3",children:"Submit"})})]}),A&&Object(N.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:Object(N.jsx)("div",{className:"spinner-border"})}),y&&y.map((function(e){return Object(N.jsxs)("div",{className:"col col-sm-12 p-0 mt-4 remove-container",children:[Object(N.jsxs)("div",{className:"d-flex",children:[Object(N.jsx)("p",{className:"m-0 font-weight-bold",children:Object(N.jsxs)("small",{className:"m-0 font-weight-bold",children:[e.author_name,"\xa0"]})}),Object(N.jsx)("p",{children:Object(N.jsx)("small",{className:"m-0",children:Object(W.a)(e)})}),s.id===e.author_id&&Object(N.jsx)(G.a,{className:"m-button cursor-pointer button-ripple-24 d-flex justify-content-center align-items-center remove-holder p-0 m-0 ml-auto",onClick:function(){return function(e){a.isRemoving||(x({type:"remove",payload:e}),c(e.id,"comment",e.text.substring(0,10).concat("...")))}(e)},children:Object(N.jsx)(m.a,{icon:"trash-alt"})})]}),Object(N.jsx)("p",{className:"d-block d-sm-block",children:Object(N.jsx)("small",{children:e.text})})]},e.id)})),!E&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:(R||P)&&!K&&Object(N.jsx)("div",{className:"spinner-border"})})]})},Q=c(686),V=c.n(Q),X=(c(689),{playlist:null,currentFilm:null,currentFilmIndex:0,isLoading:!1,isRemovingPlaylist:!1,isRemovingFilm:!1,removingFilmId:null,headerHeight:null,playerHeight:null}),Z=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!1,playlist:t.playlist,currentFilm:t.currentFilm,currentFilmIndex:t.currentFilmIndex});case"clear":return X;case"remove-film":return Object(n.a)(Object(n.a)({},e),{},{removingFilmId:t.payload,isRemovingFilm:!0});case"remove-film-success":if(!e.removingFilmId)return Object(n.a)(Object(n.a)({},e),{},{isRemovingFilm:!1});var c=e.playlist.films.filter((function(t){return t.id!==e.removingFilmId}));return Object(n.a)(Object(n.a)({},e),{},{currentFilm:e.removingFilmId===e.currentFilm?null:e.currentFilm,currentFilmIndex:e.removingFilmId===e.currentFilm?0:c.findIndex((function(t){return t.id===e.currentFilm}))+1,playlist:Object(n.a)(Object(n.a)({},e.playlist),{},{films:c}),isRemovingFilm:!1});case"change-playlist-privacy-success":return Object(n.a)(Object(n.a)({},e),{},{playlist:Object(n.a)(Object(n.a)({},e.playlist),{},{is_public:t.payload.is_public})});case"error":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}},$=c(561),ee=c(547),te=c(559),ce=c(558),ne=c(581),ie=function(e){var t=e.handleRedirect,c=Object(u.useContext)(q.a),n=c.showModal,a=c.clear,r=c.removeModalData,p=Object(i.i)().id,j=Object(i.h)(),f=Object(u.useContext)(w.a).user,h=Object(u.useContext)(g),O=Object(d.a)(h,2),x=O[0],v=O[1],y=Object(u.useReducer)(Z,X),k=Object(d.a)(y,2),C=k[0],F=k[1],L=C.playlist,R=C.isRemovingPlaylist,E=C.isRemovingFilm,D=C.removingFilmId,A=C.currentFilm,I=C.currentFilmIndex,_=C.headerHeight,P=C.playerHeight,M=C.error,S=function(){F({type:"clear"})},H=Object(u.useCallback)((function(e){null!==e&&F({type:"field",fieldName:"headerHeight",payload:e.getBoundingClientRect().height})}),[]);Object(u.useEffect)((function(){F({type:"field",fieldName:"playerHeight",payload:x.playerHeight})}),[x.playerHeight]),Object(u.useEffect)((function(){F({type:"error",payload:x.error})}),[x.error]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.b(L.id).then((function(e){var t=0,c=null;return Array.prototype.forEach.call(e.data.films,(function(e,n){e&&e.id===p&&(t=n+1,c=e.id)})),F({type:"success",playlist:e.data,currentFilm:c,currentFilmIndex:t}),v({type:"field",fieldName:"reloadPlaylist",payload:!1}),e.data})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}x.reloadPlaylist&&L&&function(){e.apply(this,arguments)}()}),[x.reloadPlaylist,L,v,p]),Object(u.useEffect)((function(){var e=s.a.parse(j.search);function t(){return(t=Object(o.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee.b(e.list).then((function(e){var t=0,c=null;return Array.prototype.forEach.call(e.data.films,(function(e,n){e&&e.id===p&&(t=n+1,c=e.id)})),F({type:"success",playlist:e.data,currentFilm:c,currentFilmIndex:t}),e.data})).catch((function(e){console.error(e),S()}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.list?!M&&x.isPreviewLoaded&&function(){t.apply(this,arguments)}():S()}),[p,j.search,M,x.isPreviewLoaded]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.d(L.id).then((function(e){S(),a()})).catch((function(e){console.error(e),a()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&r.isRemoving&&r.id===L.id&&"playlist"===r.type&&r.title===L.title&&function(){e.apply(this,arguments)}()}),[a,R,L,r]),Object(u.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.c(L.id,{films_id:[D],is_remove_films:!0}).then((function(e){F({type:"remove-film-success"})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}E&&function(){e.apply(this,arguments)}()}),[E,L,D]);return L&&P&&!M&&Object(N.jsx)("div",{className:"col mb-4",children:Object(N.jsxs)("div",{className:"col p-0 border",children:[Object(N.jsx)("div",{ref:H,style:{height:_+"px"},className:"col remove-container pt-2 pb-2 film-preview-playlist-header",sm:12,children:Object(N.jsxs)("div",{className:"row m-0 px-2",children:[Object(N.jsx)("div",{className:"button-ripple-div-next-width colbutton-ripple-div-next-width",children:Object(N.jsx)("p",{className:"mb-1 font-weight-bold film-preview-playlist-text-truncate",children:L.title})}),Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 justify-content-end d-flex",children:f.id===L.author_id&&Object(N.jsx)(te.a,{handleRemove:function(){r.isRemoving||(F({type:"field",fieldName:"isRemovingPlaylist",payload:!0}),n(L.id,"playlist",L.title))}})}),Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",children:[f.id===L.author_id&&Object(N.jsx)(ce.a,{id:L.id,isPublic:L.is_public,isPlaylist:!0,dispatchPrivacyUpdate:F}),f.id===L.author_id&&Object(N.jsx)("small",{children:"\xa0"}),Object(N.jsxs)("small",{children:[L.author_name,"\xa0"]}),Object(N.jsxs)("small",{className:"film-preview-playlist-index",children:["- ",I,"/",L.films.length]})]})]})}),Object(N.jsx)("div",{style:{height:P-_+"px"},className:"col-12 col-sm-12 p-0 film-preview-playlist-container",children:Object(N.jsx)(V.a,{onYReachEnd:function(){},onScrollY:function(){},children:L.films.map((function(e,c){return Object(N.jsxs)("div",{className:"row m-0 p-0 pr-2 remove-container",children:[Object(N.jsx)("div",{className:"".concat(c===L.films.length-1?"mt-3 mb-3 ":"mt-3"," button-ripple-div-next-width col"),onClick:function(){e.isNonExisting||t(e)},children:Object(N.jsxs)("div",{className:"row m-0 p-0 play-outer-container",children:[Object(N.jsx)("div",{className:"col-1 col-sm-1 text-center justify-content-center d-flex align-items-center p-0 pl-1",children:A===e.id?Object(N.jsx)("small",{children:Object(N.jsx)(m.a,{style:{fontWeight:300},icon:"play"})}):Object(N.jsx)("small",{children:c+1})}),Object(N.jsx)("div",{className:"col-6 col-sm-6 pr-2 pl-2",children:Object(N.jsx)("div",{className:"w-100 play-container",children:e.isNonExisting?Object(N.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:ne.a}):Object(N.jsx)($.a,{image:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})})}),Object(N.jsx)("div",{className:"col-5 col-sm-5 p-0",children:e.isNonExisting?Object(N.jsx)(b.a,{line:2,text:"Not found",className:"mb-0 title font-weight-bold"}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(b.a,{line:1,text:e.title,className:"mb-0 title font-weight-bold"}),Object(N.jsx)("p",{className:"mb-1 author-nick",children:Object(N.jsx)("span",{children:e.author_name})})]})})]})}),f.id===L.author_id&&Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 d-flex align-items-center justify-content-center",children:Object(N.jsx)(te.a,{handleRemove:function(){return function(e){E||F({type:"remove-film",payload:e})}(e.id)}})})]},e.id)}))})})]})})},ae={isPreviewLoaded:!1,playerHeight:null,reloadPlaylist:!1,error:null},se=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(n.a)(Object(n.a)({},e),{},{isPreviewLoaded:!0,error:null});default:return e}},re=function(e){var t=e.children,c=Object(u.useReducer)(se,ae),n=Object(d.a)(c,2),i=n[0],a=n[1];return Object(N.jsx)(g.Provider,{value:[i,a],children:t})};c(567),t.default=function(){var e=Object(i.g)(),t=Object(i.h)(),c=Object(M.a)(768),a=function(c){var i=s.a.parse(t.search),a={pathname:"".concat("/filmapp-react-frontend/","film/")+c.id,state:{film:c}};i.list&&(a=Object(n.a)(Object(n.a)({},a),{},{search:"?list=".concat(i.list)})),e.push(a)};return Object(N.jsx)(re,{children:Object(N.jsxs)("div",{className:"row p-0 m-0 mt-4 mx-2",children:[Object(N.jsxs)("div",{className:"col-12 order-first col-sm-12 order-first col-md-8 film-preview-container-px",children:[Object(N.jsx)(k,{}),!c&&Object(N.jsx)(K,{})]}),Object(N.jsxs)("div",{className:"col-12 order-2 col-sm-12 order-2 col-md-4 p-0",children:[Object(N.jsx)(ie,{handleRedirect:a}),Object(N.jsx)(S,{handleRedirect:a})]}),c&&Object(N.jsx)("div",{className:"col-12 order-last col-sm-12 order-sm-last col-md-8 pb-5 container-px",children:Object(N.jsx)(K,{})})]})})}},540:function(e,t,c){"use strict";c.d(t,"a",(function(){return n})),c.d(t,"c",(function(){return i})),c.d(t,"b",(function(){return a}));var n=function(e){var t=new Date(Date.parse(e.createdAt));return("0"+t.getDate()).slice(-2)+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getFullYear()).slice(-2)+" o "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)},i=function(e){var t=new Date(Date.parse(e.createdAt)),c=new Date,n=Math.abs(Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())-Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()))/6e4));return n/60>=1?(n/=60)/24>=1?(n/=24)/30>=1?(n/=30)/12>=1?(n/=12,n=Math.floor(n)+" years "):n=Math.floor(n)+" months ":n=Math.floor(n)+" days ":n=Math.floor(n)+" hours ":n=Math.floor(n)+" minutes ",n+="ago"},a=function(e,t){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.location.pathname.split(t)[0],i={pathname:""===n?"/filmapp-react-frontend/":n,search:e.location.search,state:e.location.state};c?e.replace(i):e.push(i)}},581:function(e,t,c){"use strict";t.a=c.p+"static/media/image_not_found.c4ba1e76.png"}}]);
//# sourceMappingURL=19.bac51b47.chunk.js.map