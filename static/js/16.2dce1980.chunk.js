(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[16],{519:function(e,t,a){"use strict";a.r(t);var n=a(15),r=a(528),s=a.n(r),c=a(529),i=a(60),l=a(1),o=a(7),u=a(80),d=a(137),m={name:"",email:""},p=Object(n.a)(Object(n.a)({},m),{},{password:"",initialUser:m,isInitialLoaded:!1,isSubmitted:!1,isSending:!1,error:"",success:""}),f=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(d.a)({error:""},t.fieldName,t.payload));case"initial-success":return Object(n.a)(Object(n.a)({},e),{},{initialUser:{email:t.email,name:t.name},isInitialLoaded:!0});case"submit":return Object(n.a)(Object(n.a)({},e),{},{isSubmitted:!0,error:null});case"send":return Object(n.a)(Object(n.a)({},e),{},{isSending:!0});case"success":return Object(n.a)(Object(n.a)({},e),{},{isSubmitted:!1,isSending:!1,success:"Changes saved successfully!",error:null});case"error":return Object(n.a)(Object(n.a)({},e),{},{isSending:!1,isSubmitted:!1,error:t.payload});default:return e}},b=a(552),j=a(139),h=a(2);t.default=function(){var e=Object(l.useContext)(u.a),t=e.user,a=e.clearUser,r=e.updateUser,d=Object(o.g)(),m=Object(o.h)(),O=Object(l.useReducer)(f,p),v=Object(i.a)(O,2),y=v[0],g=v[1],x=y.email,w=y.name,N=y.password,S=y.initialUser,C=(y.isSubmitted,y.isSending),k=y.isInitialLoaded,E=y.success,U=y.error;Object(l.useEffect)((function(){!t.auth&&t.isInitialLoaded&&(d.replace("".concat("/filmapp-react-frontend/")),d.push("".concat("/filmapp-react-frontend/","login")),a())}),[t,d,a]),Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a().then((function(e){g({type:"initial-success",name:e.data.name,email:e.data.email})})).catch((function(e){console.error(e),g({type:"error",payload:!0})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},N&&(t={password:N}),x&&""!==x&&x!==S.email&&(t=Object(n.a)(Object(n.a)({},t),{},{email:x})),w&&""!==w&&w!==S.name&&(t=Object(n.a)(Object(n.a)({},t),{},{name:w})),e.next=6,b.b(t).then((function(e){g({type:"success"}),setTimeout((function(){var t=m.pathname.slice(0,-9);""===t&&(t="/filmapp-react-frontend/"),d.replace({pathname:t,search:m.search,state:m.state}),r(e.data.accessToken)}),500)})).catch((function(e){console.error(e),g({type:"error",payload:e.response&&e.response.data&&e.response.data.error?e.response.data.error:"Something went wrong!"})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}C&&function(){e.apply(this,arguments)}()}),[x,S.email,S.name,C,w,N,d,m,r]);return Object(h.jsxs)(j.a,{id:"settingsModal",title:"Settings",onClose:function(){d.goBack()},children:[Object(h.jsxs)("form",{onSubmit:C?null:function(e){e.preventDefault(),g({type:"submit"}),(N||x&&""!==x&&x!==S.email||w&&""!==w&&w!==S.name)&&g({type:"send"})},children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{className:"form-label",htmlFor:"name",children:"Name"}),Object(h.jsx)("input",{className:"form-control",type:"text",name:"name",value:w,placeholder:S.name,onChange:function(e){return g({type:"field",fieldName:"name",payload:e.target.value})}})]}),Object(h.jsxs)("div",{className:"mt-2",children:[Object(h.jsx)("label",{className:"form-label",htmlFor:"email",children:"Email"}),Object(h.jsx)("input",{className:"form-control",type:"email",name:"email",value:x,placeholder:S.email,onChange:function(e){return g({type:"field",fieldName:"email",payload:e.target.value})}})]}),Object(h.jsxs)("div",{className:"mt-2",children:[Object(h.jsx)("label",{className:"form-label",htmlFor:"password",children:"Password"}),Object(h.jsx)("input",{className:"form-control",type:"password",name:"password",value:N,onChange:function(e){return g({type:"field",fieldName:"password",payload:e.target.value})}})]}),Object(h.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[Object(h.jsx)("button",{disabled:C||!k,type:"submit",className:"btn btn-primary",children:"Change"}),C&&Object(h.jsx)("div",{className:"ml-2 spinner-grow"})]})]}),U&&Object(h.jsx)("div",{className:"alert alert-danger mt-2 mb-0",children:U||"Error while logging in."}),E&&Object(h.jsx)("div",{className:"alert alert-success mt-2 mb-0",children:E})]})}},528:function(e,t,a){e.exports=a(240)},529:function(e,t,a){"use strict";function n(e,t,a,n,r,s,c){try{var i=e[s](c),l=i.value}catch(o){return void a(o)}i.done?t(l):Promise.resolve(l).then(n,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,s){var c=e.apply(t,a);function i(e){n(c,r,s,i,l,"next",e)}function l(e){n(c,r,s,i,l,"throw",e)}i(void 0)}))}}a.d(t,"a",(function(){return r}))},552:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c}));var n=a(42),r=a(138),s=function(e){return n.a.get("users/me",{params:e,headers:Object(r.a)()})},c=function(e){return n.a.patch("users",e,{headers:Object(r.a)()})}}}]);
//# sourceMappingURL=16.2dce1980.chunk.js.map