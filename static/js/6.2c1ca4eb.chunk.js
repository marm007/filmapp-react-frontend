(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[6],{597:function(e,t,a){},616:function(e,t,a){"use strict";a.r(t);var s=a(23),i=a.n(s),c=a(2),r=a(35),n=a(12),l=a(0),o=a(25),d=a(293),m=a(212),j=a(45),h=a(505),p=(a(597),a(48)),u=a(612),f=a(518),b=a.n(f),O=a(134),x=a.n(O),y=a(598),N=a(286),g=a(217),v=a(119),w=a(98),k=a(145),L=a(31),_=a(18),S=a(58),A={films:[],isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null,search:"",filter:"",sort:"",dir:1,sorts:[{id:"upload_date",title:"Upload date",dir:1},{id:"view_count",title:"View count",dir:1},{id:"rating",title:"Rating",dir:1}]},F=function(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(_.a)({},t.fieldName,t.payload));case"initial-success":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1,isInitialLoaded:!0,error:null,isAllFetched:t.payload.films.length<S.c,films:t.payload.films,search:t.payload.params.search,sort:t.payload.params.sort,filter:t.payload.params.filter,dir:t.payload.params.dir});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.error?e:Object(c.a)(Object(c.a)({},e),{},{isLoading:!0});case"load-success":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1,error:null,isAllFetched:t.payload.length<S.c,films:[].concat(Object(L.a)(e.films),Object(L.a)(t.payload))});case"sorts-change":return Object(c.a)(Object(c.a)({},e),{},{sort:t.resetSort?"":e.sort,sorts:e.sorts.map((function(e){return e.id===t.payload.id?t.payload:e}))});case"error":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1,error:!0});default:return e}},T=a(63),W=a(1),z=[{id:"last_hour",title:"Last hour"},{id:"today",title:"Today"},{id:"this_week",title:"This week"},{id:"this_month",title:"This month"},{id:"this_year",title:"This year"}];t.default=function(e){var t=Object(o.g)(),a=Object(o.h)(),s=Object(l.useReducer)(F,A),f=Object(n.a)(s,2),O=f[0],L=f[1],_=O.films,C=O.isLoading,I=O.isAllFetched,D=O.search,E=O.sort,R=O.filter,J=O.dir,U=O.sorts,B=O.error,P=O.isInitialLoaded,V=Object(l.useState)(!1),Y=Object(n.a)(V,2),q=Y[0],G=Y[1],H=Object(l.useCallback)((function(){C||I||B||!P||L({type:"load"})}),[B,I,P,C]);Object(w.a)(H),Object(l.useEffect)((function(){var e,t,s,n=b.a.parse(a.search),l={search:n.title,sort:null!==(e=n.sort)&&void 0!==e?e:"",filter:null!==(t=n.filter)&&void 0!==t?t:"",dir:null!==(s=n.dir)&&void 0!==s?s:1};function o(){return(o=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.f(Object(c.a)(Object(c.a)({},l),{},{limit:S.c})).then((function(e){L({type:"initial-success",payload:{films:e.data,params:l}})})).catch((function(e){L({type:"error"}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a.state&&a.state.films?L({type:"initial-success",payload:{films:a.state.films,params:l}}):function(){o.apply(this,arguments)}()}),[a]),Object(l.useEffect)((function(){function e(){return(e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.f({search:D,sort:E,filter:R,dir:J,skip:_.length,limit:S.c}).then((function(e){L({type:"load-success",payload:e.data})})).catch((function(e){L({type:"error"}),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}C&&function(){e.apply(this,arguments)}()}),[J,_.length,R,C,D,E]);var K=function(e,a){var s=R,i=E,c=J;if("filter"===e)s=s===a.id?"":a.id;else{var r=a;i===a.id?(i=a.id,1===r.dir?(r.dir=-1,c=a.dir):-1===r.dir&&(r.dir=1,i=""),L({type:"sorts-change",payload:r,resetSort:""===i}),c=a.dir):(i=a.id,c=a.dir)}""!==i&&""!==s?t.push({search:"?title=".concat(D,"&sort=").concat(i,"&dir=").concat(c,"&filter=").concat(s)}):""===i&&""!==s?t.push({search:"?title=".concat(D,"&filter=").concat(s)}):""!==i&&""===s?t.push({search:"?title=".concat(D,"&sort=").concat(i,"&dir=").concat(c)}):""===i&&""===s&&t.push({search:"?title=".concat(D)})};return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(u.a,{onClick:function(){return G(!q)},"aria-controls":"filter-collapse","aria-expanded":q,className:"mt-3 mx-3 p-2 m-button",children:Object(W.jsx)(p.a,{style:{cursor:"pointer"},icon:T.c})}),Object(W.jsx)(d.a,{in:q,children:Object(W.jsxs)(m.a,{id:"filter-collapse",className:"mx-2",children:[Object(W.jsxs)(j.a,{className:"mt-4",sm:4,children:[Object(W.jsx)("p",{style:{fontWeight:500},children:"UPLOAD DATE"}),Object(W.jsx)(j.a,{sm:8,className:"mt-3 mb-3 divider"}),z.map((function(e){return Object(W.jsx)("p",{style:R===e.id?{fontWeight:700,fontSize:"80%"}:{fontWeight:400,fontSize:"80%"},onClick:function(){return K("filter",e)},className:"search-filter",children:e.title},e.id)}))]}),Object(W.jsxs)(j.a,{className:"mt-4",sm:4,children:[Object(W.jsx)("p",{style:{fontWeight:500},children:"SORT BY"}),Object(W.jsx)(j.a,{sm:8,className:"mt-3 mb-3 divider"}),U.map((function(e){return Object(W.jsxs)(j.a,{className:"d-flex",children:[Object(W.jsx)("p",{style:E===e.id?{fontWeight:700,fontSize:"80%"}:{fontWeight:400,fontSize:"80%"},onClick:function(){return K("sort",e)},className:"search-filter",children:e.title}),E===e.id&&1===e.dir?Object(W.jsx)(p.a,{className:"ms-2",icon:"sort-up"}):E===e.id&&-1===e.dir?Object(W.jsx)(p.a,{className:"ms-2",icon:"sort-down"}):""]},e.id)}))]})]})}),Object(W.jsx)(j.a,{sm:12,className:"mt-2 mb-3 divider"}),Object(W.jsx)(m.a,{className:"mx-2 mt-4",children:_.map((function(e,a){var s=Object(g.c)(e);return Object(W.jsx)(j.a,{xs:12,sm:12,lg:8,children:Object(W.jsx)(j.a,{className:"play-outer-container m-0 mb-1",onClick:function(a){var s;Object(g.a)(a.target)||(s=e.id,t.push("".concat("/filmapp-react-frontend/","film/")+s))},children:Object(W.jsxs)(m.a,{className:"search-style mb-4 m-0",children:[Object(W.jsx)(j.a,{xs:8,sm:4,className:"p-0",children:Object(W.jsxs)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:[Object(W.jsx)(k.a,{image:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small_webp")}),Object(W.jsx)(p.a,{className:"play-middle",icon:"play"})]})}),Object(W.jsxs)(j.a,{xs:4,sm:8,children:[Object(W.jsxs)(m.a,{className:"m-0",children:[Object(W.jsx)(j.a,{className:"p-0 mb-1",style:{flex:"0 0 auto !important",width:"calc(83.33333333% - 24px) !important"},children:Object(W.jsx)(y.a,{lines:1,className:"mb-0 search-title fw-bold",children:e.title})}),Object(W.jsx)(j.a,{className:"d-flex justify-content-end",children:Object(W.jsx)(N.a,{index:a,filmID:e.id})})]}),Object(W.jsx)("p",{className:"d-none d-sm-inline mb-1 author-nick-search",children:Object(W.jsxs)("small",{children:[e.author_name," \xb7 ",e.views," views \xb7 ",s]})}),Object(W.jsx)("p",{className:"d-inline d-sm-none mb-0 author-nick-color",children:Object(W.jsxs)("small",{children:[e.author_name," \xb7 ",e.views," views"]})}),Object(W.jsx)("small",{className:"d-none d-sm-inline",children:Object(W.jsx)(x.a,{className:"mb-0 author-nick-search",line:2,text:e.description})})]})]})})},e.id)}))}),!I&&Object(W.jsx)("div",{style:{height:"32px",width:"100%"},className:"d-flex justify-content-center",children:(C||!P)&&Object(W.jsx)(h.a,{animation:"border"})})]})}}}]);
//# sourceMappingURL=6.2c1ca4eb.chunk.js.map