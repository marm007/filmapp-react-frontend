{"version":3,"sources":["images/image_not_found.png","helpers/index.js","components/pages/film/reducers/previewReducer.js","helpers/contexts/film/filmContext.js","components/pages/film/preview.js","components/pages/film/reducers/recommendationsReducer.js","components/pages/film/recommendationsSkeleton.js","components/pages/film/recommendations.js","components/pages/film/reducers/commentsReducer.js","services/commentService.js","components/pages/film/comments.js","components/pages/film/reducers/playlistReducer.js","components/pages/film/playlistContainer.js","helpers/contexts/film/filmProvider.js","components/pages/film/index.js"],"names":["displayCommentDate","comment","date","Date","parse","createdAt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","parseSearchDate","film","today","time","Math","abs","floor","UTC","initialPreviewState","img","video","title","views","likes","dislikes","description","isLiked","isDisliked","isLikeButtonClicked","likeAction","isDescExpanded","previewReducer","state","action","type","fieldName","payload","FilmContext","createContext","FilmPreview","props","history","useHistory","location","useLocation","user","useContext","UserContext","filmDispatch","playerRef","useCallback","node","getBoundingClientRect","height","setPlayerNode","useReducer","dispatch","useState","playerNode","useEffect","measure","window","addEventListener","removeEventListener","a","requests","filmApi","match","params","id","auth","push","userApi","details","console","log","Object","getOwnPropertyNames","Promise","allSettled","filmResponse","filmViewResponse","userResponse","status","filmData","value","data","comments","commentsCount","comments_count","process","liked","indexOf","disliked","handleGetFilm","likeResult","likeData","userResult","error","response","pathname","handleLike","handleTruncate","e","preventDefault","TruncateButton","className","onClick","ref","playsInline","poster","src","icon","faEye","style","cursor","faThumbsUp","faThumbsDown","whiteSpace","textAlign","line","truncateText","text","textTruncateChild","recommendationsInitialState","films","isLoading","isAllFetched","isInitialLoaded","recommendationsReducer","length","recommendationsMaxFetchCount","RecommendationsSkeleton","FilmsRecommendations","isSmallScreen","useWindowsWidth","filmState","handleRecommendationsOnBottom","useBottomScrollListener","exclude","limit","then","res","forEach","catch","err","isPreviewLoaded","initialLoad","skip","fetchData","map","index","isRecommendations","handleRedirect","Array","_","commentsInitialState","isAdding","isRemoving","toRemove","isSorting","sort","sorts","dir","commentsReducer","commentsMaxFetchCount","filter","sortToChange","all","film_id","axios","get","remove","delete","headers","authHeader","Comments","RemoveModalContext","showModal","clear","removeModalData","handleOnCommentsBottom","commentApi","loadSortedComments","loadComments","form","post","addComment","substring","concat","removeComment","sortParams","sortComments","sortTmp","tmpSort","handleSortComments","href","role","onSubmit","handleAddComment","placeholder","onChange","target","disabled","author_name","author_id","handleRemoveComment","filmPlaylistInitialState","playlist","currentFilm","currentFilmIndex","isRemovingPlaylist","isRemovingFilm","removingFilmId","headerHeight","playerHeight","filmPlaylistReducer","filtered","findIndex","is_public","PlaylistContainer","clearPlaylist","headerRef","playlistApi","filmIndex","filmId","prototype","call","reloadPlaylist","handleReloadPlaylist","parsed","queryString","search","list","handleGetPlaylist","removePlaylist","films_id","is_remove_films","removeFilm","sm","width","handleRemove","isPublic","isProfile","dispatchPrivacyUpdate","onYReachEnd","onScrollY","isNonExisting","fontWeight","alt","image_not_found","image","filmInitialState","filmReducer","FilmProvider","children","Provider","Film","onSmallScreen","useWindowWidth","historyObject"],"mappings":"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","file":"static/js/18.8bee8899.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/image_not_found.c4ba1e76.png\";","export const checkIfPlaylistButtonClick = (target) => {\n    if ((target.tagName === 'path' && target.parentNode.className.animVal && target.parentNode.className.animVal.includes('playlist-add-icon')) ||\n        (target.tagName === 'svg' && target.className.animVal && target.className.animVal.includes('playlist-add-icon')) ||\n        (target.className && typeof target.className === 'string' && target.className.includes('playlist-add-icon-holder')))\n        return true\n    return false\n}\n\nexport const displayCommentDate = (comment) => {\n    let date = new Date(Date.parse(comment.createdAt));\n    let time = (('0' + date.getDate()).slice(-2) + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-'\n        + ('0' + date.getFullYear()).slice(-2)\n        + ' o ' + ('0' + date.getHours()).slice(-2) + ':' + ('0' + date.getMinutes()).slice(-2))\n    return time;\n};\n\nexport const parseSearchDate = (film) => {\n\n    let date = new Date(Date.parse(film.createdAt));\n    let today = new Date();\n\n\n    let time = Math.abs(Math.floor((\n        Date.UTC(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours(),\n            date.getMinutes()) -\n        Date.UTC(\n            today.getFullYear(),\n            today.getMonth(),\n            today.getDate(),\n            today.getHours(),\n            today.getMinutes()))\n        / (1000 * 60)));\n\n    if (time / 60 >= 1) {\n        time /= 60;\n\n        if (time / 24 >= 1) {\n\n            time /= 24;\n\n            if (time / 30 >= 1) {\n\n                time /= 30;\n\n                if (time / 12 >= 1) {\n\n                    time = time / 12;\n                    time = Math.floor(time) + ' years ';\n\n                } else {\n                    time = Math.floor(time) + ' months ';\n                }\n\n            } else {\n                time = Math.floor(time) + ' days ';\n            }\n\n        } else {\n            time = Math.floor(time) + ' hours ';\n        }\n    } else {\n        time = Math.floor(time) + ' minutes ';\n    }\n\n    time = time + 'ago';\n\n    return time;\n};\n","const initialFilm = {\n    img: '',\n    video: '',\n    film: '',\n    title: '',\n    views: '',\n    likes: '',\n    dislikes: '',\n    description: `\\r\\n\\n\\n`,\n}\n\nexport const initialPreviewState = {\n    film: initialFilm,\n    isLiked: false,\n    isDisliked: false,\n    isLikeButtonClicked: false,\n    likeAction: null,\n    isDescExpanded: false\n}\n\nexport function previewReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'like': {\n            return {\n                ...state,\n                isLikeButtonClicked: true,\n                likeAction: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                film: action.film,\n                isLiked: action.isLiked,\n                isDisliked: action.isDisliked,\n                isLikeButtonClicked: false,\n                likeAction: null,\n                isDescExpanded: false\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isLikeButtonClicked: false,\n                likeAction: null\n            }\n        }\n        default: return state\n    }\n}","import { createContext } from 'react'\nconst FilmContext = createContext();\nexport default FilmContext","import React, { useState, useEffect, useCallback, useContext, useReducer } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEye, faThumbsDown, faThumbsUp } from '@fortawesome/free-solid-svg-icons'\nimport { Player } from 'video-react';\nimport TextTruncate from 'react-text-truncate';\nimport \"../../../../node_modules/video-react/dist/video-react.css\";\n\nimport { initialPreviewState, previewReducer } from './reducers/previewReducer';\n\nimport * as filmApi from '../../../services/filmService'\nimport * as userApi from '../../../services/userService'\n\nimport FilmContext from '../../../helpers/contexts/film/filmContext'\nimport UserContext from '../../../helpers/contexts/user/userContext';\nimport 'core-js/modules/esnext.promise.all-settled'\n\nconst FilmPreview = (props) => {\n\n    let history = useHistory()\n    let location = useLocation()\n\n    const { user } = useContext(UserContext)\n\n    // eslint-disable-next-line no-unused-vars\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const playerRef = useCallback(node => {\n        if (node !== null) {\n            filmDispatch({\n                type: 'field',\n                fieldName: 'playerHeight',\n                payload: node.getBoundingClientRect().height\n            })\n            setPlayerNode(node)\n        }\n    }, [filmDispatch])\n\n    const [state, dispatch] = useReducer(previewReducer, initialPreviewState)\n\n    const { film, isLiked, isDisliked, isLikeButtonClicked, likeAction, isDescExpanded } = state\n\n    const [playerNode, setPlayerNode] = useState(null);\n\n\n    useEffect(() => {\n        if (playerNode) {\n\n            const measure = () => {\n                filmDispatch({\n                    type: 'field',\n                    fieldName: 'playerHeight',\n                    payload: playerNode.getBoundingClientRect().height\n                })\n            }\n\n            window.addEventListener(\"resize\", measure);\n\n            return () => window.removeEventListener(\"resize\", measure);\n        }\n    }, [playerNode, filmDispatch]);\n\n    useEffect(() => {\n        async function handleGetFilm() {\n            let requests = [filmApi.index(props.match.params.id), filmApi.view(props.match.params.id)]\n            if (user.auth) requests.push(userApi.me({ details: true }))\n\n            console.log('lldd', Object.getOwnPropertyNames(Promise))\n            const [filmResponse, filmViewResponse, userResponse] = await Promise.allSettled(requests);\n\n            if (filmResponse.status === \"rejected\" || filmViewResponse.status === \"rejected\") {\n                filmDispatch({\n                    type: 'field',\n                    fieldName: 'error',\n                    payload: true\n                })\n                return\n            }\n\n\n            const filmData = filmResponse.value.data\n\n            filmDispatch({\n                type: 'success',\n                comments: filmData.comments,\n                commentsCount: filmData.comments_count\n            })\n\n            const film = {\n                ...filmData,\n                img: `${process.env.REACT_APP_API_URL}films/${filmData.id}/thumbnail?width=poster`,\n                video: `${process.env.REACT_APP_API_URL}films/${filmData.id}/video`,\n                views: filmViewResponse.value.data.views\n            }\n            let isLiked = false\n            let isDisliked = false\n\n\n            if (userResponse && userResponse.status === \"fulfilled\") {\n                const details = userResponse.value.data.details\n                isLiked = details.liked.indexOf(props.match.params.id) > -1\n                isDisliked = details.disliked.indexOf(props.match.params.id) > -1\n            }\n\n            dispatch({\n                type: 'success',\n                film: film,\n                isLiked: isLiked,\n                isDisliked: isDisliked\n            })\n\n        }\n        handleGetFilm()\n    }, [props.match.params.id, filmDispatch, user.auth])\n\n    useEffect(() => {\n        async function handleLike() {\n            if (likeAction === null) return\n\n            try {\n                const likeResult = await filmApi.like(film.id, { action: likeAction })\n\n                let likeData = likeResult.data\n                likeData.img = `${process.env.REACT_APP_API_URL}films/${likeData.id}/thumbnail?width=poster`\n                likeData.video = `${process.env.REACT_APP_API_URL}films/${likeData.id}/video`\n\n                const userResult = await userApi.me({ details: true })\n                const details = userResult.data.details\n                const isLiked = details.liked.indexOf(likeData.id) > -1\n                const isDisliked = details.disliked.indexOf(likeData.id) > -1\n\n                dispatch({\n                    type: 'success',\n                    film: likeData,\n                    isLiked: isLiked,\n                    isDisliked: isDisliked\n                })\n\n            } catch (err) {\n                console.error(err)\n                dispatch({\n                    type: 'error'\n                })\n                if (err.response && err.response.status === 401) {\n                    history.push(`${location.pathname}/login`);\n                }\n            }\n        }\n\n        if (isLikeButtonClicked) handleLike()\n    }, [film.id, isLikeButtonClicked, likeAction, history, location])\n\n    const handleTruncate = (e) => {\n        e.preventDefault();\n        dispatch({\n            type: 'field',\n            fieldName: 'isDescExpanded',\n            payload: !isDescExpanded\n        })\n    }\n\n    const handleLike = (action) => {\n        if (isLikeButtonClicked) return\n        dispatch({\n            type: 'like',\n            payload: action\n        })\n\n    };\n\n    const TruncateButton = (title) => {\n        return (<span>\n            <button className=\"btn btn-link p-0 m-0 mb-1 title fw-bold\"\n                onClick={handleTruncate}>{title}</button>\n        </span>)\n    }\n    return (\n\n        <div>\n            <div className=\"col-12 col-sm-12 preview-margins\">\n                <div ref={playerRef}>\n                    <Player\n                        playsInline\n                        poster={film.img}\n                        src={film.video} />\n                </div>\n            </div>\n            {\n                film &&\n                <div className=\"px-2 px-md-0\">\n                    <div className=\"col-12 col-sm-12 mt-4\">\n                        <div className=\"row p-0 m-0\">\n                            <div className=\"col-12 col-sm-12 p-0\">\n                                {!film.title && <p className=\"fw-bold\"><br /></p>}\n                                <p className=\"fw-bold\">{film.title}</p>\n                            </div>\n                            <div className=\"col-4 col-sm-4 p-0\">\n                                <p><FontAwesomeIcon icon={faEye} /> &ensp;{film.views}</p>\n                            </div>\n                            <div className=\"col-4 col-sm-4 text-right d-flex justify-content-end\">\n                                <p style={{ cursor: \"pointer\" }}\n                                    className={isLiked ? 'film-picked-thumb-color' : ''}\n                                    onClick={() => handleLike('like')}>\n                                    <FontAwesomeIcon icon={faThumbsUp} />\n                                    &ensp;{film.likes}\n                                </p>\n                            </div>\n                            <div className=\"col-4 col-sm-4\">\n                                <p style={{ cursor: \"pointer\" }} className={isDisliked ? 'film-picked-thumb-color' : ''}\n                                    onClick={() => handleLike('dislike')}>\n                                    <FontAwesomeIcon icon={faThumbsDown} />\n                                    &ensp;{film.dislikes}\n                                </p>\n                            </div>\n                            <div className=\"col-12 col-sm-12 mt-4 mb-4 divider\" />\n\n                            <div className=\"col-12 col-sm-12 p-0\" style={{ whiteSpace: 'pre-line', textAlign: 'justify' }}>\n                                <TextTruncate line={!isDescExpanded && 2}\n                                    truncateText=\"…\"\n                                    text={film.description}\n                                    textTruncateChild={TruncateButton('Show more')} />\n\n                                {isDescExpanded && TruncateButton('Show less')}\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-12 col-sm-12 mt-4 mb-2 divider\" />\n                </div>\n            }\n        </div>\n\n\n    )\n}\n\n\nexport default FilmPreview\n","import { recommendationsMaxFetchCount } from \"../../../../config\"\n\nexport const recommendationsInitialState = {\n    films: null,\n    id: null,\n    isLoading: false,\n    isAllFetched: false,\n    isInitialLoaded: false,\n    error: null,\n}\n\nexport function recommendationsReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'clear': {\n            return recommendationsInitialState\n        }\n        case 'initial-success': {\n            return {\n                ...recommendationsInitialState,\n                films: action.films,\n                id: action.id,\n                isInitialLoaded: true\n            }\n        }\n        case 'load': {\n\n            return {\n                ...state,\n                isLoading: true,\n                isAllFetched: false\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                films: [...state.films, ...action.payload],\n                isLoading: false,\n                isAllFetched: action.payload.length < recommendationsMaxFetchCount\n            }\n        }\n        case 'error': {\n            return {\n                ...recommendationsInitialState,\n                error: action.payload\n            }\n        }\n        default: return state\n    }\n}\n","import Skeleton from 'react-loading-skeleton';\n\nconst RecommendationsSkeleton = () => {\n\n\n    return (\n\n        <div className=\"row mx-0 mb-4 container-px\">\n            <div className=\"row p-0 m-0\">\n                <div className='col-6 col-sm-6 m-0 p-0' >\n                    <div className=\"ratio ratio-16x9\">\n                        <Skeleton className=\"w-100 h-100\" />\n                    </div>\n                </div>\n                <div className='col-6 col-sm-6 m-0'>\n                    <div className=\"row m-0 h-25\">\n                        <div className=\"col p-0\">\n                            <Skeleton className=\"w-100 h-100\" />\n                        </div>\n                    </div>\n                    <div className=\"pt-2 h-75\">\n                            <Skeleton className=\"w-100 h-100\" />\n                        </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default RecommendationsSkeleton","import React, { useEffect, useReducer, useCallback, useContext } from 'react';\n\nimport { recommendationsReducer, recommendationsInitialState } from './reducers/recommendationsReducer'\n\nimport Film from '../../helpers/film';\n\nimport * as filmApi from '../../../services/filmService'\n\nimport { recommendationsMaxFetchCount } from \"../../../config\"\n\nimport useBottomScrollListener from '../../../helpers/hooks/useBottomScrollListener';\nimport FilmContext from '../../../helpers/contexts/film/filmContext';\n\nimport RecommendationsSkeleton from './recommendationsSkeleton'\nimport FilmSkeleton from '../../helpers/film/skeleton';\n\nimport useWindowsWidth from '../../../helpers/hooks/useWindowsWidth';\n\nconst FilmsRecommendations = (props) => {\n\n    const isSmallScreen = useWindowsWidth(768);\n\n    // eslint-disable-next-line no-unused-vars\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(recommendationsReducer, recommendationsInitialState)\n\n    const { films, isLoading, isAllFetched, isInitialLoaded, id, error } = state\n\n    const handleRecommendationsOnBottom = useCallback(() => {\n        if (!isLoading && !isAllFetched && isInitialLoaded && !error && id) {\n            dispatch({\n                type: 'load'\n            })\n        }\n    }, [isLoading, isAllFetched, isInitialLoaded, error, id])\n\n    useBottomScrollListener(handleRecommendationsOnBottom)\n\n    useEffect(() => {\n        async function initialLoad() {\n            await filmApi.all({ exclude: props.match.params.id, limit: recommendationsMaxFetchCount })\n                .then(res => {\n                    let films = res.data;\n\n                    films.forEach(film => {\n                        film.img = `${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail`\n\n                    });\n\n                    dispatch({\n                        type: 'initial-success',\n                        films: films,\n                        id: props.match.params.id\n                    })\n\n\n                })\n                .catch(err => console.error(err))\n        }\n\n        dispatch({\n            type: 'clear'\n        })\n\n        if (filmState.isPreviewLoaded) {\n            initialLoad()\n        }\n    }, [props.match.params.id, filmState.isPreviewLoaded])\n\n    useEffect(() => {\n        if (filmState.error) {\n            dispatch({\n                type: 'error',\n                payload: filmState.error\n            })\n        }\n    }, [filmState.error])\n\n    useEffect(() => {\n        async function fetchData() {\n            await filmApi.all({ exclude: id, skip: films.length, limit: recommendationsMaxFetchCount }).then(res => {\n                let films = res.data;\n\n                films.forEach(film => {\n                    film.img = `${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail`\n\n                });\n\n                dispatch({\n                    type: 'success',\n                    payload: films\n                })\n            }).catch(err => console.error(err))\n        }\n        if (isLoading && films && id) fetchData()\n    }, [isLoading, id, films])\n\n\n    return (\n\n        <div className=\"row m-0\">\n\n            {\n                films ? films.map((film, index) => <Film key={film.id} film={film} index={index} isRecommendations={true} filmDispatch={filmDispatch} handleRedirect={() => props.handleRedirect(film.id)} />)\n                    : ([...Array(20)].map((_, index) => isSmallScreen ?\n                        (<FilmSkeleton key={index} isRecommendations={true} />) :\n                        (<RecommendationsSkeleton key={index} />)\n                    ))\n            }\n\n\n            {\n                !isAllFetched && <div className=\"fetch-loader d-flex justify-content-center\">\n                    {(isLoading) && !error && <div className=\"spinner-border\" />}\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default FilmsRecommendations\n","import { commentsMaxFetchCount } from \"../../../../config\"\n\nexport const commentsInitialState = {\n    comments: null,\n    commentsCount: null,\n    text: '',\n    id: null,\n    isLoading: false,\n    isAllFetched: false,\n    isInitialLoaded: false,\n    isAdding: false,\n    isRemoving: false,\n    toRemove: null,\n    isSorting: false,\n    sort: null,\n    sorts: [\n        { id: 'created_at', title: 'By date', dir: 1 },\n        { id: 'author_name', title: 'By author name', dir: 1 }\n    ],\n    error: null\n}\n\nexport function commentsReducer(state, action) {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'clear': {\n            return {\n                ...commentsInitialState,\n                id: action.id\n            }\n        }\n        case 'load': {\n            return !state.isLoading && !state.isAllFetched && state.isInitialLoaded && !state.isAdding &&\n                !state.error && state.id && !state.isSorting ?\n                {\n                    ...state,\n                    isLoading: true\n                } : state\n        }\n        case 'initial-success': {\n            return {\n                ...state,\n                comments: action.comments,\n                commentsCount: action.commentsCount,\n                isAllFetched: action.comments.length < commentsMaxFetchCount,\n                isInitialLoaded: true,\n                error: null,\n            }\n        }\n        case 'load-success': {\n            return {\n                ...state,\n                comments: [...state.comments, ...action.payload],\n                isLoading: false,\n                isAllFetched: action.payload.length < commentsMaxFetchCount\n            }\n        }\n        case 'add': {\n            return {\n                ...state,\n                isAdding: true,\n                error: null\n            }\n        }\n        case 'add-success': {\n            return {\n                ...state,\n                text: '',\n                commentsCount: state.commentsCount + 1,\n                comments: [action.payload, ...state.comments],\n                isAdding: false\n            }\n        }\n        case 'remove': {\n            return {\n                ...state,\n                isRemoving: true,\n                toRemove: action.payload\n            }\n        }\n        case 'remove-success': {\n            return {\n                ...state,\n                isRemoving: false,\n                toRemove: null,\n                commentsCount: state.commentsCount - 1,\n                comments: state.toRemove ? state.comments.filter(comment => comment.id !== state.toRemove.id) : state.data\n            }\n        }\n        case 'sort': {\n            return {\n                ...state,\n                comments: null,\n                isAllFetched: false,\n                sorts: state.sorts.map(sort => {\n                    if (sort.id === action.sortToChange.id) return action.sortToChange\n                    else return sort\n                }),\n                sort: action.sort,\n                isSorting: true,\n            }\n        }\n        case 'sort-success': {\n            return {\n                ...state,\n                isSorting: false,\n                comments: action.payload,\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isAdding: false,\n                isLoading: false,\n                isSorting: false,\n                error: action.payload,\n            }\n        }\n        default: return state\n    }\n}","import axios from '../helpers/axios'\nimport authHeader from '../helpers/authHeader'\n\n\nexport const all = (film_id, params) => axios.get(`films/${film_id}/comments`, { params })\n\nexport const create = (film_id, form) => axios.post(`films/${film_id}/comments`, form, { headers: authHeader() })\n\nexport const update = (id, update) => axios.put(`comments/${id}`, update, { headers: authHeader() })\n\nexport const remove = (id) => axios.delete(`comments/${id}`, { headers: authHeader() })\n\nexport const sort = (film_id, params) => axios.get(`films/${film_id}/comments/sort`, { params, headers: authHeader() })\n\n\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useContext, useEffect, useReducer, useCallback } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { commentsReducer, commentsInitialState } from './reducers/commentsReducer';\n\nimport * as commentApi from '../../../services/commentService'\n\nimport { commentsMaxFetchCount } from \"../../../config\"\n\nimport { displayCommentDate } from '../../../helpers';\nimport useBottomScrollListener from '../../../helpers/hooks/useBottomScrollListener';\nimport UserContext from '../../../helpers/contexts/user/userContext';\nimport FilmContext from '../../../helpers/contexts/film/filmContext';\nimport RemoveModalContext from '../../../helpers/contexts/removeModal/removeModalContext';\nimport RippleButton from '../../helpers/rippleButton';\n\nconst Comments = (props) => {\n\n    const { showModal, clear, removeModalData } = useContext(RemoveModalContext)\n\n    const { user } = useContext(UserContext);\n\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(commentsReducer, commentsInitialState)\n    const {\n        comments,\n        commentsCount,\n        text,\n        isInitialLoaded,\n        isLoading,\n        isAllFetched,\n        isAdding,\n        id,\n        isRemoving,\n        toRemove,\n        isSorting,\n        sort,\n        sorts,\n        error\n    } = state\n\n    const handleOnCommentsBottom = useCallback(() => {\n        if (!isLoading && !isAllFetched && isInitialLoaded && !isAdding && !error && id && !isSorting) {\n            dispatch({\n                type: 'load'\n            })\n        }\n    }, [isLoading, isAllFetched, isInitialLoaded, isAdding, error, id, isSorting])\n\n    useBottomScrollListener(handleOnCommentsBottom)\n\n    useEffect(() => {\n        dispatch({\n            type: 'clear',\n            id: props.match.params.id\n        })\n    }, [props.match.params.id])\n\n    useEffect(() => {\n        if (filmState.error) {\n            dispatch({\n                type: 'error',\n                payload: filmState.error\n            })\n        }\n    }, [filmState.error])\n\n    useEffect(() => {\n        function getCommentsFromContext() {\n            dispatch({\n                type: 'initial-success',\n                comments: filmState.comments,\n                commentsCount: filmState.commentsCount,\n            })\n        }\n\n        if (filmState.comments && filmState.commentsCount !== null) getCommentsFromContext()\n    }, [filmState.comments, filmState.commentsCount, filmDispatch])\n\n    useEffect(() => {\n        async function loadComments() {\n            await commentApi.all(id, { skip: comments.length, limit: commentsMaxFetchCount })\n                .then(res => {\n                    dispatch({\n                        type: 'load-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error'\n                    })\n                })\n        }\n        async function loadSortedComments() {\n            await commentApi.sort(id, { [sort.id]: sort.dir, skip: comments.length, limit: commentsMaxFetchCount })\n                .then(res => {\n                    dispatch({\n                        type: 'load-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error'\n                    })\n                })\n        }\n        if (isLoading && isInitialLoaded && !isAdding &&\n            comments && id && !isSorting) {\n            if (!sort)\n                loadComments()\n            else\n                loadSortedComments()\n        }\n    }, [isLoading, isAdding, id, comments, isInitialLoaded, isSorting, sort])\n\n\n    useEffect(() => {\n        const addComment = async () => {\n            const comment = { text: text }\n\n            await commentApi.create(id, comment)\n                .then(res => {\n                    dispatch({\n                        type: 'add-success',\n                        payload: res.data\n                    })\n                })\n                .catch(err => {\n                    dispatch({\n                        type: 'error',\n                        payload: err.response.status\n                    })\n                })\n        };\n        if (isAdding && !isLoading && id) addComment()\n    }, [isAdding, isLoading, id, text])\n\n    useEffect(() => {\n        async function removeComment() {\n            await commentApi.remove(toRemove.id)\n                .then(res => {\n                    dispatch({ type: 'remove-success' })\n                    clear()\n                })\n                .catch(err => {\n                    clear()\n                    console.error(err)\n                })\n        }\n\n        if (isRemoving && toRemove && removeModalData.isRemoving &&\n            removeModalData.id === toRemove.id && removeModalData.type === 'comment' &&\n            removeModalData.title === toRemove.text.substring(0, 10).concat('...')) removeComment()\n    }, [isRemoving, toRemove, clear, removeModalData])\n\n    useEffect(() => {\n        async function sortComments() {\n            const sortParams = sort ? { [sort.id]: sort.dir, limit: commentsMaxFetchCount } : {}\n\n            await commentApi.sort(id, sortParams)\n                .then(res => {\n                    dispatch({ type: 'sort-success', payload: res.data })\n                })\n                .catch(err => {\n                    dispatch({ type: 'error', payload: 'Sort error.' })\n                    console.error(err)\n                })\n        }\n        if (isSorting) sortComments()\n    }, [isSorting, sort, id])\n\n    const handleAddComment = (e) => {\n        e.preventDefault()\n        dispatch({\n            type: 'add'\n        })\n    }\n\n    const handleRemoveComment = (comment) => {\n        if (removeModalData.isRemoving) return\n        dispatch({ type: 'remove', payload: comment })\n        showModal(comment.id, 'comment', comment.text.substring(0, 10).concat('...'))\n    }\n\n    const handleSortComments = (e, id) => {\n        e.preventDefault()\n\n        let sortToChange = null\n\n        switch (id) {\n            case 'created_at':\n                sortToChange = sorts[0]\n\n                break;\n            case 'author_name':\n                sortToChange = sorts[1]\n                break;\n            default:\n                return;\n        }\n\n        let tmpSort = null\n\n        if (sort && sort.id === sortToChange.id) {\n            sortToChange.dir *= -1\n            tmpSort = sortToChange\n            if (sortToChange.dir === 1) {\n                tmpSort = null\n            }\n        } else {\n            tmpSort = sortToChange\n        }\n\n        dispatch({\n            type: 'sort',\n            sortToChange: sortToChange,\n            sort: tmpSort\n        })\n\n    };\n\n\n    return (\n\n        <div className=\"col\">\n            <div className=\"row p-0 mt-4 mb-4\">\n                <div className=\"col-7 col-sm-5 col-md-4 d-flex align-items-center \">\n                    {commentsCount !== null && <span>{commentsCount}{commentsCount === 1 ? ' comment' : ' comments'} </span>}\n                </div>\n                <div className=\"dropdown col-2 col-sm-2\">\n                    <button className=\"btn btn-secondary dropdown-toggle\" id=\"sortDropDown\"\n                        data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                        Sort\n                    </button>\n                    <ul className=\"dropdown-menu\" aria-labelledby=\"#sortDropDown\">\n                        {\n                            sorts.map(sortTmp => {\n                                return (\n                                    <li key={sortTmp.id} onClick={e => handleSortComments(e, sortTmp.id)}>\n                                        <a className={`dropdown-item${(sort && sortTmp.id === sort.id) ? ' active' : ''}`} href=\"#\" role=\"button\">\n                                            {sortTmp.title}\n                                            {sort && sort.id === sortTmp.id && sortTmp.dir === 1 ?\n                                                <FontAwesomeIcon className=\"ms-2\" icon=\"sort-up\" /> :\n                                                sort && sort.id === sortTmp.id && sortTmp.dir === -1 ?\n                                                    <FontAwesomeIcon className=\"ms-2\" icon=\"sort-down\" /> : \"\"}\n                                        </a></li>);\n                            })\n                        }\n\n                    </ul>\n                </div>\n            </div>\n            <form onSubmit={(e) => (text && !isAdding) ? handleAddComment(e) : null}>\n                <div id=\"fiordur\">\n                    <input type=\"text\"  placeholder=\"Comment\" value={text}\n                        onChange={e => dispatch({ type: 'field', fieldName: 'text', payload: e.target.value })}\n                    />\n                </div>\n                <div className=\"col d-flex justify-content-end\" >\n                    <button disabled={isAdding || !text}\n                        type=\"submit\"\n                        className=\"btn btn-primary mt-3\">\n                        Submit\n                    </button>\n                </div>\n            </form>\n\n            {\n                isAdding && <div style={{ height: 32 + 'px' }} className=\"d-flex justify-content-center\">\n                    <div className=\"spinner-border\" />\n                </div>\n            }\n            {\n                comments && comments.map(comment => {\n                    return (\n                        <div className=\"col col-sm-12 p-0 mt-4 remove-container\" key={comment.id}>\n                            <div className=\"d-flex\">\n                                <p className=\"m-0 fw-bold\">\n                                    <small className=\"m-0 fw-bold\">{comment.author_name}&nbsp;</small>\n                                </p>\n                                <p >\n                                    <small className=\"m-0\">{displayCommentDate(comment)}</small>\n                                </p>\n                                {\n                                    user.id === comment.author_id &&\n\n                                    <RippleButton className=\"m-button cursor-pointer button-ripple-24 d-flex justify-content-center align-items-center remove-holder p-0 m-0 ms-auto\"\n                                        onClick={() => handleRemoveComment(comment)}>\n                                        <FontAwesomeIcon icon=\"trash-alt\" />\n\n                                    </RippleButton>\n                                }\n                            </div>\n                            <p className=\"d-block d-sm-block\">\n                                <small>{comment.text}</small>\n                            </p>\n                        </div>\n                    )\n                })\n            }\n\n            {\n                !isAllFetched && <div className=\"fetch-loader d-flex justify-content-center\">\n                    {(isLoading || isSorting) && !error && <div className=\"spinner-border\" />}\n                </div>\n            }\n\n        </div>\n\n    )\n}\n\nexport default Comments","\nexport const filmPlaylistInitialState = {\n    playlist: null,\n    currentFilm: null,\n    currentFilmIndex: 0,\n    isLoading: false,\n    isRemovingPlaylist: false,\n    isRemovingFilm: false,\n    removingFilmId: null,\n    headerHeight: null,\n    playerHeight: null\n}\n\nexport const filmPlaylistReducer = (state, action) => {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                isLoading: false,\n                playlist: action.playlist,\n                currentFilm: action.currentFilm,\n                currentFilmIndex: action.currentFilmIndex\n            }\n        }\n        case 'clear': {\n            return filmPlaylistInitialState\n        }\n        case 'remove-film': {\n            return {\n                ...state,\n                removingFilmId: action.payload,\n                isRemovingFilm: true\n            }\n        }\n        case 'remove-film-success': {\n\n            if (!state.removingFilmId)\n                return {\n                    ...state,\n                    isRemovingFilm: false\n                }\n\n            const filtered = state.playlist.films.filter(film => film.id !== state.removingFilmId)\n            return {\n                ...state,\n                currentFilm: state.removingFilmId === state.currentFilm ? null : state.currentFilm,\n                currentFilmIndex: state.removingFilmId === state.currentFilm ? 0 : filtered.findIndex(film => film.id === state.currentFilm) + 1,\n                playlist: {\n                    ...state.playlist,\n                    films: filtered\n                },\n                isRemovingFilm: false,\n            }\n        }\n        case 'change-playlist-privacy-success': {\n            return {\n                ...state,\n                playlist: { ...state.playlist, is_public: action.payload.is_public }\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isLoading: false,\n                error: action.payload\n            }\n        }\n        default:\n            return state\n    }\n}","import React, { useContext, useEffect, useCallback, useReducer } from 'react';\nimport { useLocation } from 'react-router-dom'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport queryString from \"query-string\";\nimport TextTruncate from \"react-text-truncate\";\nimport PerfectScrollbar from 'react-perfect-scrollbar'\nimport 'react-perfect-scrollbar/dist/css/styles.css';\n\nimport { filmPlaylistInitialState, filmPlaylistReducer } from './reducers/playlistReducer';\n\nimport BlurredImageComponent from '../../helpers/blurredImage';\n\nimport * as playlistApi from '../../../services/playlistService'\n\nimport FilmContext from '../../../helpers/contexts/film/filmContext';\nimport UserContext from '../../../helpers/contexts/user/userContext';\nimport RemoveModalContext from '../../../helpers/contexts/removeModal/removeModalContext';\nimport RemoveButton from '../../helpers/removeButton';\nimport ChangePrivacyButton from '../../helpers/changePrivacyButton';\n\nimport image_not_found from '../../../images/image_not_found.png'; // Tell Webpack this JS file uses this image\n\nconst PlaylistContainer = (props) => {\n\n    const { showModal, clear, removeModalData } = useContext(RemoveModalContext)\n\n    let location = useLocation()\n\n    const { user } = useContext(UserContext)\n    const [filmState, filmDispatch] = useContext(FilmContext)\n\n    const [state, dispatch] = useReducer(filmPlaylistReducer, filmPlaylistInitialState)\n\n    const {\n        playlist,\n        isRemovingPlaylist,\n        isRemovingFilm,\n        removingFilmId,\n        currentFilm,\n        currentFilmIndex,\n        headerHeight,\n        playerHeight,\n        error\n    } = state\n\n    const clearPlaylist = () => {\n        dispatch({ type: 'clear' })\n    }\n\n    const headerRef = useCallback(node => {\n        if (node !== null) {\n            dispatch({\n                type: 'field',\n                fieldName: 'headerHeight',\n                payload: node.getBoundingClientRect().height\n            });\n        }\n    }, [])\n\n    useEffect(() => {\n        dispatch({\n            type: 'field',\n            fieldName: 'playerHeight',\n            payload: filmState.playerHeight\n        });\n    }, [filmState.playerHeight])\n\n    useEffect(() => {\n        dispatch({\n            type: 'error',\n            payload: filmState.error\n        });\n    }, [filmState.error])\n\n\n    useEffect(() => {\n        async function handleReloadPlaylist() {\n            await playlistApi.index(playlist.id)\n                .then(res => {\n\n                    let filmIndex = 0\n                    let filmId = null\n\n                    Array.prototype.forEach.call(res.data.films, (film, index) => {\n                        if (film && film.id === props.match.params.id) {\n                            filmIndex = index + 1\n                            filmId = film.id\n                        }\n                    })\n\n                    dispatch({\n                        type: 'success',\n                        playlist: res.data,\n                        currentFilm: filmId,\n                        currentFilmIndex: filmIndex\n                    })\n\n                    filmDispatch({\n                        type: 'field',\n                        fieldName: 'reloadPlaylist',\n                        payload: false\n                    })\n\n                    return res.data\n                })\n                .catch(err => {\n                    console.error(err)\n                })\n        }\n\n        if (filmState.reloadPlaylist && playlist) handleReloadPlaylist()\n\n    }, [filmState.reloadPlaylist, playlist, filmDispatch, props.match.params.id])\n\n\n\n    useEffect(() => {\n        const parsed = queryString.parse(location.search);\n        if (!parsed.list) {\n            clearPlaylist()\n            return\n        }\n\n        async function handleGetPlaylist() {\n            await playlistApi.index(parsed.list).then(res => {\n\n                let filmIndex = 0\n                let filmId = null\n\n                Array.prototype.forEach.call(res.data.films, (film, index) => {\n                    if (film && film.id === props.match.params.id) {\n                        filmIndex = index + 1\n                        filmId = film.id\n                    }\n                })\n\n                dispatch({\n                    type: 'success',\n                    playlist: res.data,\n                    currentFilm: filmId,\n                    currentFilmIndex: filmIndex\n                })\n                return res.data\n            }).catch(err => {\n                console.error(err)\n                clearPlaylist()\n            })\n        }\n        if (!error && filmState.isPreviewLoaded) handleGetPlaylist()\n    }, [props.match.params.id, location.search, error, filmState.isPreviewLoaded])\n\n\n    useEffect(() => {\n        async function removePlaylist() {\n            await playlistApi.remove(playlist.id)\n                .then(res => {\n                    clearPlaylist()\n                    clear()\n                })\n                .catch(err => {\n                    console.error(err)\n                    clear()\n                })\n        }\n        if (isRemovingPlaylist && removeModalData.isRemoving &&\n            removeModalData.id === playlist.id && removeModalData.type === 'playlist' &&\n            removeModalData.title === playlist.title) removePlaylist()\n    }, [clear, isRemovingPlaylist, playlist, removeModalData])\n\n\n    useEffect(() => {\n        async function removeFilm() {\n            await playlistApi.partialUpdate(playlist.id, { films_id: [removingFilmId], is_remove_films: true })\n                .then(res => {\n                    dispatch({\n                        type: 'remove-film-success'\n                    })\n                })\n                .catch(err => {\n                    console.error(err)\n                })\n        }\n\n        if (isRemovingFilm) removeFilm()\n    }, [isRemovingFilm, playlist, removingFilmId])\n\n    const handleRemovePlaylist = () => {\n\n        if (removeModalData.isRemoving) return\n\n        dispatch({\n            type: 'field',\n            fieldName: 'isRemovingPlaylist',\n            payload: true\n        })\n\n        showModal(playlist.id, 'playlist', playlist.title)\n    }\n\n    const handleRemoveFromPlaylist = (id) => {\n        if (isRemovingFilm) return\n\n        dispatch({\n            type: 'remove-film',\n            payload: id\n        })\n    }\n\n\n    return (\n\n        playlist && playerHeight && !error &&\n        <div className='col mb-4'>\n            <div className='col p-0 border'>\n                <div ref={headerRef}\n                    style={{ height: headerHeight + 'px' }}\n                    className=\"col remove-container pt-2 pb-2 film-preview-playlist-header\" sm={12}>\n                    <div className=\"row m-0 px-2\">\n                        <div className=\"button-ripple-div-next-width colbutton-ripple-div-next-width\">\n                            <p className=\"mb-1 fw-bold film-preview-playlist-text-truncate\">{playlist.title}</p>\n                        </div>\n                        <div style={{ width: '24px' }} className=\"p-0 justify-content-end d-flex\">\n                            {\n                                user.id === playlist.author_id &&\n                                <RemoveButton handleRemove={() => handleRemovePlaylist()} />\n                            }\n                        </div>\n                        <div className=\"col-12 col-sm-12\">\n                            {\n                                user.id === playlist.author_id &&\n                                <ChangePrivacyButton\n                                    id={playlist.id}\n                                    isPublic={playlist.is_public}\n                                    isProfile={false}\n                                    dispatchPrivacyUpdate={dispatch} />\n                            }\n                            {\n                                user.id === playlist.author_id && <small>&nbsp;</small>\n\n                            }\n                            <small>{playlist.author_name}&nbsp;</small>\n                            <small\n                                className=\"film-preview-playlist-index\">\n                                - {currentFilmIndex}/{playlist.films.length}\n                            </small>\n                        </div>\n                    </div>\n                </div>\n                <div style={{ height: playerHeight - headerHeight + 'px' }}\n                    className=\"col-12 col-sm-12 p-0 film-preview-playlist-container\">\n                    <PerfectScrollbar\n                        onYReachEnd={() => { }}\n                        onScrollY={() => { }}>\n                        {\n                            playlist.films.map((film, index) => {\n                                return(\n                                    <div className=\"row m-0 p-0 pe-2 remove-container\" key={film.id}>\n                                        <div className={`${index === playlist.films.length - 1 ?\n                                            \"mt-3 mb-3 \" :\n                                            \"mt-3\"} button-ripple-div-next-width col`}\n                                            onClick={() => {\n                                                if (!film.isNonExisting)\n                                                    props.handleRedirect(film.id)\n                                            }}>\n                                            <div className=\"row m-0 p-0 play-outer-container\">\n                                                <div\n                                                    className=\"col-1 col-sm-1 text-center justify-content-center d-flex align-items-center p-0 ps-1\" >\n                                                    {\n                                                        (currentFilm === film.id) ?\n                                                            <small>\n                                                                <FontAwesomeIcon style={{ fontWeight: 300 }}\n                                                                    icon=\"play\" />\n                                                            </small>\n                                                            :\n                                                            <small>{index + 1}</small>\n\n                                                    }\n                                                </div>\n                                                <div className=\"col-6 col-sm-6 pe-2 ps-2\">\n                                                    <div className=\"embed-responsive embed-responsive-16by9 z-depth-1-half w-100 play-container\">\n                                                        {film.isNonExisting ?\n                                                            <img alt=\"\" className=\"embed-responsive-item play-image\"\n                                                                src={image_not_found} />\n                                                            :\n                                                            <BlurredImageComponent\n                                                                image={`${process.env.REACT_APP_API_URL}films/${film.id}/thumbnail`} />\n                                                        }\n                                                    </div>\n                                                </div>\n                                                <div className=\"col-5 col-sm-5 p-0\">\n                                                    {film.isNonExisting ?\n                                                        (<TextTruncate line={2} text=\"Not found\"\n                                                            className=\"mb-0 title fw-bold\" />)\n                                                        :\n                                                        (<>\n                                                            <TextTruncate line={1} text={film.title}\n                                                                className=\"mb-0 title fw-bold\" />\n                                                            <p className=\"mb-1 author-nick\">\n                                                                <span>{film.author_name}</span>\n                                                            </p>\n                                                        </>)\n                                                    }\n                                                </div>\n                                            </div>\n                                        </div>\n                                        {\n                                            user.id === playlist.author_id &&\n                                            <div style={{ width: '24px' }} className=\"p-0 d-flex align-items-center justify-content-center\">\n                                                <RemoveButton handleRemove={() => handleRemoveFromPlaylist(film.id)} />\n                                            </div>\n                                        }\n\n                                    </div>\n                                )\n                            })\n                        }\n                    </PerfectScrollbar>\n                </div>\n            </div>\n        </div >\n\n\n    )\n}\n\n\nexport default PlaylistContainer\n","import { useReducer } from \"react\"\nimport FilmContext from \"./filmContext\"\n\nconst filmInitialState = {\n    isPreviewLoaded: false,\n    comments: null,\n    commentsCount: null,\n    playerHeight: null,\n    reloadPlaylist: false,\n    error: null\n}\n\nconst filmReducer = (state, action) => {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'success': {\n            return {\n                ...state,\n                isPreviewLoaded: true,\n                comments: action.comments,\n                commentsCount: action.commentsCount,\n                error: null\n            }\n        }\n        case 'reset-comments': {\n            return {\n                ...state,\n                comments: null,\n                commentsCount: null\n            }\n        }\n        default:\n            return state\n    }\n}\n\nconst FilmProvider = ({ children }) => {\n    const [filmState, filmDispatch] = useReducer(filmReducer, filmInitialState)\n\n\n    return (\n        <FilmContext.Provider value={[filmState, filmDispatch]}>\n            {children}\n        </FilmContext.Provider>\n    );\n}\n\nexport default FilmProvider","import { useHistory, useLocation } from 'react-router-dom'\nimport queryString from \"query-string\";\n\nimport FilmPreview from './preview'\nimport FilmsRecommendations from './recommendations';\nimport Comments from './comments';\nimport PlaylistContainer from './playlistContainer';\n\nimport useWindowWidth from '../../../helpers/hooks/useWindowsWidth'\nimport FilmProvider from '../../../helpers/contexts/film/filmProvider'\n\nimport './film.css'\n\n\nconst Film = (props) => {\n\n    let history = useHistory()\n    let location = useLocation()\n\n    const onSmallScreen = useWindowWidth(768);\n\n    const handleRedirect = (id) => {\n        const parsed = queryString.parse(location.search);\n        let historyObject = { pathname: `${process.env.REACT_APP_PATH_NAME}film/` + id }\n        if (parsed.list) historyObject = { ...historyObject, search: `?list=${parsed.list}` }\n        history.push(historyObject);\n    };\n\n    return (\n        <FilmProvider>\n            <div className=\"row p-0 m-0 mt-4 mx-2\">\n                <div className=\"col-12 order-first col-sm-12 order-first col-md-8 film-preview-container-px\">\n                    <FilmPreview {...props} />\n                    {!onSmallScreen && <Comments {...props} />}\n                </div>\n                <div className=\"col-12 order-2 col-sm-12 order-2 col-md-4 p-0\">\n                    <PlaylistContainer handleRedirect={handleRedirect} {...props} />\n                    <FilmsRecommendations handleRedirect={handleRedirect} {...props} />\n                </div>\n                {onSmallScreen &&\n                    <div className=\"col-12 order-last col-sm-12 order-sm-last col-md-8 pb-5 container-px\">\n                        <Comments {...props} />\n                    </div>\n                }\n            </div>\n\n        </FilmProvider>\n    )\n}\n\nexport default Film"],"sourceRoot":""}