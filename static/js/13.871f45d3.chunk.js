(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[13],{508:function(e,t,r){"use strict";r.r(t);var a=r(528),n=r.n(a),s=r(529),i=r(60),c=r(1),l=r(7),o=r(139),d=r(540),u=r(545),m=r(140),f=r(80),b=r(2);t.default=function(){var e=Object(l.g)(),t=Object(c.useContext)(f.a).login,r=Object(c.useReducer)(u.b,u.a),a=Object(i.a)(r,2),p=a[0],j=a[1],h=p.email,v=p.nick,O=p.password,g=p.isSubmitted,x=p.isSuccess,y=p.isSending,N=p.isError,w=p.error;Object(c.useEffect)((function(){function r(){return(r=Object(s.a)(n.a.mark((function r(){return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.d({email:h,password:O,name:v}).then((function(r){j({type:"success"}),setTimeout((function(){t(r.data.user.name,r.data.user.id,r.data.token,r.data.refreshToken),e.goBack()}),1500)})).catch((function(e){var t=null;e.response&&e.response.data&&e.response.data.errors?t=e.response.data.errors:e.response&&e.response.data&&e.response.data.error&&(t=e.response.data.error),j({type:"error",payload:t}),console.error(e)}));case 2:case"end":return r.stop()}}),r)})))).apply(this,arguments)}y&&function(){r.apply(this,arguments)}()}),[y,h,v,O,e,t]);return Object(b.jsx)(o.a,{id:"registerModal",title:"Register",onClose:function(){e.goBack()},children:Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),j({type:"submit"}),h&&v&&O&&O.length>=6&&j({type:"send"})},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{className:"form-label",htmlFor:"nick",children:"Nick"}),Object(b.jsx)(d.a,{isInvalid:g&&!v,type:"text",name:"nick",value:v,onChange:function(e){return j({type:"field",fieldName:"nick",payload:e.target.value})}}),Object(b.jsx)("div",{className:"invalid-feedback",children:"Nick is required"})]}),Object(b.jsxs)("div",{className:"mt-2",children:[Object(b.jsx)("label",{className:"form-label",htmlFor:"email",children:"Email"}),Object(b.jsx)(d.a,{isInvalid:g&&!h,type:"email",name:"email",value:h,onChange:function(e){return j({type:"field",fieldName:"email",payload:e.target.value})}}),Object(b.jsx)("div",{className:"invalid-feedback",children:"Email is required"})]}),Object(b.jsxs)("div",{className:"mt-2",children:[Object(b.jsx)("label",{className:"form-label",htmlFor:"password",children:"Password"}),Object(b.jsx)(d.a,{isInvalid:g&&O.length<6,type:"password",name:"password",value:O,onChange:function(e){return j({type:"field",fieldName:"password",payload:e.target.value})}}),Object(b.jsx)("div",{className:"invalid-feedback",children:0===O.length?"Password is required":"Password too short (min 6 chars)"})]}),x&&Object(b.jsx)("div",{className:"alert alert-success mt-2",children:"You have successfully registered and logged in."}),N&&Object(b.jsx)("div",{className:"alert alert-danger mt-2",children:w||"Error while registtering."}),Object(b.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[Object(b.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Register"}),y&&Object(b.jsx)("div",{className:"spinner-grow ml-2"})]})]})})}},528:function(e,t,r){e.exports=r(240)},529:function(e,t,r){"use strict";function a(e,t,r,a,n,s,i){try{var c=e[s](i),l=c.value}catch(o){return void r(o)}c.done?t(l):Promise.resolve(l).then(a,n)}function n(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var i=e.apply(t,r);function c(e){a(i,n,s,c,l,"next",e)}function l(e){a(i,n,s,c,l,"throw",e)}c(void 0)}))}}r.d(t,"a",(function(){return n}))},540:function(e,t,r){"use strict";var a=r(1),n=r(2);t.a=function(e){var t=e.isInvalid,r=e.onChange,s=e.type,i=e.name,c=e.value,l=e.placeholder,o=void 0===l?"":l,d="textarea"===s?"textarea":"input",u=Object(a.useRef)(null);return Object(a.useEffect)((function(){u.current&&(t?u.current.classList.add("is-invalid"):u.current.classList.remove("is-invalid"))}),[t]),Object(n.jsx)(d,{ref:u,className:"form-control",placeholder:o,type:s,name:i,value:c,onChange:r})}},545:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var a=r(137),n=r(15),s={email:"",nick:"",password:"",isSubmitted:!1,isSending:!1,isSuccess:!1,isError:!1,error:null},i=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(a.a)({isSubmitted:!1},t.fieldName,t.payload));case"submit":return Object(n.a)(Object(n.a)({},e),{},{isError:!1,error:null,isSubmitted:!0});case"send":return Object(n.a)(Object(n.a)({},e),{},{isSending:!0});case"success":return Object(n.a)(Object(n.a)({},e),{},{isError:!1,error:null,isSending:!1,isSuccess:!0});case"error":return Object(n.a)(Object(n.a)({},e),{},{isSending:!1,isError:!0,error:t.payload});default:return e}}}}]);
//# sourceMappingURL=13.871f45d3.chunk.js.map