(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[16],{511:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return _}));var i=a(1),c=a(531),s=a.n(c),n=a(541),l=a(15),o=a(532),r=a(47),u=a(8),d=a(136),p=a(539),m={data:null,isLoading:!1,isAllLoaded:!1,isRemoving:!1,toRemove:null,error:null,filmsCount:0,playlistsCount:0};function f(t,e){switch(e.type){case"field":return Object(l.a)(Object(l.a)({},t),{},Object(d.a)({},e.fieldName,e.payload));case"initial-success":return Object(l.a)(Object(l.a)({},t),{},{isLoading:!1,isInitialLoaded:!0,isAllLoaded:e.filmsCount<p.c&&e.playlistsCount<p.c,filmsCount:t.filmsCount+e.filmsCount,playlistsCount:t.playlistsCount+e.playlistsCount,data:Object(n.a)(new Set(e.data))});case"load":return t.isLoading||t.isAllLoaded||!t.isInitialLoaded||t.error?t:Object(l.a)(Object(l.a)({},t),{},{isLoading:!0,isAllLoaded:!1});case"success":return Object(l.a)(Object(l.a)({},t),{},{isLoading:!1,isAllLoaded:e.filmsCount<p.c&&e.playlistsCount<p.c,filmsCount:t.filmsCount+e.filmsCount,playlistsCount:t.playlistsCount+e.playlistsCount,data:Object(n.a)(new Set([].concat(Object(n.a)(t.data),Object(n.a)(e.data))))});case"update-resource":return t.data?Object(l.a)(Object(l.a)({},t),{},{data:t.data.map((function(t){return Boolean(t.isPlaylist)===e.isPlaylist&&t.id===e.resource.id?Object(l.a)(Object(l.a)({},t),{},{title:e.resource.title}):t}))}):t;case"remove":return Object(l.a)(Object(l.a)({},t),{},{toRemove:e.payload,isRemoving:!0});case"remove-success":return Object(l.a)(Object(l.a)({},t),{},{isRemoving:!1,toRemove:null,data:t.toRemove?t.data.filter((function(e){return e.id!==t.toRemove.id})):t.data});case"change-playlist-privacy-success":return Object(l.a)(Object(l.a)({},t),{},{data:t.data.map((function(t){return t.isPlaylist&&t.id===e.payload.id?Object(l.a)(Object(l.a)({},t),{},{is_public:e.payload.is_public}):t}))});case"clear":return m;default:return t}}var j=a(567),b=a(579),O=a(549),y=a(543),h=a(542),v=a(83),x=a(84),g=a(544),P=a(555),C=a(142),k=a(580),R=(a(581),a(2)),w=function(){var t=Object(i.useContext)(C.a),e=t.clearToUpdate,a=t.updateResource,c=Object(i.useContext)(v.a),d=c.user,w=c.clearUser,_=Object(i.useContext)(x.a),L=_.showModal,N=_.clear,A=_.removeModalData,E=Object(u.g)(),S=Object(i.useReducer)(f,m),U=Object(r.a)(S,2),F=U[0],I=U[1],J=F.data,M=F.isLoading,B=F.isAllLoaded,D=F.isInitialLoaded,T=F.error,q=F.isRemoving,z=F.toRemove,G=F.filmsCount,H=F.playlistsCount,K=Object(i.useCallback)((function(){M||B||!D||T||I({type:"load"})}),[M,B,D,T]);Object(g.a)(K,{triggerOnNoScroll:!0}),Object(i.useEffect)((function(){!d.auth&&d.isInitialLoaded&&(E.replace("".concat("/filmapp-react-frontend/")),E.push("".concat("/filmapp-react-frontend/","login")),w())}),[d,E,w]),Object(i.useEffect)((function(){function t(){return(t=Object(o.a)(s.a.mark((function t(){var e,a,i,c,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.allSettled([Object(O.a)({playlists:!0,films:!0,populatePlaylists:!0,skipFilms:0,skipPlaylists:0,limit:p.b})]);case 2:e=t.sent,a=Object(r.a)(e,1),i=a[0],c=[],o=[],u=[],"fulfilled"===i.status&&(o=i.value.data.films.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail")})})),u=i.value.data.playlists.map((function(t){var e=t.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.film_id,"/thumbnail"):k.a;return Object(l.a)(Object(l.a)({},t),{},{img:e,isPlaylist:!0})})),c=[].concat(Object(n.a)(c),Object(n.a)(o),Object(n.a)(u))),I({type:"initial-success",data:c,filmsCount:o.length,playlistsCount:u.length});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}I({type:"clear"}),function(){t.apply(this,arguments)}()}),[]),Object(i.useEffect)((function(){function t(){return(t=Object(o.a)(s.a.mark((function t(){var e,a,i,c,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.allSettled([Object(O.a)({playlists:!0,films:!0,populatePlaylists:!0,skipFilms:G,skipPlaylists:H,limit:p.c})]);case 2:e=t.sent,a=Object(r.a)(e,1),i=a[0],c=[],o=[],u=[],"fulfilled"===i.status&&(o=i.value.data.films.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail")})})),u=i.value.data.playlists.map((function(t){var e=t.film_id?"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.film_id,"/thumbnail"):k.a;return Object(l.a)(Object(l.a)({},t),{},{img:e,isPlaylist:!0})})),c=[].concat(Object(n.a)(c),Object(n.a)(o),Object(n.a)(u))),I({type:"success",data:c,filmsCount:o.length,playlistsCount:u.length});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}M&&D&&function(){t.apply(this,arguments)}()}),[G,M,H,D]),Object(i.useEffect)((function(){function t(){return(t=Object(o.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!z.isPlaylist){t.next=8;break}return t.next=4,Object(y.d)(z.id);case 4:204===t.sent.status&&(I({type:"remove-success"}),N()),t.next=12;break;case 8:return t.next=10,Object(h.g)(z.id);case 10:204===t.sent.status&&(I({type:"remove-success"}),N());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))).apply(this,arguments)}q&&A.isRemoving&&z&&A.id===z.id&&A.title===z.title&&A.type===(z.isPlaylist?"playlist":"film")&&function(){t.apply(this,arguments)}()}),[q,A,z,N]),Object(i.useEffect)((function(){null!==a.isPlaylist&&null!==a.resource&&(I({type:"update-resource",resource:a.resource,isPlaylist:a.isPlaylist}),e())}),[a,e]);var Q=function(t,e){t.stopPropagation(),A.isRemoving||(I({type:"remove",payload:e}),L(e.id,e.isPlaylist?"playlist":"film",e.title))};return Object(R.jsxs)("div",{className:"row mt-5 mx-2",children:[J?J.map((function(t,e){return t.isPlaylist?Object(R.jsx)(b.a,{playlist:t,index:e,isProfile:!0,dispatchPrivacyUpdate:I,handleRedirect:function(){return function(t){t.film_id&&E.push({pathname:"".concat("/filmapp-react-frontend/","film/")+t.film_id,search:"?list=".concat(t.id)})}(t)},handleRemove:function(e){return Q(e,t)}},t.id):Object(R.jsx)(j.a,{isProfile:!0,film:t,index:e,handleRedirect:function(){return e=t,void E.push({pathname:"".concat("/filmapp-react-frontend/","film/")+e.id,state:{film:e}});var e},handleRemove:function(e){return Q(e,t)}},t.id)})):Object(n.a)(Array(24)).map((function(t,e){return Object(R.jsx)(P.a,{},e)})),!B&&Object(R.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:M&&Object(R.jsx)("div",{className:"spinner-border"})})]})};function _(){return Object(i.useEffect)((function(){document.title="Profile - FilmApp"}),[]),Object(R.jsx)(w,{})}},579:function(t,e,a){"use strict";var i=a(47),c=a(1),s=a(533),n=a(548),l=a.n(n),o=a(553),r=a(554),u=a(559),d=a(568),p=a(2);e.a=function(t){var e=t.playlist,a=t.handleRedirect,n=t.handleRemove,m=t.isProfile,f=t.dispatchPrivacyUpdate,j=Object(c.useState)("mb-4 play-outer-container remove-container"),b=Object(i.a)(j,2),O=b[0],y=b[1];return Object(c.useEffect)((function(){e.film_id||y("mb-4 play-cursor-default remove-container")}),[e.film_id]),Object(p.jsx)("div",{className:"col-12 col-sm-6 col-md-3 col-lg-2 container-px",children:Object(p.jsxs)("div",{className:"col ".concat(O," p-0"),onClick:function(){return a(e.id,e.film_id)},children:[Object(p.jsxs)("div",{className:"play-container p-0",children:[Object(p.jsx)(o.a,{image:e.img}),Object(p.jsxs)("div",{className:"row play-middle w-100 m-0",children:[Object(p.jsx)("div",{className:"col-5 col-sm-5 pr-1 d-flex justify-content-end align-items-center",children:Object(p.jsx)(s.a,{icon:"play"})}),Object(p.jsx)("div",{className:"col-7 col-sm-7 pl-1 d-flex justify-content-start align-items-center",children:Object(p.jsx)("small",{className:"font-weight-bold",children:"Play all"})})]})]}),Object(p.jsxs)("div",{className:"row m-0 mt-1",children:[Object(p.jsx)("div",{className:"p-0 col ".concat(m?"button-ripple-div-next-width-3x":"col-12"),children:Object(p.jsx)(l.a,{line:1,text:e.title,className:"mb-1 mt-1 title "})}),m&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(u.a,{id:e.id,isPublic:e.is_public,isProfile:!0,dispatchPrivacyUpdate:f}),Object(p.jsx)(r.a,{handleRemove:n}),Object(p.jsx)(d.a,{isPlaylist:!0,id:e.id,title:e.title})]})]}),Object(p.jsx)("p",{className:"mb-0 author-nick",children:Object(p.jsx)("span",{children:e.author_name})})]})},e.id)}},580:function(t,e,a){"use strict";e.a=a.p+"static/media/image_not_found.c4ba1e76.png"},581:function(t,e,a){a(582)},582:function(t,e,a){"use strict";var i=a(0),c=a(7),s=a(140),n=a(242),l=a(9);i({target:"Promise",stat:!0},{allSettled:function(t){var e=this,a=s.f(e),i=a.resolve,o=a.reject,r=n((function(){var a=c(e.resolve),s=[],n=0,o=1;l(t,(function(t){var c=n++,l=!1;s.push(void 0),o++,a.call(e,t).then((function(t){l||(l=!0,s[c]={status:"fulfilled",value:t},--o||i(s))}),(function(t){l||(l=!0,s[c]={status:"rejected",reason:t},--o||i(s))}))})),--o||i(s)}));return r.error&&o(r.value),a.promise}})}}]);
//# sourceMappingURL=16.da842812.chunk.js.map