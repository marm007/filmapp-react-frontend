(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[13],{620:function(e,a,t){"use strict";t.r(a);var n=t(2),s=t(23),r=t.n(s),c=t(35),i=t(12),l=t(508),o=t(509),u=t(295),d=t(505),m=t(507),p=t(0),b=t(25),j=t(69),f=t(18),O={name:"",email:""},h=Object(n.a)(Object(n.a)({},O),{},{password:"",initialUser:O,isInitialLoaded:!1,isSubmitted:!1,isSending:!1,error:"",success:""}),y=function(e,a){switch(a.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(f.a)({error:""},a.fieldName,a.payload));case"initial-success":return Object(n.a)(Object(n.a)({},e),{},{initialUser:{email:a.email,name:a.name},isInitialLoaded:!0});case"submit":return Object(n.a)(Object(n.a)({},e),{},{isSubmitted:!0,error:null});case"send":return Object(n.a)(Object(n.a)({},e),{},{isSending:!0});case"success":return Object(n.a)(Object(n.a)({},e),{},{isSubmitted:!1,isSending:!1,success:"Changes saved successfully!",error:null});case"error":return Object(n.a)(Object(n.a)({},e),{},{isSending:!1,isSubmitted:!1,error:a.payload});default:return e}},g=t(128),x=t(1);a.default=function(e){var a=Object(p.useContext)(j.a),t=a.user,s=a.clearUser,f=a.updateUser,O=Object(b.g)(),w=Object(b.h)(),v=Object(p.useReducer)(y,h),S=Object(i.a)(v,2),N=S[0],C=S[1],L=N.email,k=N.name,E=N.password,U=N.initialUser,G=(N.isSubmitted,N.isSending),I=N.isInitialLoaded,B=N.success,F=N.error,T=Object(p.useState)(!0),H=Object(i.a)(T,2),J=H[0],_=H[1];Object(p.useEffect)((function(){!t.auth&&t.isInitialLoaded&&(_(!1),O.replace("".concat("/filmapp-react-frontend/")),O.push("".concat("/filmapp-react-frontend/","login")),s())}),[t,O,s]),Object(p.useEffect)((function(){function e(){return(e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a().then((function(e){C({type:"initial-success",name:e.data.name,email:e.data.email})})).catch((function(e){console.error(e),C({type:"error",payload:!0})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(p.useEffect)((function(){function e(){return(e=Object(c.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},E&&(a={password:E}),L&&""!==L&&L!==U.email&&(a=Object(n.a)(Object(n.a)({},a),{},{email:L})),k&&""!==k&&k!==U.name&&(a=Object(n.a)(Object(n.a)({},a),{},{name:k})),e.next=6,g.b(a).then((function(e){C({type:"success"}),setTimeout((function(){var a=w.pathname.slice(0,-9);""===a&&(a="/filmapp-react-frontend/"),O.replace({pathname:a,search:w.search,state:w.state}),f(e.data.accessToken)}),500)})).catch((function(e){console.error(e),C({type:"error",payload:e.response&&e.response.data&&e.response.data.error?e.response.data.error:"Something went wrong!"})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}G&&function(){e.apply(this,arguments)}()}),[L,U.email,U.name,G,k,E,O,w,f]);return Object(x.jsxs)(l.a,{onHide:function(){_(!1),O.goBack()},show:J,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(l.a.Header,{closeButton:!0,children:Object(x.jsx)(l.a.Title,{children:"Settings"})}),Object(x.jsxs)(l.a.Body,{children:[Object(x.jsxs)(o.a,{onSubmit:G?null:function(e){e.preventDefault(),C({type:"submit"}),(E||L&&""!==L&&L!==U.email||k&&""!==k&&k!==U.name)&&C({type:"send"})},children:[Object(x.jsxs)(o.a.Group,{children:[Object(x.jsx)(o.a.Label,{htmlFor:"name",children:"Name"}),Object(x.jsx)(o.a.Control,{type:"text",name:"email",value:k,placeholder:U.name,onChange:function(e){return C({type:"field",fieldName:"name",payload:e.target.value})}})]}),Object(x.jsxs)(o.a.Group,{className:"mt-2",children:[Object(x.jsx)(o.a.Label,{htmlFor:"email",children:"Email"}),Object(x.jsx)(o.a.Control,{type:"email",name:"email",value:L,placeholder:U.email,onChange:function(e){return C({type:"field",fieldName:"email",payload:e.target.value})}})]}),Object(x.jsxs)(o.a.Group,{className:"mt-2",children:[Object(x.jsx)(o.a.Label,{htmlFor:"password",children:"Password"}),Object(x.jsx)(o.a.Control,{type:"password",name:"password",value:E,onChange:function(e){return C({type:"field",fieldName:"password",payload:e.target.value})}})]}),Object(x.jsxs)(o.a.Group,{className:"d-flex align-items-center mt-2",children:[Object(x.jsx)(u.a,{disabled:G||!I,type:"submit",className:"btn-primary",children:"Change"}),G&&Object(x.jsx)(d.a,{className:"ms-2",animation:"grow"})]})]}),F&&Object(x.jsx)(m.a,{variant:"danger",className:"mt-2 mb-0",children:F||"Error while logging in."}),B&&Object(x.jsx)(m.a,{variant:"success",className:"mt-2 mb-0",children:B})]})]})}}}]);
//# sourceMappingURL=13.7c718847.chunk.js.map