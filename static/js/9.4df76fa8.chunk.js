(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[9],{614:function(e,t,a){"use strict";a.r(t);var c=a(2),n=a(0),i=a.n(n),s=a(25),r=a(518),l=a.n(r),o=a(23),d=a.n(o),u=a(35),m=a(12),p=a(295),j=a(45),b=a(212),f=a(48),h=a(119),O=a(128),x=a(570),y=a(134),v=a.n(y),g=Object(n.createContext)(),k=(a(587),a(18)),w={film:{img:"",video:"",film:"",title:"",views:"",likes:"",dislikes:"",description:"\r\n\n\n"},isLiked:!1,isDisliked:!1,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1};function N(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.fieldName,t.payload));case"like":return Object(c.a)(Object(c.a)({},e),{},{isLikeButtonClicked:!0,likeAction:t.payload});case"success":return Object(c.a)(Object(c.a)({},e),{},{film:t.film,isLiked:t.isLiked,isDisliked:t.isDisliked,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});case"error":return Object(c.a)(Object(c.a)({},e),{},{isLikeButtonClicked:!1,likeAction:null});default:return e}}var C=a(69),F=a(63),R=a(1);var L=function(e){var t=Object(s.g)(),a=Object(s.h)(),r=Object(n.useContext)(C.a).user,l=Object(n.useContext)(g),o=Object(m.a)(l,2),y=(o[0],o[1]),k=Object(n.useCallback)((function(e){null!==e&&(y({type:"field",fieldName:"playerHeight",payload:e.getBoundingClientRect().height}),J(e))}),[y]),L=Object(n.useReducer)(N,w),E=Object(m.a)(L,2),I=E[0],_=E[1],A=I.film,P=I.isLiked,S=I.isDisliked,D=I.isLikeButtonClicked,H=I.likeAction,B=I.isDescExpanded,T=Object(n.useState)(null),z=Object(m.a)(T,2),M=z[0],J=z[1];Object(n.useEffect)((function(){if(M){var e=function(){y({type:"field",fieldName:"playerHeight",payload:M.getBoundingClientRect().height})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[M,y]),Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(d.a.mark((function t(){var a,n,i,s,l,o,u,p,j,b,f;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[h.c(e.match.params.id),h.g(e.match.params.id)],r.auth&&a.push(O.a({details:!0})),t.next=4,Promise.allSettled(a);case 4:if(n=t.sent,i=Object(m.a)(n,3),s=i[0],l=i[1],o=i[2],"rejected"!==s.status&&"rejected"!==l.status){t.next=12;break}return y({type:"field",fieldName:"error",payload:!0}),t.abrupt("return");case 12:u=s.value.data,y({type:"success",comments:u.comments,commentsCount:u.comments_count}),p=Object(c.a)(Object(c.a)({},u),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(u.id,"/thumbnail?width=poster"),video:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(u.id,"/video"),views:l.value.data.views}),j=!1,b=!1,o&&"fulfilled"===o.status&&(f=o.value.data.details,j=f.liked.indexOf(e.match.params.id)>-1,b=f.disliked.indexOf(e.match.params.id)>-1),_({type:"success",film:p,isLiked:j,isDisliked:b});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.match.params.id,y,r.auth]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){var c,n,i,s,r,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==H){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,h.d(A.id,{action:H});case 5:return c=e.sent,(n=c.data).img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(n.id,"/thumbnail?width=poster"),n.video="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(n.id,"/video"),e.next=11,O.a({details:!0});case 11:i=e.sent,s=i.data.details,r=s.liked.indexOf(n.id)>-1,l=s.disliked.indexOf(n.id)>-1,_({type:"success",film:n,isLiked:r,isDisliked:l}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(2),console.error(e.t0),_({type:"error"}),e.t0.response&&401===e.t0.response.status&&t.push("".concat(a.pathname,"/login"));case 23:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}D&&function(){e.apply(this,arguments)}()}),[A.id,D,H,t,a]);var W=function(e){e.preventDefault(),_({type:"field",fieldName:"isDescExpanded",payload:!B})},Y=function(e){D||_({type:"like",payload:e})},K=function(e){return Object(R.jsx)("span",{children:Object(R.jsx)(p.a,{variant:"link",className:"p-0 m-0 mb-1 title fw-bold",onClick:W,children:e})})};return Object(R.jsxs)(j.a,{children:[Object(R.jsx)(j.a,{sm:12,children:Object(R.jsx)("div",{ref:k,children:Object(R.jsx)(x.Player,{playsInline:!0,poster:A.img,src:A.video})})}),A&&Object(R.jsxs)(i.a.Fragment,{children:[Object(R.jsx)(j.a,{className:"mt-4",sm:12,children:Object(R.jsxs)(b.a,{className:"p-0 m-0",children:[Object(R.jsxs)(j.a,{sm:12,className:"p-0",children:[!A.title&&Object(R.jsx)("p",{className:"fw-bold",children:Object(R.jsx)("br",{})}),Object(R.jsx)("p",{className:"fw-bold",children:A.title})]}),Object(R.jsx)(j.a,{xs:4,sm:4,className:"p-0",children:Object(R.jsxs)("p",{children:[Object(R.jsx)(f.a,{icon:F.b})," \u2002",A.views]})}),Object(R.jsx)(j.a,{xs:4,sm:4,className:"text-right d-flex justify-content-end",children:Object(R.jsxs)("p",{style:{cursor:"pointer"},className:P?"film-picked-thumb-color":"",onClick:function(){return Y("like")},children:[Object(R.jsx)(f.a,{icon:F.k}),"\u2002",A.likes]})}),Object(R.jsx)(j.a,{xs:4,sm:4,children:Object(R.jsxs)("p",{style:{cursor:"pointer"},className:S?"film-picked-thumb-color":"",onClick:function(){return Y("dislike")},children:[Object(R.jsx)(f.a,{icon:F.j}),"\u2002",A.dislikes]})}),Object(R.jsx)(j.a,{sm:12,className:"mt-4 mb-4 divider"}),Object(R.jsxs)(j.a,{sm:12,className:"p-0",style:{whiteSpace:"pre-line",textAlign:"justify"},children:[Object(R.jsx)(v.a,{line:!B&&2,truncateText:"\u2026",text:A.description,textTruncateChild:K("Show more")}),B&&K("Show less")]})]})}),Object(R.jsx)(j.a,{sm:12,className:"mt-4 mb-2 divider"})]})]})},E=a(505),I=a(98),_=a(216),A=a(31),P=a(58),S={films:null,id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null};function D(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.fieldName,t.payload));case"clear":return S;case"initial-success":return Object(c.a)(Object(c.a)({},S),{},{films:t.films,id:t.id,isInitialLoaded:!0});case"load":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(c.a)(Object(c.a)({},e),{},{films:[].concat(Object(A.a)(e.films),Object(A.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<P.e});case"error":return Object(c.a)(Object(c.a)({},S),{},{error:t.payload});default:return e}}var H=function(e){var t=Object(n.useContext)(g),a=Object(m.a)(t,2),c=a[0],i=(a[1],Object(n.useReducer)(D,S)),s=Object(m.a)(i,2),r=s[0],l=s[1],o=r.films,p=r.isLoading,b=r.isAllFetched,f=r.isInitialLoaded,O=r.id,x=r.error,y=Object(n.useCallback)((function(){p||b||!f||x||!O||l({type:"load"})}),[p,b,f,x,O]);return Object(I.a)(y),Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a({exclude:e.match.params.id,limit:P.e}).then((function(t){var a=t.data;a.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small_webp")})),l({type:"initial-success",films:a,id:e.match.params.id})})).catch((function(e){return console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}l({type:"clear"}),c.isPreviewLoaded&&function(){t.apply(this,arguments)}()}),[e.match.params.id,c.isPreviewLoaded]),Object(n.useEffect)((function(){c.error&&l({type:"error",payload:c.error})}),[c.error]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a({exclude:O,skip:o.length,limit:P.e}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail?width=small_webp")})),l({type:"success",payload:t})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}p&&o&&O&&function(){e.apply(this,arguments)}()}),[p,O,o]),Object(R.jsxs)(j.a,{children:[o&&o.map((function(t,a){return Object(R.jsx)(_.a,{film:t,index:a,isRecommendations:!0,handleRedirect:function(){return e.handleRedirect(t.id)}},t.id)})),!b&&Object(R.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:(p||!f)&&!x&&Object(R.jsx)(E.a,{animation:"border"})})]})},B=a(609),T=a(491),z=a(613),M=a(588),J=a.n(M),W=a(22),Y=a(38),K=function(e,t){return W.a.get("films/".concat(e,"/comments"),{params:t})},U=function(e){return W.a.delete("comments/".concat(e),{headers:Object(Y.a)()})},q=function(e,t){return W.a.get("films/".concat(e,"/comments/sort"),{params:t,headers:Object(Y.a)()})},G={comments:null,commentsCount:null,text:"",id:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,isAdding:!1,isRemoving:!1,toRemove:null,isSorting:!1,sort:null,sorts:[{id:"created_at",title:"By date",dir:1},{id:"author_name",title:"By author name",dir:1}],error:null};function Q(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.fieldName,t.payload));case"clear":return Object(c.a)(Object(c.a)({},G),{},{id:t.id});case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.isAdding||e.error||!e.id||e.isSorting?e:Object(c.a)(Object(c.a)({},e),{},{isLoading:!0});case"initial-success":return Object(c.a)(Object(c.a)({},e),{},{comments:t.comments,commentsCount:t.commentsCount,isAllFetched:t.comments.length<P.a,isInitialLoaded:!0,error:null});case"load-success":return Object(c.a)(Object(c.a)({},e),{},{comments:[].concat(Object(A.a)(e.comments),Object(A.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<P.a});case"add":return Object(c.a)(Object(c.a)({},e),{},{isAdding:!0,error:null});case"add-success":return Object(c.a)(Object(c.a)({},e),{},{text:"",commentsCount:e.commentsCount+1,comments:[t.payload].concat(Object(A.a)(e.comments)),isAdding:!1});case"remove":return Object(c.a)(Object(c.a)({},e),{},{isRemoving:!0,toRemove:t.payload});case"remove-success":return Object(c.a)(Object(c.a)({},e),{},{isRemoving:!1,toRemove:null,commentsCount:e.commentsCount-1,comments:e.toRemove?e.comments.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"sort":return Object(c.a)(Object(c.a)({},e),{},{comments:null,isAllFetched:!1,sorts:e.sorts.map((function(e){return e.id===t.sortToChange.id?t.sortToChange:e})),sort:t.sort,isSorting:!0});case"sort-success":return Object(c.a)(Object(c.a)({},e),{},{isSorting:!1,comments:t.payload});case"error":return Object(c.a)(Object(c.a)({},e),{},{isAdding:!1,isLoading:!1,isSorting:!1,error:t.payload});default:return e}}var V=a(217),X=a(104);var Z=function(e){var t=Object(n.useContext)(X.a),a=t.showModal,c=t.clear,i=t.removeModalData,s=Object(n.useContext)(C.a).user,r=Object(n.useContext)(g),l=Object(m.a)(r,2),o=l[0],h=l[1],O=Object(n.useReducer)(Q,G),x=Object(m.a)(O,2),y=x[0],v=x[1],w=y.comments,N=y.commentsCount,F=y.text,L=y.isInitialLoaded,_=y.isLoading,A=y.isAllFetched,S=y.isAdding,D=y.id,H=y.isRemoving,M=y.toRemove,Z=y.isSorting,$=y.sort,ee=y.sorts,te=y.error,ae=Object(n.useCallback)((function(){_||A||!L||S||te||!D||Z||v({type:"load"})}),[_,A,L,S,te,D,Z]);return Object(I.a)(ae),Object(n.useEffect)((function(){v({type:"clear",id:e.match.params.id})}),[e.match.params.id]),Object(n.useEffect)((function(){o.error&&v({type:"error",payload:o.error})}),[o.error]),Object(n.useEffect)((function(){o.comments&&null!==o.commentsCount&&v({type:"initial-success",comments:o.comments,commentsCount:o.commentsCount})}),[o.comments,o.commentsCount,h]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(D,{skip:w.length,limit:P.a}).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(D,(t={},Object(k.a)(t,$.id,$.dir),Object(k.a)(t,"skip",w.length),Object(k.a)(t,"limit",P.a),t)).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}_&&L&&!S&&w&&D&&!Z&&($?function(){t.apply(this,arguments)}():function(){e.apply(this,arguments)}())}),[_,S,D,w,L,Z,$]),Object(n.useEffect)((function(){S&&!_&&D&&function(){var e=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={text:F},e.next=3,(a=D,c=t,W.a.post("films/".concat(a,"/comments"),c,{headers:Object(Y.a)()})).then((function(e){v({type:"add-success",payload:e.data})})).catch((function(e){v({type:"error",payload:e.response.status})}));case 3:case"end":return e.stop()}var a,c}),e)})));return function(){return e.apply(this,arguments)}}()()}),[S,_,D,F]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(M.id).then((function(e){v({type:"remove-success"}),c()})).catch((function(e){c(),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}H&&M&&i.isRemoving&&i.id===M.id&&"comment"===i.type&&i.title===M.text.substring(0,10).concat("...")&&function(){e.apply(this,arguments)}()}),[H,M,c,i]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=$?(t={},Object(k.a)(t,$.id,$.dir),Object(k.a)(t,"limit",P.a),t):{},e.next=3,q(D,a).then((function(e){v({type:"sort-success",payload:e.data})})).catch((function(e){v({type:"error",payload:"Sort error."}),console.error(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Z&&function(){e.apply(this,arguments)}()}),[Z,$,D]),Object(R.jsxs)(j.a,{children:[Object(R.jsxs)(b.a,{className:"p-0 mt-4 mb-4",children:[Object(R.jsx)(j.a,{xs:7,sm:5,md:4,className:"d-flex align-items-center ",children:null!==N&&Object(R.jsxs)("span",{children:[N,1===N?" comment":" comments"," "]})}),Object(R.jsx)(j.a,{xs:2,sm:2,children:Object(R.jsx)(B.a,{variant:"secondary",title:"Sort",id:"dropdown-button-drop-down",onSelect:function(e){return function(e){var t=null;switch(e){case"created_at":t=ee[0];break;case"author_name":t=ee[1];break;default:return}var a=null;$&&$.id===t.id?(t.dir*=-1,a=t,1===t.dir&&(a=null)):a=t,v({type:"sort",sortToChange:t,sort:a})}(e)},children:ee.map((function(e){return Object(R.jsxs)(T.a.Item,{eventKey:e.id,active:$&&e.id===$.id,children:[e.title,$&&$.id===e.id&&1===e.dir?Object(R.jsx)(f.a,{className:"ms-2",icon:"sort-up"}):$&&$.id===e.id&&-1===e.dir?Object(R.jsx)(f.a,{className:"ms-2",icon:"sort-down"}):""]},e.id)}))})})]}),Object(R.jsx)(z.a,{value:F,onChange:function(e){return v({type:"field",fieldName:"text",payload:e.target.value})},type:"text",id:"standard-multiline-flexible",label:"Comment",multiline:!0,fullWidth:!0,maxrow:"4"}),Object(R.jsx)(j.a,{className:"d-flex justify-content-end",children:Object(R.jsx)(p.a,{disabled:S||!F,className:"mt-3",variant:"primary",onClick:F&&!S?function(){v({type:"add"})}:null,children:"Submit"})}),S&&Object(R.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:Object(R.jsx)(E.a,{animation:"border"})}),w&&w.map((function(e){return Object(R.jsxs)(j.a,{className:"p-0 mt-4 remove-container",sm:12,children:[Object(R.jsxs)("div",{className:"d-flex",children:[Object(R.jsx)("p",{className:"m-0 fw-bold",children:Object(R.jsxs)("small",{className:"m-0 fw-bold",children:[e.author_name,"\xa0"]})}),Object(R.jsx)("p",{children:Object(R.jsx)("small",{className:"m-0",children:Object(V.b)(e)})}),s.id===e.author_id&&Object(R.jsx)(j.a,{xs:2,sm:2,className:"d-flex justify-content-center align-items-center remove-holder p-0 m-0 ms-auto",style:{height:"24px",width:"24px"},children:Object(R.jsx)(J.a,{style:{borderRadius:"20px",width:"24px",height:"24px"},className:"m-button cursor-pointer",onClick:function(){return function(e){i.isRemoving||(v({type:"remove",payload:e}),a(e.id,"comment",e.text.substring(0,10).concat("...")))}(e)},children:Object(R.jsx)(f.a,{icon:"trash-alt"})})})]}),Object(R.jsx)("p",{className:"d-block d-sm-block",children:Object(R.jsx)("small",{children:e.text})})]},e.id)})),!A&&Object(R.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:(_||!L||Z)&&!te&&Object(R.jsx)(E.a,{animation:"border"})})]})},$=a(206),ee=(a(593),a(594)),te=a.n(ee),ae=a(93),ce={playlist:null,currentFilm:null,currentFilmIndex:0,isLoading:!1,isRemovingPlaylist:!1,isRemovingFilm:!1,removingFilmId:null,headerHeight:null,playerHeight:null},ne=function(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.fieldName,t.payload));case"success":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1,playlist:t.playlist,currentFilm:t.currentFilm,currentFilmIndex:t.currentFilmIndex});case"clear":return ce;case"remove-film":return Object(c.a)(Object(c.a)({},e),{},{removingFilmId:t.payload,isRemovingFilm:!0});case"remove-film-success":if(!e.removingFilmId)return Object(c.a)(Object(c.a)({},e),{},{isRemovingFilm:!1});var a=e.playlist.films.filter((function(t){return t.id!==e.removingFilmId}));return Object(c.a)(Object(c.a)({},e),{},{currentFilm:e.removingFilmId===e.currentFilm?null:e.currentFilm,currentFilmIndex:e.removingFilmId===e.currentFilm?0:a.findIndex((function(t){return t.id===e.currentFilm}))+1,playlist:Object(c.a)(Object(c.a)({},e.playlist),{},{films:a}),isRemovingFilm:!1});case"change-playlist-privacy-success":return Object(c.a)(Object(c.a)({},e),{},{playlist:Object(c.a)(Object(c.a)({},e.playlist),{},{is_public:t.payload.is_public})});case"error":return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}},ie=a(147),se=a(146);var re=function(e){var t=Object(n.useContext)(X.a),a=t.showModal,c=t.clear,i=t.removeModalData,r=Object(s.h)(),o=Object(n.useContext)(C.a).user,p=Object(n.useContext)(g),h=Object(m.a)(p,2),O=h[0],x=h[1],y=Object(n.useReducer)(ne,ce),k=Object(m.a)(y,2),w=k[0],N=k[1],F=w.playlist,L=w.isRemovingPlaylist,E=w.isRemovingFilm,I=w.removingFilmId,_=w.currentFilm,A=w.currentFilmIndex,P=w.headerHeight,S=w.playerHeight,D=w.error,H=function(){N({type:"clear"})},B=Object(n.useCallback)((function(e){null!==e&&N({type:"field",fieldName:"headerHeight",payload:e.getBoundingClientRect().height})}),[]);Object(n.useEffect)((function(){N({type:"field",fieldName:"playerHeight",payload:O.playerHeight})}),[O.playerHeight]),Object(n.useEffect)((function(){N({type:"error",payload:O.error})}),[O.error]),Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ae.b(F.id).then((function(t){var a=0,c=null;return Array.prototype.forEach.call(t.data.films,(function(t,n){t&&t.id===e.match.params.id&&(a=n+1,c=t.id)})),N({type:"success",playlist:t.data,currentFilm:c,currentFilmIndex:a}),x({type:"field",fieldName:"reloadPlaylist",payload:!1}),t.data})).catch((function(e){console.error(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}O.reloadPlaylist&&F&&function(){t.apply(this,arguments)}()}),[O.reloadPlaylist,F,x,e.match.params.id]),Object(n.useEffect)((function(){var t=l.a.parse(r.search);function a(){return(a=Object(u.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ae.b(t.list).then((function(t){var a=0,c=null;return Array.prototype.forEach.call(t.data.films,(function(t,n){t&&t.id===e.match.params.id&&(a=n+1,c=t.id)})),N({type:"success",playlist:t.data,currentFilm:c,currentFilmIndex:a}),t.data})).catch((function(e){console.error(e),H()}));case 2:case"end":return a.stop()}}),a)})))).apply(this,arguments)}t.list?!D&&O.isPreviewLoaded&&function(){a.apply(this,arguments)}():H()}),[e.match.params.id,r.search,D,O.isPreviewLoaded]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.d(F.id).then((function(e){H(),c()})).catch((function(e){console.error(e),c()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}L&&i.isRemoving&&i.id===F.id&&"playlist"===i.type&&i.title===F.title&&function(){e.apply(this,arguments)}()}),[c,L,F,i]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.c(F.id,{films_id:[I],is_remove_films:!0}).then((function(e){N({type:"remove-film-success"})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}E&&function(){e.apply(this,arguments)}()}),[E,F,I]);var T=function(e){E||N({type:"remove-film",payload:e})};return F&&S&&!D&&Object(R.jsx)(j.a,{className:"mb-4",children:Object(R.jsxs)(j.a,{className:"p-0 border",children:[Object(R.jsx)(j.a,{ref:B,style:{height:P+"px"},className:"remove-container pt-2 pb-2 film-preview-playlist-header",sm:12,children:Object(R.jsxs)(b.a,{className:"m-0 px-2",children:[Object(R.jsx)(j.a,{className:"film-preview-playlist-title-width",children:Object(R.jsx)("p",{className:"mb-1 fw-bold film-preview-playlist-text-truncate",children:F.title})}),Object(R.jsx)(j.a,{className:"justify-content-end d-flex",children:o.id===F.author_id&&Object(R.jsx)(ie.a,{handleRemove:function(){i.isRemoving||(N({type:"field",fieldName:"isRemovingPlaylist",payload:!0}),a(F.id,"playlist",F.title))}})}),Object(R.jsxs)(j.a,{xs:12,sm:12,children:[o.id===F.author_id&&Object(R.jsx)(se.a,{id:F.id,isPublic:F.is_public,isProfile:!1,dispatchPrivacyUpdate:N}),o.id===F.author_id&&Object(R.jsx)("small",{children:"\xa0"}),Object(R.jsxs)("small",{children:[F.author_name,"\xa0"]}),Object(R.jsxs)("small",{className:"film-preview-playlist-index",children:["- ",A,"/",F.films.length]})]})]})}),Object(R.jsx)(j.a,{style:{height:S-P+"px"},className:"p-0 film-preview-playlist-container",xs:12,sm:12,children:Object(R.jsx)(te.a,{onYReachEnd:function(){},onScrollY:function(){},children:F.films.map((function(t,a){return t&&!t.isNonExisting?Object(R.jsxs)(b.a,{xs:12,sm:12,className:"m-0 p-0 remove-container",children:[Object(R.jsx)(j.a,{xs:9,sm:9,className:a===F.films.length-1?"mt-3 mb-3 ":"mt-3",onClick:function(){return e.handleRedirect(t.id)},children:Object(R.jsxs)(b.a,{className:"m-0 p-0 play-outer-container",children:[Object(R.jsx)(j.a,{xs:1,sm:1,className:"text-center justify-content-center d-flex align-items-center p-0 ps-1",children:_===t.id?Object(R.jsx)("small",{children:Object(R.jsx)(f.a,{style:{fontWeight:300},icon:"play"})}):Object(R.jsx)("small",{children:a+1})}),Object(R.jsx)(j.a,{xs:6,sm:6,className:"pe-2 ps-2",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(R.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:Object(R.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(t.id,"/thumbnail?width=small_webp")})})}),Object(R.jsxs)(j.a,{xs:5,sm:5,className:"p-0",children:[Object(R.jsx)(v.a,{line:1,text:t.title,className:"mb-0 title fw-bold"}),Object(R.jsx)("p",{className:"mb-1 author-nick-color",children:Object(R.jsx)("small",{children:t.author_name})})]})]})}),o.id===F.author_id&&Object(R.jsx)(ie.a,{handleRemove:function(){return T(t.id)}})]},t.id):Object(R.jsxs)(b.a,{xs:12,sm:12,className:"m-0 p-0 remove-container",children:[Object(R.jsx)(j.a,{xs:9,sm:9,className:a===F.films.length-1?"mt-3 mb-3 ":"mt-3",children:Object(R.jsxs)(b.a,{className:"m-0 p-0",children:[Object(R.jsx)(j.a,{xs:1,sm:1,className:"text-center justify-content-center d-flex align-items-center p-0 ps-1",children:Object(R.jsx)("small",{children:a+1})}),Object(R.jsx)(j.a,{xs:6,sm:6,className:"pe-2 ps-2",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(R.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:Object(R.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:$.a})})}),Object(R.jsx)(j.a,{xs:5,sm:5,className:"p-0",children:Object(R.jsx)(v.a,{line:2,text:"Not found",className:"mb-0 title fw-bold"})})]})}),o.id===F.author_id&&Object(R.jsx)(ie.a,{handleRemove:function(){return T(t.id)}})]},t.id)}))})})]})})},le=a(276),oe={isPreviewLoaded:!1,comments:null,commentsCount:null,playerHeight:null,reloadPlaylist:!1,error:null},de=function(e,t){switch(t.type){case"field":return Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.fieldName,t.payload));case"success":return Object(c.a)(Object(c.a)({},e),{},{isPreviewLoaded:!0,comments:t.comments,commentsCount:t.commentsCount,error:null});case"reset-comments":return Object(c.a)(Object(c.a)({},e),{},{comments:null,commentsCount:null});default:return e}},ue=function(e){var t=e.children,a=Object(n.useReducer)(de,oe),c=Object(m.a)(a,2),i=c[0],s=c[1];return Object(R.jsx)(g.Provider,{value:[i,s],children:t})};a(311);t.default=function(e){var t=Object(s.g)(),a=Object(s.h)(),n=Object(le.a)(),i=function(e){var n=l.a.parse(a.search),i={pathname:"".concat("/filmapp-react-frontend/","film/")+e};n.list&&(i=Object(c.a)(Object(c.a)({},i),{},{search:"?list=".concat(n.list)})),t.push(i)};return Object(R.jsx)(ue,{children:Object(R.jsxs)(b.a,{className:"p-0 m-0 mt-4 mx-2",children:[Object(R.jsxs)(j.a,{xs:{span:12,order:"first"},sm:8,children:[Object(R.jsx)(L,Object(c.a)({},e)),!n&&Object(R.jsx)(Z,Object(c.a)({},e))]}),Object(R.jsxs)(j.a,{xs:{span:12,order:2},sm:4,children:[Object(R.jsx)(re,Object(c.a)({handleRedirect:i},e)),Object(R.jsx)(H,Object(c.a)({handleRedirect:i},e))]}),n&&Object(R.jsx)(j.a,{xs:{span:12,order:"last"},sm:8,children:Object(R.jsx)(Z,Object(c.a)({},e))})]})})}}}]);
//# sourceMappingURL=9.4df76fa8.chunk.js.map