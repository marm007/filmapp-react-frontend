{"version":3,"sources":["components/dialogs/register.js","pages/register.js","helpers/index.js","components/input.js","reducers/auth-reducer.js"],"names":["Register","history","useHistory","login","useContext","UserContext","useReducer","authReducer","authInitialState","email","nick","password","isSubmitted","isSuccess","isSending","isError","error","dispatch","onSubmit","e","preventDefault","type","length","register","name","then","res","setTimeout","data","user","id","token","refreshToken","handleCloseModalWindow","catch","err","errorMessage","response","errors","payload","console","className","htmlFor","isInvalid","value","onChange","fieldName","target","title","onClose","displayCommentDate","comment","date","Date","parse","createdAt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","parseSearchDate","film","today","time","Math","abs","floor","UTC","toSplit","replace","pathname","location","split","historyObject","process","search","state","push","Input","placeholder","InputTag","inputRef","useRef","useEffect","current","classList","add","remove","ref","action"],"mappings":"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","file":"static/js/18.68a495ca.chunk.js","sourcesContent":["import React, { useReducer, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\n\nimport Input from '../input';\n\nimport { authInitialState, authReducer } from '../../reducers/auth-reducer';\n\nimport { register } from '../../services/authService'\nimport UserContext from '../../contexts/user/userContext'\nimport { handleCloseModalWindow } from '../../helpers';\n\nconst Register = () => {\n\n    let history = useHistory()\n\n    const { login } = useContext(UserContext)\n    const [{ email, nick, password, isSubmitted, isSuccess, isSending, isError, error }, dispatch] = useReducer(authReducer, authInitialState)\n\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n\n\n        dispatch({ type: 'submit' })\n\n        if (email && nick && password && password.length >= 6) {\n            dispatch({ type: 'send' })\n            return register({ email: email, password: password, name: nick })\n                .then(res => {\n                    dispatch({\n                        type: 'success'\n                    })\n                    setTimeout(() => {\n                        login(res.data.user.name, res.data.user.id, res.data.token, res.data.refreshToken)\n                        handleCloseModalWindow(history, '/register', true)\n                    }, 1500)\n                })\n                .catch(err => {\n                    let errorMessage = null;\n\n                    if (err.response && err.response.data && err.response.data.errors)\n                        errorMessage = err.response.data.errors;\n                    else if (err.response && err.response.data && err.response.data.error)\n                        errorMessage = err.response.data.error\n\n                    dispatch({\n                        type: 'error',\n                        payload: errorMessage\n                    })\n                    console.error(err)\n                })\n        }\n    }\n\n    return (\n        <>\n            <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <label className=\"form-label\" htmlFor=\"nick\">Nick</label>\n                    <Input isInvalid={isSubmitted && !nick} type=\"text\" name=\"nick\" value={nick}\n                        onChange={e => dispatch({ type: 'field', fieldName: 'nick', payload: e.target.value })} />\n\n                    <div className=\"invalid-feedback\">\n                        Nick is required\n                    </div>\n                </div>\n\n                <div className=\"mt-2 form-group\">\n                    <label className=\"form-label\" htmlFor=\"email\">Email</label>\n                    <Input\n                        isInvalid={(isSubmitted && !email)}\n                        type=\"email\" name=\"email\" value={email} onChange={e => dispatch({ type: 'field', fieldName: 'email', payload: e.target.value })} />\n\n                    <div className=\"invalid-feedback\">\n                        Email is required\n                    </div>\n                </div>\n\n                <div className=\"mt-2 form-group\">\n                    <label className=\"form-label\" htmlFor=\"password\">Password</label>\n                    <Input isInvalid={isSubmitted && (password.length < 6)} type=\"password\"\n                        name=\"password\" value={password}\n                        onChange={e => dispatch({ type: 'field', fieldName: 'password', payload: e.target.value })} />\n\n                    <div className=\"invalid-feedback\">\n                        {\n                            password.length === 0 ? \"Password is required\" : \"Password too short (min 6 chars)\"\n                        }\n\n                    </div>\n                </div>\n\n\n                <div className=\"d-flex align-items-center mt-2 form-group\">\n                    <button type=\"submit\" className=\"btn btn-primary\">\n                        Register\n                    </button>\n\n                    {\n                        isSending &&\n                        <div className=\"spinner-grow ml-2\" />\n                    }\n                </div>\n\n            </form>\n\n            {\n                isSuccess &&\n                <div className=\"alert alert-success mt-2\">\n                    You have successfully registered and logged in.\n                </div>\n            }\n\n            {\n                isError &&\n                <div className=\"alert alert-danger mt-2\">\n                    {error ? error : 'Error while registtering.'}\n                </div>\n            }\n\n        </>\n    );\n}\n\nexport default Register","import { useHistory } from 'react-router-dom';\n\nimport Modal from '../components/modal';\nimport RegisterComponent from '../components/dialogs/register'\n\nimport { handleCloseModalWindow } from '../helpers';\n\nexport default function Register() {\n\n    let history = useHistory()\n\n    const modalClose = () => {\n        handleCloseModalWindow(history, '/register')\n    };\n\n\n    return (\n\n        <Modal id=\"registerModal\" title=\"Register\" onClose={modalClose}>\n            <RegisterComponent />\n        </Modal>\n    );\n}","export const displayCommentDate = (comment) => {\n    let date = new Date(Date.parse(comment.createdAt));\n    let time = (('0' + date.getDate()).slice(-2) + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-'\n        + ('0' + date.getFullYear()).slice(-2)\n        + ' o ' + ('0' + date.getHours()).slice(-2) + ':' + ('0' + date.getMinutes()).slice(-2))\n    return time;\n};\n\nexport const parseSearchDate = (film) => {\n\n    let date = new Date(Date.parse(film.createdAt));\n    let today = new Date();\n\n\n    let time = Math.abs(Math.floor((\n        Date.UTC(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours(),\n            date.getMinutes()) -\n        Date.UTC(\n            today.getFullYear(),\n            today.getMonth(),\n            today.getDate(),\n            today.getHours(),\n            today.getMinutes()))\n        / (1000 * 60)));\n\n    if (time / 60 >= 1) {\n        time /= 60;\n\n        if (time / 24 >= 1) {\n\n            time /= 24;\n\n            if (time / 30 >= 1) {\n\n                time /= 30;\n\n                if (time / 12 >= 1) {\n\n                    time = time / 12;\n                    time = Math.floor(time) + ' years ';\n\n                } else {\n                    time = Math.floor(time) + ' months ';\n                }\n\n            } else {\n                time = Math.floor(time) + ' days ';\n            }\n\n        } else {\n            time = Math.floor(time) + ' hours ';\n        }\n    } else {\n        time = Math.floor(time) + ' minutes ';\n    }\n\n    time = time + 'ago';\n\n    return time;\n};\n\nexport const handleCloseModalWindow = (history, toSplit, replace = false) => {\n\n    let pathname = history.location.pathname.split(toSplit)[0]\n\n    const historyObject = {\n        pathname: pathname === '' ? process.env.REACT_APP_PATH_NAME : pathname,\n        search: history.location.search,\n        state: history.location.state\n    }\n\n    if (replace) {\n        history.replace(historyObject)\n    }\n    else {\n        history.push(historyObject)\n    }\n\n}","import { useEffect, useRef } from \"react\"\n\nconst Input = ({ isInvalid, onChange, type, name, value, placeholder = '' }) => {\n\n    const InputTag = type === 'textarea' ? 'textarea' : 'input'\n\n    const inputRef = useRef(null)\n\n    useEffect(() => {\n        let ref = inputRef.current\n        if (ref) {\n            if (isInvalid) inputRef.current.classList.add('is-invalid')\n            else inputRef.current.classList.remove('is-invalid')\n        }\n    }, [isInvalid])\n\n    return (\n        <InputTag ref={inputRef} className=\"form-control\"\n            placeholder={placeholder}\n            type={type} name={name}\n            value={value} onChange={onChange} />\n    )\n}\n\nexport default Input","\nexport const authInitialState = {\n    email: '',\n    nick: '',\n    password: '',\n    isSubmitted: false,\n    isSending: false,\n    isSuccess: false,\n    isError: false,\n    error: null\n}\n\nexport const authReducer = (state, action) => {\n    switch (action.type) {\n        case 'field': {\n            return {\n                ...state,\n                isSubmitted: false,\n                [action.fieldName]: action.payload\n            }\n        }\n        case 'submit': {\n            return {\n                ...state,\n                isError: false,\n                error: null,\n                isSubmitted: true\n            }\n        }\n        case 'send': {\n            return {\n                ...state,\n                isSending: true\n            }\n        }\n        case 'success': {\n            return {\n\n                ...state,\n                isError: false,\n                error: null,\n                isSending: false,\n                isSuccess: true\n            }\n        }\n        case 'error': {\n            return {\n                ...state,\n                isSending: false,\n                isError: true,\n                error: action.payload\n            }\n        }\n        default: return state\n    }\n}"],"sourceRoot":""}