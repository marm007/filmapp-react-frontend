(this.webpackJsonpfilmapp_frontened=this.webpackJsonpfilmapp_frontened||[]).push([[9,3],{509:function(e,t,c){"use strict";c.r(t);var n=c(15),i=c(7),a=c(569),s=c.n(a),r=c(524),o=c.n(r),l=c(525),d=c(44),u=c(1),p=c(530),m=c(559),j=c(668),b=c(547),f=c.n(b),h=(c(685),c(136)),O={film:{img:"",video:"",film:"",title:"",views:"",likes:"",dislikes:"",description:"\r\n\n\n"},isLiked:!1,isDisliked:!1,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1};function v(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"like":return Object(n.a)(Object(n.a)({},e),{},{isLikeButtonClicked:!0,likeAction:t.payload});case"success":return Object(n.a)(Object(n.a)({},e),{},{film:t.film,isLiked:t.isLiked,isDisliked:t.isDisliked,isLikeButtonClicked:!1,likeAction:null,isDescExpanded:!1});case"error":return Object(n.a)(Object(n.a)({},e),{},{isLikeButtonClicked:!1,likeAction:null});default:return e}}var x=c(540),y=c(544),g=Object(u.createContext)(),w=c(80),N=(c(582),c(2)),k=function(){var e=Object(i.g)(),t=Object(i.h)(),c=Object(i.i)().id,a=Object(u.useContext)(w.a).user,s=Object(u.useContext)(g),r=Object(d.a)(s,2),b=(r[0],r[1]),h=Object(u.useCallback)((function(e){null!==e&&(b({type:"field",fieldName:"playerHeight",payload:e.getBoundingClientRect().height}),H(e))}),[b]),k=Object(u.useReducer)(v,O),C=Object(d.a)(k,2),L=C[0],E=C[1],R=L.film,F=L.isLiked,D=L.isDisliked,P=L.isLikeButtonClicked,A=L.likeAction,_=L.isDescExpanded,I=Object(u.useState)(null),S=Object(d.a)(I,2),M=S[0],H=S[1];Object(u.useEffect)((function(){if(M){var e=function(){b({type:"field",fieldName:"playerHeight",payload:M.getBoundingClientRect().height})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[M,b]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var t,i,s,r,l,u,p,m,j,f,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[x.i(c),x.c(c)],a.auth&&t.push(y.a({details:!0})),e.next=4,Promise.allSettled(t);case 4:if(i=e.sent,s=Object(d.a)(i,3),r=s[0],l=s[1],u=s[2],"rejected"!==l.status&&"rejected"!==r.status){e.next=12;break}return b({type:"field",fieldName:"error",payload:!0}),e.abrupt("return");case 12:p=l.value.data,b({type:"success"}),m=Object(n.a)(Object(n.a)({},p),{},{img:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(p.id,"/thumbnail?width=poster"),video:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(p.id,"/video"),views:r.value.data.views}),j=!1,f=!1,u&&"fulfilled"===u.status&&(h=u.value.data.details,j=h.liked.indexOf(c)>-1,f=h.disliked.indexOf(c)>-1),E({type:"success",film:m,isLiked:j,isDisliked:f});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c,b,a.auth,e.location.state]),Object(u.useEffect)((function(){function c(){return(c=Object(l.a)(o.a.mark((function c(){var n,i,a,s,r,l;return o.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(null!==A){c.next=2;break}return c.abrupt("return");case 2:return c.prev=2,c.next=5,x.e(R.id,{action:A});case 5:return n=c.sent,(i=n.data).img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(i.id,"/thumbnail?width=poster"),i.video="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(i.id,"/video"),c.next=11,y.a({details:!0});case 11:a=c.sent,s=a.data.details,r=s.liked.indexOf(i.id)>-1,l=s.disliked.indexOf(i.id)>-1,E({type:"success",film:i,isLiked:r,isDisliked:l}),c.next=23;break;case 18:c.prev=18,c.t0=c.catch(2),console.error(c.t0),E({type:"error"}),c.t0.response&&401===c.t0.response.status&&e.push("".concat(t.pathname,"/login"));case 23:case"end":return c.stop()}}),c,null,[[2,18]])})))).apply(this,arguments)}P&&function(){c.apply(this,arguments)}()}),[R.id,P,A,e,t]);var T=function(e){e.preventDefault(),E({type:"field",fieldName:"isDescExpanded",payload:!_})},B=function(e){P||E({type:"like",payload:e})},U=function(e){return Object(N.jsx)("span",{children:Object(N.jsx)("button",{className:"btn btn-link p-0 m-0 mb-1 title font-weight-bold",onClick:T,children:e})})};return Object(N.jsxs)("div",{className:"p-0",children:[Object(N.jsx)("div",{className:"col-12 col-sm-12 preview-margins p-0",children:Object(N.jsx)("div",{ref:h,children:Object(N.jsx)(j.Player,{playsInline:!0,poster:R.img,src:R.video})})}),R&&Object(N.jsxs)("div",{className:"px-0",children:[Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 p-0",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",children:[!R.title&&Object(N.jsx)("p",{className:"font-weight-bold",children:Object(N.jsx)("br",{})}),Object(N.jsx)("p",{className:"font-weight-bold",children:R.title})]}),Object(N.jsx)("div",{className:"col-4 col-sm-4 p-0",children:Object(N.jsxs)("p",{children:[Object(N.jsx)(p.a,{icon:m.b})," \u2002",R.views]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4 text-right d-flex justify-content-end",children:Object(N.jsxs)("p",{className:"".concat(F?"film-picked-thumb-color":""," cursor-pointer noselect"),onClick:function(){return B("like")},children:[Object(N.jsx)(p.a,{icon:m.f}),"\u2002",R.likes]})}),Object(N.jsx)("div",{className:"col-4 col-sm-4 d-flex justify-content-start",children:Object(N.jsxs)("p",{className:"".concat(D?"film-picked-thumb-color":""," cursor-pointer noselect"),onClick:function(){return B("dislike")},children:[Object(N.jsx)(p.a,{icon:m.e}),"\u2002",R.dislikes]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-4 divider"}),Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",style:{whiteSpace:"pre-line",textAlign:"justify"},children:[Object(N.jsx)(f.a,{line:!_&&2,truncateText:"\u2026",text:R.description,textTruncateChild:U("Show more")}),_&&U("Show less")]})]})}),Object(N.jsx)("div",{className:"col-12 col-sm-12 mt-4 mb-2 divider p-0"})]})]})},C=c(536),L=c(535),E={films:null,isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,error:null};function R(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return E;case"initial-success":return Object(n.a)(Object(n.a)({},E),{},{films:t.films,isInitialLoaded:!0});case"load":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"success":return Object(n.a)(Object(n.a)({},e),{},{films:[].concat(Object(C.a)(e.films),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<L.e});case"error":return Object(n.a)(Object(n.a)({},E),{},{error:t.payload});default:return e}}var F=c(564),D=c(541),P=c(562),A=c.n(P),_=function(){return Object(N.jsx)("div",{className:"col-12 mx-0 mb-4 container-px",children:Object(N.jsxs)("div",{className:"row p-0 m-0",children:[Object(N.jsx)("div",{className:"col-6 col-sm-6 m-0 p-0",children:Object(N.jsx)("div",{className:"embed-responsive embed-responsive-16by9 p-0",children:Object(N.jsx)(A.a,{className:"embed-responsive-item w-100 h-100 p-0"})})}),Object(N.jsxs)("div",{className:"col-6 col-sm-6 m-0",children:[Object(N.jsx)("div",{className:"row m-0 h-25",children:Object(N.jsx)("div",{className:"col p-0 w-100 h-100",children:Object(N.jsx)(A.a,{className:"w-100 h-100 line-height-unset"})})}),Object(N.jsx)("div",{className:"pt-2 h-75",children:Object(N.jsx)(A.a,{className:"w-100 h-100 line-height-unset"})})]})]})})},I=c(550),S=c(545),M=function(e){var t=e.handleRedirect,c=Object(i.i)().id,n=Object(S.a)(768),a=Object(u.useContext)(g),s=Object(d.a)(a,2),r=s[0],p=s[1],m=Object(u.useReducer)(R,E),j=Object(d.a)(m,2),b=j[0],f=j[1],h=b.films,O=b.isLoading,v=b.isAllFetched,y=b.isInitialLoaded,w=b.error,k=Object(u.useCallback)((function(){O||v||!y||w||!c||f({type:"load"})}),[O,v,y,w,c]);return Object(D.a)(k),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a({exclude:c,limit:L.e,preview:!0}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),f({type:"initial-success",films:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f({type:"clear"}),r.isPreviewLoaded&&function(){e.apply(this,arguments)}()}),[c,r.isPreviewLoaded]),Object(u.useEffect)((function(){r.error&&f({type:"error",payload:r.error})}),[r.error]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a({exclude:c,skip:h.length,limit:L.e,preview:!0}).then((function(e){var t=e.data;t.forEach((function(e){e.img="".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})),f({type:"success",payload:t})})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}O&&h&&c&&function(){e.apply(this,arguments)}()}),[O,c,h]),Object(N.jsxs)("div",{className:"row m-0",children:[h?h.map((function(e,c){return Object(N.jsx)(F.a,{film:e,index:c,isRecommendations:!0,filmDispatch:p,handleRedirect:function(){return t(e)}},e.id)})):Object(C.a)(Array(20)).map((function(e,t){return n?Object(N.jsx)(I.a,{isRecommendations:!0},t):Object(N.jsx)(_,{},t)})),!v&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:O&&!w&&Object(N.jsx)("div",{className:"spinner-border"})})]})},H={comments:null,commentsCount:null,text:"",isLoading:!1,isAllFetched:!1,isInitialLoaded:!1,isAdding:!1,isRemoving:!1,toRemove:null,isSorting:!1,sort:null,sorts:[{id:"created_at",title:"By date",dir:1},{id:"author_name",title:"By author name",dir:1}],error:null};function T(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"clear":return Object(n.a)({},H);case"load":return e.isLoading||e.isAllFetched||!e.isInitialLoaded||e.isAdding||e.error||e.isSorting?e:Object(n.a)(Object(n.a)({},e),{},{isLoading:!0});case"initial-success":return Object(n.a)(Object(n.a)({},e),{},{comments:t.comments,commentsCount:t.commentsCount,isAllFetched:t.comments.length<L.a,isInitialLoaded:!0,error:null});case"load-success":return Object(n.a)(Object(n.a)({},e),{},{comments:[].concat(Object(C.a)(e.comments),Object(C.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<L.a});case"add":return Object(n.a)(Object(n.a)({},e),{},{isAdding:!0,error:null});case"add-success":return Object(n.a)(Object(n.a)({},e),{},{text:"",commentsCount:e.commentsCount+1,comments:[t.payload].concat(Object(C.a)(e.comments)),isAdding:!1});case"remove":return Object(n.a)(Object(n.a)({},e),{},{isRemoving:!0,toRemove:t.payload});case"remove-success":return Object(n.a)(Object(n.a)({},e),{},{isRemoving:!1,toRemove:null,commentsCount:e.commentsCount-1,comments:e.toRemove?e.comments.filter((function(t){return t.id!==e.toRemove.id})):e.data});case"sort":return Object(n.a)(Object(n.a)({},e),{},{comments:null,isAllFetched:!1,sorts:e.sorts.map((function(e){return e.id===t.sortToChange.id?t.sortToChange:e})),sort:t.sort,isSorting:!0});case"sort-success":return Object(n.a)(Object(n.a)({},e),{},{isSorting:!1,comments:t.payload});case"error":return Object(n.a)(Object(n.a)({},e),{},{isAdding:!1,isLoading:!1,isSorting:!1,error:t.payload});default:return e}}var B=c(41),U=c(137),W=function(e,t){return B.a.get("films/".concat(e,"/comments"),{params:t})},z=function(e){return B.a.delete("comments/".concat(e),{headers:Object(U.a)()})},Y=function(e,t){return B.a.get("films/".concat(e,"/comments/sort"),{params:t,headers:Object(U.a)()})},q=c(538),J=c(81),$=c(537),G=function(){var e=Object(i.i)().id,t=Object(u.useContext)(J.a),c=t.showModal,n=t.clear,a=t.removeModalData,s=Object(u.useContext)(w.a).user,r=Object(u.useContext)(g),m=Object(d.a)(r,2),j=m[0],b=(m[1],Object(u.useReducer)(T,H)),f=Object(d.a)(b,2),O=f[0],v=f[1],y=O.comments,k=O.commentsCount,C=O.text,E=O.isInitialLoaded,R=O.isLoading,F=O.isAllFetched,P=O.isAdding,A=O.isRemoving,_=O.toRemove,I=O.isSorting,S=O.sort,M=O.sorts,G=O.error,K=Object(u.useCallback)((function(){R||F||!E||P||G||!e||I||v({type:"load"})}),[R,F,E,P,G,e,I]);Object(D.a)(K),Object(u.useEffect)((function(){j.error&&v({type:"error",payload:j.error})}),[j.error]),Object(u.useEffect)((function(){var t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.d(e).then((function(e){v({type:"initial-success",comments:e.data.comments,commentsCount:e.data.comments_count})})).catch((function(e){console.error(e),v({type:"error",payload:"Something went wrong!"})}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();j.isPreviewLoaded&&t()}),[e,j.isPreviewLoaded]),Object(u.useEffect)((function(){function t(){return(t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W(e,{skip:y.length,limit:L.a}).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function c(){return(c=Object(l.a)(o.a.mark((function t(){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(e,(c={},Object(h.a)(c,S.id,S.dir),Object(h.a)(c,"skip",y.length),Object(h.a)(c,"limit",L.a),c)).then((function(e){v({type:"load-success",payload:e.data})})).catch((function(e){v({type:"error"})}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}R&&E&&!P&&y&&e&&!I&&(S?function(){c.apply(this,arguments)}():function(){t.apply(this,arguments)}())}),[R,P,e,y,E,I,S]),Object(u.useEffect)((function(){P&&!R&&e&&function(){var t=Object(l.a)(o.a.mark((function t(){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={text:C},t.next=3,(n=e,i=c,B.a.post("films/".concat(n,"/comments"),i,{headers:Object(U.a)()})).then((function(e){v({type:"add-success",payload:e.data})})).catch((function(e){v({type:"error",payload:e.response.status})}));case 3:case"end":return t.stop()}var n,i}),t)})));return function(){return t.apply(this,arguments)}}()()}),[P,R,e,C]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(_.id).then((function(e){v({type:"remove-success"}),n()})).catch((function(e){n(),console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}A&&_&&a.isRemoving&&a.id===_.id&&"comment"===a.type&&a.title===_.text.substring(0,10).concat("...")&&function(){e.apply(this,arguments)}()}),[A,_,n,a]),Object(u.useEffect)((function(){function t(){return(t=Object(l.a)(o.a.mark((function t(){var c,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=S?(c={},Object(h.a)(c,S.id,S.dir),Object(h.a)(c,"limit",L.a),c):{},t.next=3,Y(e,n).then((function(e){v({type:"sort-success",payload:e.data})})).catch((function(e){v({type:"error",payload:"Sort error."}),console.error(e)}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}I&&function(){t.apply(this,arguments)}()}),[I,S,e]);return Object(N.jsxs)("div",{className:"col p-0",children:[Object(N.jsxs)("div",{className:"row p-0 mt-4 mb-4",children:[Object(N.jsx)("div",{className:"col-7 col-sm-5 col-md-4 d-flex align-items-center ",children:null!==k&&Object(N.jsxs)("span",{children:[k,1===k?" comment":" comments"," "]})}),Object(N.jsxs)("div",{className:"dropdown col-2 col-sm-2",children:[Object(N.jsx)("button",{className:"btn btn-secondary dropdown-toggle",id:"sortDropDown","data-toggle":"dropdown","aria-expanded":"false",children:"Sort"}),Object(N.jsx)("ul",{className:"dropdown-menu","aria-labelledby":"#sortDropDown",children:M.map((function(e){return Object(N.jsx)("li",{onClick:function(t){return function(e,t){e.preventDefault();var c=null;switch(t){case"created_at":c=M[0];break;case"author_name":c=M[1];break;default:return}var n=null;S&&S.id===c.id?(c.dir*=-1,n=c,1===c.dir&&(n=null)):n=c,v({type:"sort",sortToChange:c,sort:n})}(t,e.id)},children:Object(N.jsxs)("a",{className:"dropdown-item".concat(S&&e.id===S.id?" active":""),href:"#",role:"button",children:[e.title,S&&S.id===e.id&&1===e.dir?Object(N.jsx)(p.a,{className:"ml-2",icon:"sort-up"}):S&&S.id===e.id&&-1===e.dir?Object(N.jsx)(p.a,{className:"ml-2",icon:"sort-down"}):""]})},e.id)}))})]})]}),Object(N.jsxs)("form",{onSubmit:function(e){return C&&!P?function(e){e.preventDefault(),v({type:"add"})}(e):null},children:[Object(N.jsx)("div",{id:"fiordur",children:Object(N.jsx)("input",{type:"text",placeholder:"Comment",value:C,onChange:function(e){return v({type:"field",fieldName:"text",payload:e.target.value})}})}),Object(N.jsx)("div",{className:"col d-flex justify-content-end",children:Object(N.jsx)("button",{disabled:P||!C,type:"submit",className:"btn btn-primary mt-3",children:"Submit"})})]}),P&&Object(N.jsx)("div",{style:{height:"32px"},className:"d-flex justify-content-center",children:Object(N.jsx)("div",{className:"spinner-border"})}),y&&y.map((function(e){return Object(N.jsxs)("div",{className:"col col-sm-12 p-0 mt-4 remove-container",children:[Object(N.jsxs)("div",{className:"d-flex",children:[Object(N.jsx)("p",{className:"m-0 font-weight-bold",children:Object(N.jsxs)("small",{className:"m-0 font-weight-bold",children:[e.author_name,"\xa0"]})}),Object(N.jsx)("p",{children:Object(N.jsx)("small",{className:"m-0",children:Object(q.a)(e)})}),s.id===e.author_id&&Object(N.jsx)($.a,{className:"m-button cursor-pointer button-ripple-24 d-flex justify-content-center align-items-center remove-holder p-0 m-0 ml-auto",onClick:function(){return function(e){a.isRemoving||(v({type:"remove",payload:e}),c(e.id,"comment",e.text.substring(0,10).concat("...")))}(e)},children:Object(N.jsx)(p.a,{icon:"trash-alt"})})]}),Object(N.jsx)("p",{className:"d-block d-sm-block",children:Object(N.jsx)("small",{children:e.text})})]},e.id)})),!F&&Object(N.jsx)("div",{className:"fetch-loader d-flex justify-content-center",children:(R||I)&&!G&&Object(N.jsx)("div",{className:"spinner-border"})})]})},K=c(686),Q=c.n(K),V=(c(689),{playlist:null,currentFilm:null,currentFilmIndex:0,isLoading:!1,isRemovingPlaylist:!1,isRemovingFilm:!1,removingFilmId:null,headerHeight:null,playerHeight:null}),X=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!1,playlist:t.playlist,currentFilm:t.currentFilm,currentFilmIndex:t.currentFilmIndex});case"clear":return V;case"remove-film":return Object(n.a)(Object(n.a)({},e),{},{removingFilmId:t.payload,isRemovingFilm:!0});case"remove-film-success":if(!e.removingFilmId)return Object(n.a)(Object(n.a)({},e),{},{isRemovingFilm:!1});var c=e.playlist.films.filter((function(t){return t.id!==e.removingFilmId}));return Object(n.a)(Object(n.a)({},e),{},{currentFilm:e.removingFilmId===e.currentFilm?null:e.currentFilm,currentFilmIndex:e.removingFilmId===e.currentFilm?0:c.findIndex((function(t){return t.id===e.currentFilm}))+1,playlist:Object(n.a)(Object(n.a)({},e.playlist),{},{films:c}),isRemovingFilm:!1});case"change-playlist-privacy-success":return Object(n.a)(Object(n.a)({},e),{},{playlist:Object(n.a)(Object(n.a)({},e.playlist),{},{is_public:t.payload.is_public})});case"error":return Object(n.a)(Object(n.a)({},e),{},{isLoading:!1,error:t.payload});default:return e}},Z=c(553),ee=c(542),te=c(549),ce=c(548),ne=c(581),ie=function(e){var t=e.handleRedirect,c=Object(u.useContext)(J.a),n=c.showModal,a=c.clear,r=c.removeModalData,m=Object(i.i)().id,j=Object(i.h)(),b=Object(u.useContext)(w.a).user,h=Object(u.useContext)(g),O=Object(d.a)(h,2),v=O[0],x=O[1],y=Object(u.useReducer)(X,V),k=Object(d.a)(y,2),C=k[0],L=k[1],E=C.playlist,R=C.isRemovingPlaylist,F=C.isRemovingFilm,D=C.removingFilmId,P=C.currentFilm,A=C.currentFilmIndex,_=C.headerHeight,I=C.playerHeight,S=C.error,M=function(){L({type:"clear"})},H=Object(u.useCallback)((function(e){null!==e&&L({type:"field",fieldName:"headerHeight",payload:e.getBoundingClientRect().height})}),[]);Object(u.useEffect)((function(){L({type:"field",fieldName:"playerHeight",payload:v.playerHeight})}),[v.playerHeight]),Object(u.useEffect)((function(){L({type:"error",payload:v.error})}),[v.error]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.b(E.id).then((function(e){var t=0,c=null;return Array.prototype.forEach.call(e.data.films,(function(e,n){e&&e.id===m&&(t=n+1,c=e.id)})),L({type:"success",playlist:e.data,currentFilm:c,currentFilmIndex:t}),x({type:"field",fieldName:"reloadPlaylist",payload:!1}),e.data})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}v.reloadPlaylist&&E&&function(){e.apply(this,arguments)}()}),[v.reloadPlaylist,E,x,m]),Object(u.useEffect)((function(){var e=s.a.parse(j.search);function t(){return(t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee.b(e.list).then((function(e){var t=0,c=null;return Array.prototype.forEach.call(e.data.films,(function(e,n){e&&e.id===m&&(t=n+1,c=e.id)})),L({type:"success",playlist:e.data,currentFilm:c,currentFilmIndex:t}),e.data})).catch((function(e){console.error(e),M()}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.list?!S&&v.isPreviewLoaded&&function(){t.apply(this,arguments)}():M()}),[m,j.search,S,v.isPreviewLoaded]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.d(E.id).then((function(e){M(),a()})).catch((function(e){console.error(e),a()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&r.isRemoving&&r.id===E.id&&"playlist"===r.type&&r.title===E.title&&function(){e.apply(this,arguments)}()}),[a,R,E,r]),Object(u.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.c(E.id,{films_id:[D],is_remove_films:!0}).then((function(e){L({type:"remove-film-success"})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}F&&function(){e.apply(this,arguments)}()}),[F,E,D]);return E&&I&&!S&&Object(N.jsx)("div",{className:"col mb-4",children:Object(N.jsxs)("div",{className:"col p-0 border",children:[Object(N.jsx)("div",{ref:H,style:{height:_+"px"},className:"col remove-container pt-2 pb-2 film-preview-playlist-header",sm:12,children:Object(N.jsxs)("div",{className:"row m-0 px-2",children:[Object(N.jsx)("div",{className:"button-ripple-div-next-width colbutton-ripple-div-next-width",children:Object(N.jsx)("p",{className:"mb-1 font-weight-bold film-preview-playlist-text-truncate",children:E.title})}),Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 justify-content-end d-flex",children:b.id===E.author_id&&Object(N.jsx)(te.a,{handleRemove:function(){r.isRemoving||(L({type:"field",fieldName:"isRemovingPlaylist",payload:!0}),n(E.id,"playlist",E.title))}})}),Object(N.jsxs)("div",{className:"col-12 col-sm-12 p-0",children:[b.id===E.author_id&&Object(N.jsx)(ce.a,{id:E.id,isPublic:E.is_public,isPlaylist:!0,dispatchPrivacyUpdate:L}),b.id===E.author_id&&Object(N.jsx)("small",{children:"\xa0"}),Object(N.jsxs)("small",{children:[E.author_name,"\xa0"]}),Object(N.jsxs)("small",{className:"film-preview-playlist-index",children:["- ",A,"/",E.films.length]})]})]})}),Object(N.jsx)("div",{style:{height:I-_+"px"},className:"col-12 col-sm-12 p-0 film-preview-playlist-container",children:Object(N.jsx)(Q.a,{onYReachEnd:function(){},onScrollY:function(){},children:E.films.map((function(e,c){return Object(N.jsxs)("div",{className:"row m-0 p-0 pr-2 remove-container",children:[Object(N.jsx)("div",{className:"".concat(c===E.films.length-1?"mt-3 mb-3 ":"mt-3"," button-ripple-div-next-width col"),onClick:function(){e.isNonExisting||t(e)},children:Object(N.jsxs)("div",{className:"row m-0 p-0 play-outer-container",children:[Object(N.jsx)("div",{className:"col-1 col-sm-1 text-center justify-content-center d-flex align-items-center p-0 pl-1",children:P===e.id?Object(N.jsx)("small",{children:Object(N.jsx)(p.a,{style:{fontWeight:300},icon:"play"})}):Object(N.jsx)("small",{children:c+1})}),Object(N.jsx)("div",{className:"col-6 col-sm-6 pr-2 pl-2",children:Object(N.jsx)("div",{className:"w-100 play-container",children:e.isNonExisting?Object(N.jsx)("img",{alt:"",className:"embed-responsive-item play-image",src:ne.a}):Object(N.jsx)(Z.a,{image:"".concat("https://marm007-filmapp-backend-node.herokuapp.com/api/","films/").concat(e.id,"/thumbnail")})})}),Object(N.jsx)("div",{className:"col-5 col-sm-5 p-0",children:e.isNonExisting?Object(N.jsx)(f.a,{line:2,text:"Not found",className:"mb-0 title font-weight-bold"}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(f.a,{line:1,text:e.title,className:"mb-0 title font-weight-bold"}),Object(N.jsx)("p",{className:"mb-1 author-nick",children:Object(N.jsx)("span",{children:e.author_name})})]})})]})}),b.id===E.author_id&&Object(N.jsx)("div",{style:{width:"24px"},className:"p-0 d-flex align-items-center justify-content-center",children:Object(N.jsx)(te.a,{handleRemove:function(){return function(e){F||L({type:"remove-film",payload:e})}(e.id)}})})]},e.id)}))})})]})})},ae={isPreviewLoaded:!1,playerHeight:null,reloadPlaylist:!1,error:null},se=function(e,t){switch(t.type){case"field":return Object(n.a)(Object(n.a)({},e),{},Object(h.a)({},t.fieldName,t.payload));case"success":return Object(n.a)(Object(n.a)({},e),{},{isPreviewLoaded:!0,error:null});default:return e}},re=function(e){var t=e.children,c=Object(u.useReducer)(se,ae),n=Object(d.a)(c,2),i=n[0],a=n[1];return Object(N.jsx)(g.Provider,{value:[i,a],children:t})};c(556),t.default=function(){var e=Object(i.g)(),t=Object(i.h)(),c=Object(S.a)(768),a=function(c){var i=s.a.parse(t.search),a={pathname:"".concat("/filmapp-react-frontend/","film/")+c.id,state:{film:c}};i.list&&(a=Object(n.a)(Object(n.a)({},a),{},{search:"?list=".concat(i.list)})),e.push(a)};return Object(N.jsx)(re,{children:Object(N.jsxs)("div",{className:"row p-0 m-0 mt-4 mx-2",children:[Object(N.jsxs)("div",{className:"col-12 order-first col-sm-12 order-first col-md-8 film-preview-container-px",children:[Object(N.jsx)(k,{}),!c&&Object(N.jsx)(G,{})]}),Object(N.jsxs)("div",{className:"col-12 order-2 col-sm-12 order-2 col-md-4 p-0",children:[Object(N.jsx)(ie,{handleRedirect:a}),Object(N.jsx)(M,{handleRedirect:a})]}),c&&Object(N.jsx)("div",{className:"col-12 order-last col-sm-12 order-sm-last col-md-8 pb-5 container-px",children:Object(N.jsx)(G,{})})]})})}},535:function(e,t,c){"use strict";c.d(t,"a",(function(){return n})),c.d(t,"e",(function(){return i})),c.d(t,"d",(function(){return a})),c.d(t,"b",(function(){return s})),c.d(t,"c",(function(){return r})),c.d(t,"f",(function(){return o}));var n=10,i=12,a=10,s=40,r=20,o=10},537:function(e,t,c){"use strict";var n=c(15),i=c(44),a=c(140),s=c(561),r=c.n(s),o=c(2),l=["onClick","children","className","id"];t.a=function(e){var t=e.onClick,c=void 0===t?function(){}:t,s=e.children,d=e.className,u=e.id,p=Object(a.a)(e,l),m=r()({background:"black"}),j=Object(i.a)(m,2),b=j[0],f=j[1];return Object(o.jsxs)("button",Object(n.a)(Object(n.a)({id:u||"",onClick:function(e){c(e)},onMouseDown:b,className:"btn btn-link button-ripple text-dark ".concat(d)},p),{},{children:[s,f]}))}},538:function(e,t,c){"use strict";c.d(t,"a",(function(){return n})),c.d(t,"c",(function(){return i})),c.d(t,"b",(function(){return a}));var n=function(e){var t=new Date(Date.parse(e.createdAt));return("0"+t.getDate()).slice(-2)+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getFullYear()).slice(-2)+" o "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)},i=function(e){var t=new Date(Date.parse(e.createdAt)),c=new Date,n=Math.abs(Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())-Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()))/6e4));return n/60>=1?(n/=60)/24>=1?(n/=24)/30>=1?(n/=30)/12>=1?(n/=12,n=Math.floor(n)+" years "):n=Math.floor(n)+" months ":n=Math.floor(n)+" days ":n=Math.floor(n)+" hours ":n=Math.floor(n)+" minutes ",n+="ago"},a=function(e,t){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.location.pathname.split(t)[0],i={pathname:""===n?"/filmapp-react-frontend/":n,search:e.location.search,state:e.location.state};c?e.replace(i):e.push(i)}},540:function(e,t,c){"use strict";c.d(t,"a",(function(){return a})),c.d(t,"c",(function(){return s})),c.d(t,"d",(function(){return r})),c.d(t,"h",(function(){return o})),c.d(t,"i",(function(){return l})),c.d(t,"b",(function(){return d})),c.d(t,"f",(function(){return u})),c.d(t,"e",(function(){return p})),c.d(t,"g",(function(){return m}));var n=c(41),i=c(137),a=function(e){return n.a.get("films/",{params:e})},s=function(e){return n.a.get("films/".concat(e))},r=function(e){return n.a.get("films/".concat(e,"/details"))},o=function(e){return n.a.get("films/search",{params:e})},l=function(e){return n.a.patch("films/".concat(e,"/view"))},d=function(e){return n.a.post("films",e,{headers:Object(i.a)()})},u=function(e,t){return n.a.patch("films/".concat(e),t,{headers:Object(i.a)()})},p=function(e,t){return n.a.patch("films/".concat(e,"/action"),t,{headers:Object(i.a)()})},m=function(e){return n.a.delete("films/".concat(e),{headers:Object(i.a)()})}},541:function(e,t,c){"use strict";var n=c(1),i=c(554),a=c.n(i),s=function(e,t,c){return e?a()(t,e,c):t};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=Object(n.useMemo)((function(){var e,c,n,i,a;return{offset:null!==(e=null===t||void 0===t?void 0:t.offset)&&void 0!==e?e:20,debounce:null!==(c=null===t||void 0===t?void 0:t.debounce)&&void 0!==c?c:200,debounceOptions:null!==(n=null===t||void 0===t?void 0:t.debounceOptions)&&void 0!==n?n:{leading:!0},triggerOnNoScroll:null!==(i=null===t||void 0===t?void 0:t.triggerOnNoScroll)&&void 0!==i&&i,id:null!==(a=null===t||void 0===t?void 0:t.id)&&void 0!==a?a:null}}),[null===t||void 0===t?void 0:t.offset,null===t||void 0===t?void 0:t.debounce,null===t||void 0===t?void 0:t.debounceOptions,null===t||void 0===t?void 0:t.triggerOnNoScroll,null===t||void 0===t?void 0:t.id]),i=c.offset,a=c.triggerOnNoScroll,r=c.debounce,o=c.debounceOptions,l=c.id,d=Object(n.useMemo)((function(){return s(r,e,o)}),[e,r,o]),u=Object(n.useRef)(null),p=Object(n.useCallback)((function(){if(null!=u.current){var e=u.current,t=Math.round(e.scrollTop+e.clientHeight);Math.round(e.scrollHeight-i)<=t&&d()}else if(null!==l){var c=document.getElementById(l);if(c){var n=Math.round(c.scrollTop+c.clientHeight);Math.round(c.scrollHeight-i)<=n&&d()}}else{var a=document.scrollingElement||document.documentElement,s=Math.round(a.scrollTop+window.innerHeight);Math.round(a.scrollHeight-i)<=s&&d()}}),[d,i,l]);return Object(n.useEffect)((function(){var e=u.current,t=document.getElementById(l);return null!=e?e.addEventListener("scroll",p):null!==t?t.addEventListener("scroll",p):window.addEventListener("scroll",p),a&&p(),function(){null!=e?e.removeEventListener("scroll",p):null!==t?t.addEventListener("scroll",p):window.removeEventListener("scroll",p)}}),[p,a,l]),u}},542:function(e,t,c){"use strict";c.d(t,"a",(function(){return a})),c.d(t,"b",(function(){return s})),c.d(t,"e",(function(){return r})),c.d(t,"c",(function(){return o})),c.d(t,"d",(function(){return l}));var n=c(41),i=c(137),a=function(e){return n.a.post("playlists",e,{headers:Object(i.a)()})},s=function(e){return n.a.get("playlists/".concat(e),{headers:Object(i.a)()})},r=function(e){return n.a.get("playlists",{params:e,headers:Object(i.a)()})},o=function(e,t){return n.a.patch("playlists/".concat(e),t,{headers:Object(i.a)()})},l=function(e){return n.a.delete("playlists/".concat(e),{headers:Object(i.a)()})}},544:function(e,t,c){"use strict";c.d(t,"a",(function(){return a})),c.d(t,"b",(function(){return s}));var n=c(41),i=c(137),a=function(e){return n.a.get("users/me",{params:e,headers:Object(i.a)()})},s=function(e){return n.a.patch("users",e,{headers:Object(i.a)()})}},545:function(e,t,c){"use strict";var n=c(44),i=c(1);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600,t=Object(i.useState)(window.innerWidth<e),c=Object(n.a)(t,2),a=c[0],s=c[1],r=function(){s(window.innerWidth<e)};return Object(i.useEffect)((function(){return r(),window.addEventListener("resize",r),function(){return window.removeEventListener("resize",r)}}),[]),a}},548:function(e,t,c){"use strict";var n=c(524),i=c.n(n),a=c(525),s=c(44),r=c(530),o=c(1),l=c(542),d=c(537),u=c(2);t.a=function(e){var t=e.isPublic,c=e.id,n=e.isPlaylist,p=e.dispatchPrivacyUpdate,m=e.filmDispatch,j=Object(o.useState)(!1),b=Object(s.a)(j,2),f=b[0],h=b[1];Object(o.useEffect)((function(){function e(){return(e=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.c(c,{is_public:!t}).then((function(e){h(!1),p({type:"change-playlist-privacy-success",payload:e.data}),void 0!==m&&m({type:"field",fieldName:"reloadPlaylist",payload:!0})})).catch((function(e){console.error(e),h(!1)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f&&function(){e.apply(this,arguments)}()}),[p,f,t,c,m]);return Object(u.jsx)(d.a,{className:"button-ripple-24 p-0 ".concat(n?"":"remove-holder"),onClick:function(e){e.preventDefault(),e.stopPropagation(),f||h(!0)},children:Object(u.jsx)(r.a,{icon:t?"globe-europe":"lock"})})}},549:function(e,t,c){"use strict";var n=c(530),i=c(537),a=c(2);t.a=function(e){var t=e.handleRemove;return Object(a.jsx)(i.a,{className:"button-ripple-24 remove-holder p-0",onClick:t,children:Object(a.jsx)(n.a,{icon:"trash-alt"})})}},550:function(e,t,c){"use strict";var n=c(562),i=c.n(n),a=(c(556),c(2));t.a=function(e){var t=e.isRecommendations;return Object(a.jsxs)("div",{className:"".concat(t?"col-sm-12":"col-sm-6"," mb-4 col col-12 col-md-3 col-lg-2 container-px"),children:[Object(a.jsx)("div",{className:"col-12 col-sm-12 p-0",children:Object(a.jsx)("div",{className:"embed-responsive embed-responsive-16by9 z-depth-1-half play-container",children:Object(a.jsx)("div",{className:"embed-responsive-item",children:Object(a.jsx)(i.a,{className:"w-100 h-100 line-height-unset"})})})}),Object(a.jsxs)("div",{className:"col-12 col-sm-12 mt-2 p-0",children:[Object(a.jsx)("div",{className:"col p-0",children:Object(a.jsx)(i.a,{className:"w-100 h-100 line-height-unset"})}),Object(a.jsx)("div",{className:"col p-0",children:Object(a.jsx)(i.a,{className:"".concat(t?"line-height-unset":""," col w-100")})})]})]})}},553:function(e,t,c){"use strict";var n=c(44),i=c(1),a=c.n(i);c(577);var s=function(e){var t=e.target,c=e.onIntersect,n=e.threshold,i=void 0===n?.1:n,s=e.rootMargin,r=void 0===s?"0px":s;a.a.useEffect((function(){var e=new IntersectionObserver(c,{rootMargin:r,threshold:i}),n=t.current;return e.observe(n),function(){e.unobserve(n)}}))},r=(c(560),c(2)),o=function(e){var t=e.src,c=e.srcWebp,a=e.thumb,s=e.thumbWebp,o=e.isCached,l=Object(i.useState)(o),d=Object(n.a)(l,2),u=d[0],p=d[1];return Object(r.jsxs)("div",{children:[Object(r.jsxs)("picture",{children:[Object(r.jsx)("source",{type:"image/webp",srcSet:s}),Object(r.jsx)("source",{type:"image/jpeg",srcSet:a}),Object(r.jsx)("img",{className:"image thumb",alt:"",style:{visibility:u?"hidden":"visible"},src:a,onLoad:function(){p(!0)}})]}),Object(r.jsxs)("picture",{children:[Object(r.jsx)("source",{type:"image/webp",srcSet:c}),Object(r.jsx)("source",{type:"image/jpeg",srcSet:t}),Object(r.jsx)("img",{className:"image full",alt:"",style:{opacity:u?1:0},src:t,onLoad:function(){p(!0)}})]})]})};t.a=function(e){var t=e.image,c=Object(i.useRef)(),a=Object(i.useState)(!1),l=Object(n.a)(a,2),d=l[0],u=l[1],p=Object(i.useState)(!1),m=Object(n.a)(p,2),j=m[0],b=m[1];return s({target:c,onIntersect:function(e,i){if(Object(n.a)(e,1)[0].isIntersecting){var a=new Image;a.src=t.concat("?width=poster_webp"),b(a.complete),u(!0),c.current&&i.unobserve(c.current)}}}),Object(r.jsx)("div",{ref:c,className:"image-container embed-responsive embed-responsive-16by9  play-image",children:d&&Object(r.jsx)(o,{isCached:j,src:t.concat("?width=poster"),srcWebp:t.concat("?width=poster_webp"),thumb:t.concat("?width=preview"),thumbWebp:t.concat("?width=preview_webp")})})}},555:function(e,t,c){"use strict";c(1);var n=c(7),i=c(530),a=c(537),s=c(2);t.a=function(e){var t=e.isPlaylist,c=e.id,r=e.title,o=e.description,l=Object(n.g)();return Object(s.jsx)(a.a,{className:"button-ripple-24 remove-holder p-0",onClick:function(e){e.stopPropagation(),t?l.push({pathname:"profile/update-playlist/".concat(c),state:{title:r}}):l.push({pathname:"profile/update-film/".concat(c),state:{title:r,description:o}})},children:Object(s.jsx)(i.a,{icon:"edit"})})}},556:function(e,t,c){},560:function(e,t,c){},564:function(e,t,c){"use strict";var n=c(44),i=c(530),a=c(547),s=c.n(a),r=c(553),o=c(1),l=c(15),d=c(524),u=c.n(d),p=c(525),m=c(544),j=c(542),b=c(102),f=c(541),h=c(536),O=c(136),v=c(535),x={playlists:[],isLoading:!0,isAllFetched:!1,isCreating:!1,isAdding:!1,playlistToUpgrade:null,title:"",isPublic:!1,error:""};function y(e,t){switch(t.type){case"field":return Object(l.a)(Object(l.a)({},e),{},Object(O.a)({error:""},t.fieldName,t.payload));case"load":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!0,isAllFetched:!1});case"load-success":return Object(l.a)(Object(l.a)({},e),{},{playlists:[].concat(Object(h.a)(e.playlists),Object(h.a)(t.payload)),isLoading:!1,isAllFetched:t.payload.length<v.d,error:""});case"create":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isCreating:!0});case"create-success":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isCreating:!1});case"add":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isAdding:!0,playlistToUpgrade:t.payload});case"add-update-playlist":return Object(l.a)(Object(l.a)({},e),{},{playlists:e.playlists.map((function(t){return t.id===e.playlistToUpgrade.id?Object(l.a)(Object(l.a)({},t),{},{contains:!t.contains}):t})),playlistToUpgrade:null});case"add-success":return Object(l.a)(Object(l.a)({},e),{},{isAdding:!1});case"change-playlist-privacy-success":return Object(l.a)(Object(l.a)({},e),{},{playlists:e.playlists.map((function(e){return e.id===t.payload.id?Object(l.a)(Object(l.a)({},e),{},{is_public:t.payload.is_public}):e}))});case"error":return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1,isCreating:!1,error:t.payload,title:""});default:return e}}var g=c(548),w=c(537),N=c(2);var k=function(e){var t=e.filmID,c=e.isRecommendations,a=e.filmDispatch,s=Object(o.useContext)(b.a).createToast,r=Object(o.useRef)(),d=Object(o.useReducer)(y,x),h=Object(n.a)(d,2),O=h[0],k=h[1],C=O.playlists,L=O.title,E=O.isPublic,R=O.isLoading,F=O.isAllFetched,D=O.isCreating,P=O.isAdding,A=O.playlistToUpgrade,_=O.error,I=Object(o.useCallback)((function(){R||F||D||P||k({type:"load"})}),[R,F,D,P]),S=Object(f.a)(I);Object(o.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a({playlists:!0,skip:C.length,limit:v.d}).then((function(e){var c=e.data.playlists;c.forEach((function(e){e.contains=e.films.indexOf(t)>-1})),k({type:"load-success",payload:c})})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R&&function(){e.apply(this,arguments)}()}),[t,C,R]),Object(o.useEffect)((function(){var e=function(){document.getElementById("closePlaylistMenuButton".concat(t)).click()};function c(){return(c=Object(p.a)(u.a.mark((function c(){var n;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n={title:L,is_public:E,films_id:[t]},c.next=3,j.a(n).then((function(t){k({type:"create-success"}),s("Created playlist ".concat(L)),e()})).catch((function(e){console.error(e);var t=null;e.response&&e.response.data&&e.response.data.error?t=e.response.data.error:e.response&&e.response.data&&e.response.data.errors&&(t=e.response.data.errors[0]),r.current.classList.add("is-invalid"),k({type:"error",payload:"Path `title` is required."===t?"Playlist title is required":t})}));case 3:case"end":return c.stop()}}),c)})))).apply(this,arguments)}D&&function(){c.apply(this,arguments)}()}),[D,L,E,s,t]),Object(o.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){var n,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={films_id:[t]},n=A.contains?Object(l.a)(Object(l.a)({},n),{},{is_remove_films:!0}):Object(l.a)(Object(l.a)({},n),{},{is_remove_films:!1}),i=A.contains?"Deleted from playlist ".concat(A.title):"Added to playlist ".concat(A.title),k({type:"add-update-playlist",playlist:A}),e.next=6,j.c(A.id,n).then((function(e){k({type:"add-success"}),c&&a({type:"field",fieldName:"reloadPlaylist",payload:!0}),s(i)})).catch((function(e){return console.error(e)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}P&&A&&function(){e.apply(this,arguments)}()}),[P,A,s,a,t,c]);var M=function(e,t){r.current.classList.remove("is-invalid"),k({type:"field",fieldName:e,payload:t})};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"row m-0 m-button button-ripple",children:[Object(N.jsx)("div",{className:"col playlist-add-exit-text-width px-3",children:"Save to..."}),Object(N.jsx)(w.a,{id:"closePlaylistMenuButton".concat(t),className:"button-ripple-24 playlist-add-icon-holder p-0 d-flex align-items-center text-center justify-content-center",onClick:function(){},children:Object(N.jsx)(i.a,{icon:"times"})})]}),Object(N.jsx)("hr",{className:"dropdown-divider"}),Object(N.jsxs)("div",{ref:S,className:"playlist-dropdown-content",children:[C.map((function(e,t){return Object(N.jsxs)("div",{className:"row m-0 playlist-form-group form-group mb-1",children:[Object(N.jsx)("div",{className:"col-10 col-sm-10 p-0",children:Object(N.jsxs)("div",{id:e.id,className:"form-check",children:[Object(N.jsx)("input",{type:"checkbox",id:"formCheckAddToPlaylist".concat(e.id),className:"form-check-input",onChange:function(){return function(e){k({type:"add",payload:e})}(e)},checked:e.contains}),Object(N.jsx)("label",{className:"form-check-label w-100",htmlFor:"formCheckAddToPlaylist".concat(e.id),children:Object(N.jsx)("p",{className:"playlist-check-label",onClick:function(e){return e.stopPropagation()},children:e.title})})]})}),Object(N.jsx)(g.a,{id:e.id,isPublic:e.is_public,isPlaylist:!0,filmDispatch:a,dispatchPrivacyUpdate:k})]},e.id)})),!F&&Object(N.jsx)("div",{className:"fetch-spinner d-flex justify-content-center align-items-center h-100",children:R&&Object(N.jsx)("div",{className:"spinner-border"})})]}),Object(N.jsx)("hr",{className:"dropdown-divider"}),Object(N.jsx)("div",{className:"row m-0 px-3",children:Object(N.jsx)("span",{className:"m-0",children:"Create a new playlist"})}),Object(N.jsx)("div",{className:"row m-0 px-3",children:Object(N.jsxs)("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),k({type:"create"})},children:[Object(N.jsxs)("div",{className:"form-group mb-2 mt-2",children:[Object(N.jsx)("input",{type:"text",className:"form-control","aria-label":"playlistNameInput",placeholder:"Enter playlist title...",ref:r,onChange:function(e){return M("title",e.target.value)}}),Object(N.jsx)("div",{className:"invalid-feedback",children:_})]}),Object(N.jsx)("div",{className:"form-group mb-2 mt-2",children:Object(N.jsxs)("select",{className:"form-control",onChange:function(e){return M("isPublic","public"===e.target.value)},children:[Object(N.jsx)("option",{value:"private",children:"Private"}),Object(N.jsx)("option",{value:"public",children:"Public"})]})}),Object(N.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[Object(N.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:D,children:"Create"}),D&&Object(N.jsx)("div",{className:"spinner-grow ml-2"})]})]})})]})},C=c(561),L=c.n(C),E=c(559);c(578);var R=function(e){var t=e.isRecommendations,c=e.filmDispatch,a=e.filmID,s=Object(o.useRef)(),r=L()({background:"black"}),l=Object(n.a)(r,2),d=l[0],u=l[1],p=Object(o.useState)(!1),m=Object(n.a)(p,2),j=m[0],b=m[1],f=function(){b(!0)},h=function(){b(!1)};return Object(o.useEffect)((function(){if(s.current){var e=window.$("#playlistDropdown".concat(a));return e.on("show.bs.dropdown",f),e.on("hide.bs.dropdown",h),function(){e.off("show.bs.dropdown",f),e.off("hide.bs.dropdown",h)}}}),[s,a]),Object(N.jsxs)("div",{ref:s,id:"playlistDropdown".concat(a),className:"p-0 dropdown dropdown-sizes",children:[Object(N.jsx)("button",{onMouseDown:d,id:"playlistAddButtonLabel".concat(a),type:"button","data-toggle":"dropdown","data-boundary":"window",className:"btn btn-link button-ripple dropdown-toggle p-0 text-dark",children:Object(N.jsxs)("div",{className:"col playlist-add-icon-holder p-0 button-ripple button-ripple-24",children:[Object(N.jsx)(i.a,{style:{opacity:j?1:""},className:"playlist-add-icon",icon:E.a}),u]})}),Object(N.jsx)("div",{className:"dropdown-menu playlist-dropdown-menu ".concat(t?"dropdown-menu-right":"playlist-dropdown-menu-position"),id:"playlistDropdownMenu".concat(a),"aria-labelledby":"playlistAddButtonLabel".concat(a),children:j&&Object(N.jsx)(k,{isRecommendations:t,filmDispatch:c,filmID:a})})]})},F=c(549),D=(c(579),c(545)),P=c(80),A=["col-12 mb-4 container-px","row p-0 m-0 play-outer-container remove-container p-0","col-6 m-0 p-0","col-6 col-sm-6 pr-0","row mx-0 mb-0 h-100","mb-1 title"],_=["col-12 col-md-3 col-lg-2 mb-4 container-px","col play-outer-container remove-container p-0","col-12 col-sm-12 p-0","col-12 col-sm-12 p-0","row mx-0 mb-0 mt-1","mb-1 mt-1 title"],I=["col-12 col-lg-8 mx-0 mb-4 container-px","row p-0 m-0 play-outer-container remove-container p-0","col-6 col-sm-4 p-0","col-6 col-sm-8","row mx-0 mb-0 h-100","mb-1 title"],S=["col-12 col-sm-12 col-md-3 col-lg-2 mb-4 container-px","col play-outer-container remove-container p-0","col-12 col-sm-12 p-0","col-12 col-sm-12 p-0","row mx-0 mb-0 mt-1","mb-1 mt-1 title"],M=["col-12 col-sm-6 col-md-3 col-lg-2 mb-4 container-px","col play-outer-container remove-container p-0","col-12 col-sm-12 p-0","col-12 col-sm-12 p-0","row mx-0 mb-0 mt-1","mb-1 mt-1 title"],H=function(e,t,c){return e?c?_:A:t?c?S:I:M},T=c(555);t.a=function(e){var t=e.film,c=e.index,a=e.handleRedirect,l=e.handleRemove,d=e.isProfile,u=e.isRecommendations,p=e.isSearch,m=e.filmDispatch,j=e.children,b=Object(D.a)(u?768:576),f=Object(o.useState)(H(u,p,b)),h=Object(n.a)(f,2),O=h[0],v=h[1],x=Object(o.useContext)(P.a).user;return Object(o.useEffect)((function(){v(H(u,p,b))}),[b]),Object(N.jsx)("div",{className:O[0],children:Object(N.jsxs)("div",{className:O[1],children:[Object(N.jsx)("div",{className:O[2],onClick:function(){return a()},children:Object(N.jsxs)("div",{className:"play-container",children:[Object(N.jsx)(r.a,{image:t.img}),Object(N.jsx)(i.a,{className:"play-middle",icon:"play"})]})}),Object(N.jsx)("div",{className:O[3],children:Object(N.jsxs)("div",{className:O[4],children:[Object(N.jsxs)("div",{className:"".concat(x.auth?"".concat(d?"button-ripple-div-next-width-2x":"button-ripple-div-next-width"):"col-12"," col p-0 pr-2 cursor-pointer"),onClick:function(){return a()},children:[Object(N.jsx)(s.a,{line:1,text:t.title,className:O[5]}),j||Object(N.jsxs)("div",{className:"mb-0 author-nick",children:[Object(N.jsxs)("span",{children:[t.author_name,"\xa0"]}),Object(N.jsx)("span",{children:"\u2022\xa0"}),Object(N.jsxs)("span",{children:[t.views," views"]})]})]}),Object(N.jsxs)("div",{className:"".concat(x.auth?"".concat(d?"click-under-buttons-container-x2":"click-under-buttons-container"):"click-under-buttons-container"),children:[d?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(F.a,{handleRemove:l}),Object(N.jsx)(T.a,{id:t.id,title:t.title,description:t.description})]}):x.auth?Object(N.jsx)(R,{isRecommendations:u,filmDispatch:m,index:c,filmID:t.id}):null,Object(N.jsx)("div",{className:"col col-12 m-0 p-0 click-under-buttons",onClick:function(){return a()}})]})]})})]})})}},578:function(e,t,c){},579:function(e,t,c){},581:function(e,t,c){"use strict";t.a=c.p+"static/media/image_not_found.c4ba1e76.png"}}]);
//# sourceMappingURL=9.79ace575.chunk.js.map